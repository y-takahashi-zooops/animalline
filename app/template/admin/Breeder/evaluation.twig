{#
This file is part of EC-CUBE

Copyright(c) EC-CUBE CO.,LTD. All Rights Reserved.

http://www.ec-cube.co.jp/

For the full copyright and license information, please view the LICENSE
file that was distributed with this source code.
#}
{% extends '@admin/default_frame.twig' %}

{% set results = ['審査待ち','非公開', '公開'] %}
{% set menus = ['breeders', 'breeders_evaluation'] %}

{% block title %}{{ '評価一覧'|trans }}{% endblock %}
{% block sub_title %}{{ 'ブリーダー管理'|trans }}{% endblock %}

{% block stylesheet %}
<link rel="stylesheet" href="{{ asset('assets/css/tempusdominus-bootstrap-4.min.css', 'admin') }}">
<style>
    .fas.fa-star, .far.fa-star {
        color: #f8ce0b;
    }
</style>
{% endblock stylesheet %}

{% block javascript %}
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    function showEvaluationDetail(id) {
        // $("#modal_detail + id").modal('show');
        $('#modal_detail' + id).modal('show');
    };
</script>
{% endblock javascript %}

{% block main %}
<div class="c-outsideBlock">
    {# <form id='search_form' method="get" action="{{ url('admin_breeder_list') }}">
        <div class="c-outsideBlock__contents">
            <div class="row mb-2">
                <div class="col">
                    <label class="col-form-label" data-tooltip="true" data-placement="top"
                        title="情報を入力して一覧の絞り込み検索ができます。">ブリーダー名<i class="fa fa-question-circle fa-lg ml-1"></i></label>
                    <input type="text" id="breeder_name" name="breeder_name" class="form-control"
                        value="{{ params.breeder_name is defined ? params.breeder_name : '' }}" />
                </div>
                <div class="col">
                    <label class="col-form-label">登録日</label>
                    <div class="form-row align-items-center">
                        <div class="col">
                            <input type="date" id="create_date_from" name="create_date_from" class="form-control"
                                value="{{ params.create_date_from is defined ? params.create_date_from : '' }}" />
                        </div>
                        <div class="col-auto text-center">〜</div>
                        <div class="col">
                            <input type="date" id="create_date_to" name="create_date_to" class="form-control"
                                value="{{ params.create_date_to is defined ? params.create_date_to : '' }}" />
                        </div>
                    </div>
                </div>
            </div>
            <div class="row mb-2">
                <div class="col">
                    <label class="col-form-label">審査状態</label>
                    <select id="examination_status" name="examination_status" class="form-control">
                        {% set statusNames = ['全て', '審査済み', '未審査'] %}
                        {% for i in 1..3 %}
                        <option value="{{ i }}" {% if params.examination_status is defined and
                            params.examination_status==i %} selected {% endif %}>{{ statusNames[i - 1] }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col">
                    <label class="col-form-label">更新日</label>
                    <div class="form-row align-items-center">
                        <div class="col">
                            <input type="date" id="update_date_from" name="update_date_from" class="form-control"
                                value="{{ params.update_date_from is defined ? params.update_date_from : '' }}" />
                        </div>
                        <div class="col-auto text-center">〜</div>
                        <div class="col">
                           <input type="date" id="update_date_to" name="update_date_to" class="form-control"
                                value="{{ params.update_date_to is defined ? params.update_date_to : '' }}" />
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="c-outsideBlock__contents mb-5">
            <button class="btn btn-ec-conversion px-5" type="submit">{{ 'admin.common.search'|trans }}</button>
        </div>
    </form> #}
</div>
<div class="c-contentsArea__cols">
    <div class="c-contentsArea__primaryCol">
        <div class="c-primaryCol">
            <div class="card rounded border-0 mb-4 d-block">
                <div class="card-body p-0">
                    <table class="table table-sm">
                        <thead>
                            <tr>
                                <th class="border-top-0 pt-2 pb-2"></th>
                                {# <th class="border-top-0 pt-2 pb-2">ID</th> #}
                                <th class="border-top-0 pt-2 pb-2">ブリーダー名</th>
                                <th class="border-top-0 pt-2 pb-2">ペット画像</th>
                                <th class="border-top-0 pt-2 pb-2">犬種/猫種</th>
                                <th class="border-top-0 pt-2 pb-2">評価</th>
                                <th class="border-top-0 pt-2 pb-2">公開状況</th>
                                <th class="border-top-0 pt-2 pb-2 pr-3" colspan="3"></th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for evaluation in evaluations %}
                                <form name="form" role="form" class="form-horizontal" method="post" action="">
                                    <tr>
                                        <td class="align-middle"></td>
                                        <td class="align-middle">{{ evaluation.Pet.Breeder.BreederName }}</td>
                                        {# <td class="align-middle">{{ evaluation.Id }}</td> #}
                                        <td class="align-middle">
                                            <img alt="..."
                                                src="{{ app.request.schemeAndHttpHost ~ '/' ~ constant('Customize\\Config\\AnilineConf::ANILINE_IMAGE_URL_BASE') ~ (evaluation.Pet.ThumbnailPath | default | length > 0 ? evaluation.Pet.ThumbnailPath : '/noimage_plugin_list.png') }}"
                                                style="max-width: 100px">
                                        </td>
                                        <td class="align-middle">{{ evaluation.Pet.BreedsType.BreedsName }}</td>
                                        <td class="align-middle">
                                            <!-- 0 star or 1 star -->
                                            <i class="{{ evaluation.EvaluationValue == 0 ? 'far fa-star' :  'fas fa-star' }}"></i>
                                            <!-- 2 star  -->
                                            <i class="{{ evaluation.EvaluationValue >= 2 ? 'fas fa-star' : 'far fa-star' }}"></i>
                                            <!-- 3 star  -->
                                            <i class="{{ evaluation.EvaluationValue >= 3 ? 'fas fa-star' : 'far fa-star' }}"></i>
                                            <!-- 4 star  -->
                                            <i class="{{ evaluation.EvaluationValue >= 4 ? 'fas fa-star' : 'far fa-star' }}"></i>
                                            <!-- 5 star  -->
                                            <i class="{{ evaluation.EvaluationValue >= 5 ? 'fas fa-star' : 'far fa-star' }}"></i>
                                        </td>
                                        <td class="align-middle">{{ results[evaluation.IsActive] }}</td>
                                        <td class="align-middle"></td>
                                        <td class="align-middle pr-3" colspan="3">
                                            <div class="text-right">
                                                <div class="px-1 d-inline-block">
                                                    <button type="button" class="btn btn-ec-actionIcon" id="detail"
                                                        onclick="showEvaluationDetail({{ evaluation.id }})"
                                                        data-id="{{ evaluation.id }}" data-tooltip="true"
                                                        data-placement="top" title="評価詳細表示">
                                                        <i class="fa fa-file fa-lg text-secondary" aria-hidden="true"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                    {# 詳細表示モーダル #}
                                    <div class="modal fade" id="modal_detail{{evaluation.id}}" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
                                        aria-hidden="true">
                                        <div class="modal-dialog" role="document">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h3 class="modal-title" id="exampleModalLabel">評価詳細</h3>
                                                    <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                                                        <span aria-hidden="true">&times;</span>
                                                    </button>
                                                </div>
                                                <div class="modal-body">
                                                    <div class="row mb-2">
                                                        <div class="col-3">ブリーダー名</div>
                                                        <div class="col-9">{{ evaluation.Pet.Breeder.BreederName }}</div>
                                                    </div>
                                                    <div class="row mb-2">
                                                        <div class="col-3">評価</div>
                                                        <div class="col-9">
                                                            <!-- 0 star or 1 star -->
                                                            <i class="{{ evaluation.EvaluationValue == 0 ? 'far fa-star' :  'fas fa-star' }}"></i>
                                                            <!-- 2 star  -->
                                                            <i class="{{ evaluation.EvaluationValue >= 2 ? 'fas fa-star' : 'far fa-star' }}"></i>
                                                            <!-- 3 star  -->
                                                            <i class="{{ evaluation.EvaluationValue >= 3 ? 'fas fa-star' : 'far fa-star' }}"></i>
                                                            <!-- 4 star  -->
                                                            <i class="{{ evaluation.EvaluationValue >= 4 ? 'fas fa-star' : 'far fa-star' }}"></i>
                                                            <!-- 5 star  -->
                                                            <i class="{{ evaluation.EvaluationValue >= 5 ? 'fas fa-star' : 'far fa-star' }}"></i>
                                                        </div>
                                                    </div>
                                                    <div class="row mb-2">
                                                        <div class="col-3">本文</div>
                                                        <div class="col-9">{{ evaluation.EvaluationMessage |nl2br}}</div>
                                                    </div>
                                                    {% if evaluation.ImagePath %}
                                                        <div class="row mb-2">
                                                            <div class="col-3">画像</div>
                                                            <div class="col-9">
                                                                <img alt="..." img src="{{ evaluation.ImagePath}}" style="max-width: 300px">
                                                            </div>
                                                        </div>
                                                    {% endif %}
                                                    <div class="row mb-2">
                                                        <div class="col-3">公開状況</div>
                                                        <div class="col-9">
                                                            <select id="is_active" name="is_active" class="form-control">
                                                                {% for i in 0..2 %}
                                                                    <option value="{{ i }}" {{ evaluation.isActive == i ? 'selected' : '' }}>{{ results[i] }}</option>
                                                                {% endfor %}
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <input type="hidden" id="id" name="id" value="{{ evaluation.Id }}">
                                                </div>
                                                <div class="modal-footer">
                                                    <button type="submit" class="btn btn-primary">変更</button>
                                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">閉じる</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            {% else %}
                            <tr>
                                <td colspan="7">結果が０件です。</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            {# <div class="navigation float-right">
                {{ knp_pagination_render(breeders, '@KnpPaginator/twitter_bootstrap_v4_pagination.html.twig') }}
            </div> #}
        </div>
    </div>
</div>

{% endblock %}
