{% extends 'default_frame.twig' %}

{% block stylesheet %}
    <link rel="stylesheet" href="{{ asset('assets/css/index.css?ver=211102_2') }}">
{% endblock %}
{% block javascript %}
     {# カレンダー表示用スクリプト #}
<script>
	// 業務カレンダー表示用
	const week = ["日", "月", "火", "水", "木", "金", "土"];
	const today = new Date();
	// 月末だとずれる可能性があるため、1日固定で取得
	var showDate = new Date(today.getFullYear(), today.getMonth(), 1);

	$(function(){
		year = showDate.getFullYear();
		month = showDate.getMonth();

		// showDateの月は配列なので、11が12月、0が1月
		if( month == 11){
			nextyear = year + 1;
			nextmonth = 0;
		} else {
			nextyear = year
			nextmonth = month + 1;
		}

		// 当月カレンダー作成
		$.ajax({
			url: '{{ url('calendar') }}',
			type: 'POST',
			dataType: 'json',
			data: {
				'year' : year,
				'month' : month
			}
		}).done(function (data) {// 正常時
    		calendar = createCalendar(data.year, data.month, data.dates);
			document.querySelector('#calendar_thisMonth').innerHTML = calendar;
		}).fail(function () { // エラー時
			alert('読み込みエラー');
		});

		// 翌月カレンダー作成
		$.ajax({
			url: '{{ url('calendar') }}',
			type: 'POST',
			dataType: 'json',
			data: {
				'year' : nextyear,
				'month' : nextmonth
			}
		}).done(function (data) {// 正常時
    		calendar = createCalendar(data.year, data.month, data.dates);
			document.querySelector('#calendar_nextMonth').innerHTML = calendar;
		}).fail(function () { // エラー時
			alert('読み込みエラー');
		});
	});

	// カレンダー作成
	function createCalendar(year, month, dates) {

		// 月・曜日
		var calendar = "<table class='common-table cal'><caption>" + year + "年<span>"+ month + "月</span></caption><thead><tr>";
		for (var i = 0; i < week.length; i++) {
			calendar += "<th>" + week[i] + "</th>";
		}
		calendar += "</thead></tr>";

		var count = 0;
		var row = Math.ceil((dates.length) / week.length);

		// 1行ずつ設定
		for (var i = 0; i < row; i++) {
			calendar += "<tr>";
			// 1カラム単位で設定
			for (var j = 0; j < week.length; j++) {
				count = j + i * 7;
				// 休日
				if(dates[count].holiday) {
					calendar += "<td class='holiday'>" + dates[count].day + "</td>";
				// 前月or翌月
				}else if(dates[count].disabled){
					calendar += "<td class='disabled'>" + dates[count].day + "</td>";
				} 
				// その他
				else{
					calendar += "<td>" + dates[count].day + "</td>";
				}
			}
			calendar += "</tr>";
		}

		return calendar;
	}
</script>
{% endblock %}

{% block main %}
    <main role="main" id="container">
        <div id="contents">
            <div class="edit-area keyvisual">
                <div class="inner w1190">
                    <div class="photo-box"><img src="{{ asset('assets/img/main.jpg') }}" alt="アニマルライン"></div>
                </div>
            </div>
            <div class="side-set">
                <div class="main-area">

                    <div class="edit-area lineup new">
                        <div class="inner">
                            <div class="index-title type01">
                                <h2 class="main"><span>新着商品</span></h2>
                            </div>
                            <ul class="lineup-list">
                                {% for product in products_new %}
                                    <li><a href="{{ url('product_detail', {'id': product.id}) }}">
                                        <div class="list-photo"><img src="{{ asset(product.main_list_image|no_image_product, 'save_image') }}"></div>
                                        <div class="list-title">{{ product.name }}</div>
                                    </a></li>
                                {% endfor %}
                            </ul>
                        </div>
                    </div>
                </div><!-- main-area -->

                <div class="side-area">
                    <dl class="side-list">
                        <div>
                            <dt>⽝⽤</dt>
                            <dd>
                                <ul>
                                    <li><a href="{{ url('product_list') }}?category_id=10">DRYフード</a></li>
                                    <li><a href="{{ url('product_list') }}?category_id=11">WETフード</a></li>
                                    <li><a href="{{ url('product_list') }}?category_id=12">おやつ</a></li>
                                    <li><a href="{{ url('product_list') }}?category_id=13">トイレタリー</a></li>
                                    <li><a href="{{ url('product_list') }}?category_id=14">雑貨</a></li>
                                    <li><a href="{{ url('product_list') }}?category_id=46">その他</a></li>
                                </ul>
                            </dd>
                        </div>
                        <div>
                            <dt>猫⽤</dt>
                            <dd>
                                <ul>
                                    <li><a href="{{ url('product_list') }}?category_id=19">DRYフード</a></li>
                                    <li><a href="{{ url('product_list') }}?category_id=20">WETフード</a></li>
                                    <li><a href="{{ url('product_list') }}?category_id=21">おやつ</a></li>
                                    <li><a href="{{ url('product_list') }}?category_id=22">トイレタリー</a></li>
                                    <li><a href="{{ url('product_list') }}?category_id=23">雑貨</a></li>
                                    <li><a href="{{ url('product_list') }}?category_id=47">その他</a></li>
                                </ul>
                            </dd>
                        </div>
                        <div>
                            <dt>その他</dt>
                            <dd>
                                <ul>
                                    <li><a href="{{ url('product_list') }}?category_id=26">DRYフード</a></li>
                                    <li><a href="{{ url('product_list') }}?category_id=27">WETフード</a></li>
                                    <li><a href="{{ url('product_list') }}?category_id=28">おやつ</a></li>
                                    <li><a href="{{ url('product_list') }}?category_id=29">トイレタリー</a></li>
                                    <li><a href="{{ url('product_list') }}?category_id=30">雑貨</a></li>
                                    <li><a href="{{ url('product_list') }}?category_id=48">その他</a></li>
                                </ul>
                            </dd>
                        </div>
                    </dl>
                </div>
            </div><!-- side-area -->

            <div class="edit-area buy">
				<div class="inner w1080">
					<h2 class="buy-title">お買い物についてのお知らせ</h2>

					<ul class="buy-list">
						<li>
							<dl>
								<dt>お支払いについて</dt>
								<dd>
									お支払いは、クレジットカード・銀行振込がご利用いただけます。
									<div class="notes">
										※クレジットカードのセキュリティはSSLというシステムを利用しております。カード番号は暗号化されて安全に送信されますので、どうぞご安心ください。
									</div>
									<div class="photo-box"><img src="/html/template/default/assets/img/index/buy_img01.jpg" alt=""></div>
								</dd>
							</dl>
						</li>
						<li>
							<dl>
								<dt>配送について</dt>
								<dd>
									<ul class="dot-list">
										<li>配送は 佐川急便でお届けいたします。</li>
										<li>ご入金確認後、３営業日以内に発送いたします。</li>
										<li>また、時間指定も承ります。指定できる時間帯は下記をご覧ください。</li>
									</ul>
									<div class="photo-box"><img src="/html/template/default/assets/img/index/buy_img02.jpg" alt=""></div>
								</dd>
							</dl>
						</li>
					</ul>
				</div>
			</div>
			<div class="edit-area time">
				<div class="inner w1080">
					<h2 class="index-title type02">営業日のご案内</h2>
					<link rel="stylesheet" href="{{ asset('assets/css/calendar.css') }}">
					<ul class="time-list">
						<li>	
							<div id="calendar_thisMonth" class="calendar"></div>
						</li>
						<li>	
							<div id="calendar_nextMonth" class="calendar"></div>
						</li>
					</ul>
					<ul class="common-list cal-mark">
						<li class="holiday">休業日</li>
					</ul>
				</div>
			</div>
        </div><!-- contents -->
    </main><!-- container -->
{% endblock %}