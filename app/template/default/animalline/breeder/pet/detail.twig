{% set site_type = 'breeder' %}
{% extends 'animalline/breeder/frame.twig' %}
{% set band_color = {1:"赤", 2:"青", 3:"緑", 4:"黄色", 5:"ピンク", 6:"オレンジ"} %}

{% block main %}
    <section id="breeder-column" class="breeder-column_dog">
        <div class="inner">
            <div class="breeder-column-row">
                <div class="breeder-column__main">
                    {% if breederPet.isContract or breederPet.isDelete %}
                        <div class="comment-box--sblue">
                            こちらのワンちゃんは成約済のためお問い合わせできません。
                            <p class="mt-4">{{ breederPet.breeder.breederName }}ブリーダーに未掲載の子や、次回の出産予定を聞きたいなどお問い合わせをしたい方はこちら</p>
                        </div>
                        <div class="btn btn-breeder__inquiries">
                            <a href="{{ url('breeder_nopet_contact', {'breeder_id': breederPet.Breeder.id}) }}">{{ breederPet.breeder.breederName }}ブリーダーへのお問い合わせ</a>
                        </div>
                    {% endif %}
                    <div class="breeder-column__main_section" id="breeder-column__main_section_dog_new">
                        <div class="breeder-column__main_section_title">
                            <h2 class="float-left mb-3">
                                {{ breederPet.breedsType.breedsName ?? '' }}
                                {% if breederPet.isContract or breederPet.isDelete %}【成約済】
                                {% elseif breederPet.dnaCheckResult == 0 %}【DNA検査中】{% endif %}
                                
                            </h2>
                            <div class="col-md-3 col-12 float-right btn-like mb-3 {{ isFavorite ? "red-heart" : "" }}"
                                 data-id="{{ breederPet.id }}" data-login="{{ isLoggedIn }}">
                                <a>
                                    <svg width="24" height="20" class="heart-icon">
                                        <path d="M19.469 1.262c-5.284-1.53-7.47 4.142-7.47 4.142S9.815-.269 4.532 1.262C-1.937 3.138.44 13.832 12 19.333c11.559-5.501 13.938-16.195 7.469-18.07z"
                                              stroke="#FF424F" stroke-width="1.5"
                                              fill="{{ isFavorite ? '#FF424F' : 'none' }}" fill-rule="evenodd"
                                              stroke-linejoin="round"></path>
                                    </svg>
                                    <span id="textBtnLike">
                                        {{ isFavorite ? 'お気に入りから削除' : 'お気に入りに追加' }}
                                    </span>
                                </a>
                            </div>
                        </div>
                        <div class="breeder-column__main_section_body">
                            <div class="row">
                                <div class="col-sm-6">
                                    <img src="{{ app.request.schemeAndHttpHost ~ '/' ~ constant('Customize\\Config\\AnilineConf::ANILINE_IMAGE_URL_BASE') ~ (images[0].imageUri | default | length > 0 ? images[0].imageUri : '/noimage_plugin_list.png') }}"
                                         class="card-img-top" alt="..."/>
                                    <div class="d-block d-sm-none m-2 p-2"></div>
                                </div>
                                <div class="col-6 col-sm-3">
                                    <img src="{{ app.request.schemeAndHttpHost ~ '/' ~ constant('Customize\\Config\\AnilineConf::ANILINE_IMAGE_URL_BASE') ~ (images[1].imageUri | default | length > 0 ? images[1].imageUri : '/noimage_plugin_list.png') }}"
                                         class="card-img-top w-100" alt="..."/>
                                    <div class="m-2 p-2"></div>
                                    <img src="{{ app.request.schemeAndHttpHost ~ '/' ~ constant('Customize\\Config\\AnilineConf::ANILINE_IMAGE_URL_BASE') ~ (images[2].imageUri | default | length > 0 ? images[2].imageUri : '/noimage_plugin_list.png') }}"
                                         class="card-img-top w-100" alt="..."/>
                                </div>
                                <div class="col-6 col-sm-3">
                                    <img src="{{ app.request.schemeAndHttpHost ~ '/' ~ constant('Customize\\Config\\AnilineConf::ANILINE_IMAGE_URL_BASE') ~ (images[3].imageUri | default | length > 0 ? images[3].imageUri : '/noimage_plugin_list.png') }}"
                                         class="card-img-top w-100" alt="..."/>
                                    <div class="m-2 p-2"></div>
                                    <img src="{{ app.request.schemeAndHttpHost ~ '/' ~ constant('Customize\\Config\\AnilineConf::ANILINE_IMAGE_URL_BASE') ~ (images[4].imageUri | default | length > 0 ? images[4].imageUri : '/noimage_plugin_list.png') }}"
                                         class="card-img-top w-100" alt="..."/>
                                </div>
                            </div>
                            <div class="m-2 p-2"></div>
                            {% if video %}
                                <div class="row">
                                    <div class="col-12 text-center">
                                        <video controls autoplay loop preload="auto">
                                            <source type="video/mp4"
                                                    src="{{ app.request.schemeAndHttpHost ~ '/' ~ video.imageUri }}">
                                        </video>
                                    </div>
                                </div>
                                <div class="m-2 p-2"></div>
                            {% endif %}
                            {# <div class="row"> #}
                        
                            {% if breederPet.movieFile %}
                                <div class="pet-movie">
                                    <video src="/html/upload/movie/{{ breederPet.movieFile }}" controls></video>
                                </div>
                            {% endif %}

                            <div style="text-align: right">
                                このページの閲覧数：{{ breederPet.ViewCount }}
                            </div>
                            <div class="breeder_section_header">
                                <i class="fas fa-paw"></i>
                                基本情報
                            </div>
                            <div class="col-12 breeder_section_detail">
                                <div class="row">
                                    <div class="col-12 col-md-4 contents_col_bold">
                                        ペットID
                                    </div>
                                    <div class="col-12 col-md-8 contents_col_normal">
                                        {{ breederPet.id ?? '' }}
                                    </div>
                                </div>
                            </div>

                            <div class="col-12 breeder_section_detail">
                                <div class="row">
                                    <div class="col-12 col-md-4 contents_col_bold">
                                        種類
                                    </div>
                                    <div class="col-12 col-md-8 contents_col_normal">
                                        {{ breederPet.breedsType.breedsName ?? '' }}
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 breeder_section_detail">
                                <div class="row">
                                    <div class="col-12 col-md-4 contents_col_bold">
                                        性別
                                    </div>
                                    <div class="col-12 col-md-8 contents_col_normal">
                                        {{ breederPet.petSex == constant('Customize\\Config\\AnilineConf::ANILINE_PET_SEX_MALE') ? '男の子' : '女の子' }}
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 breeder_section_detail">
                                <div class="row">
                                    {% set breederHouse = breederPet.Breeder.getBreederHouseByPetType(breederPet.petKind) %}
                                    <div class="col-12 col-md-4 contents_col_bold">
                                        見学地域
                                    </div>
                                    <div class="col-12 col-md-8 contents_col_normal">
                                        {{ breederHouse.breederHousePref ~ ' ' ~ breederHouse.breederHouseCity ?? '' }}
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 breeder_section_detail">
                                <div class="row">
                                    <div class="col-12 col-md-4 contents_col_bold">
                                        誕生日
                                    </div>
                                    <div class="col-12 col-md-8 contents_col_normal">
                                        {{ breederPet.petBirthday.format('Y年m月d日') ?? '' }}
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 breeder_section_detail">
                                <div class="row">
                                    <div class="col-12 col-md-4 contents_col_bold">
                                        毛色
                                    </div>
                                    <div class="col-12 col-md-8 contents_col_normal">
                                        {{ breederPet.coatColor ?? '' }}
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 breeder_section_detail">
                                <div class="row">
                                    <div class="col-12 col-md-4 contents_col_bold">
                                        血統書の有無
                                    </div>
                                    <div class="col-12 col-md-8 contents_col_normal">
                                        {% if breederPet.isPedigree == 1 %}
                                            あり
                                            {% if breederPet.pedigreeDetail %}
                                                ({{ breederPet.pedigreeDetail() }})
                                            {% endif %}
                                        {% else %}
                                            無
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 breeder_section_detail">
                                <div class="row">
                                    <div class="col-12 col-md-4 contents_col_bold">
                                        ワクチン代負担
                                    </div>
                                    <div class="col-12 col-md-8 contents_col_normal">
                                        {% if breederPet.getIncludeVaccineFee == 1 %}
                                            代金に含む
                                        {% else %}
                                            代金に含まない
                                            {%if breederPet.getVaccineDetail() != "" %}
                                                （{{ breederPet.getVaccineDetail() }}）
                                            {% endif %}
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 breeder_section_detail">
                                <div class="row">
                                    <div class="col-12 col-md-4 contents_col_bold">
                                        マイクロチップの有無
                                    </div>
                                    <div class="col-12 col-md-8 contents_col_normal">
                                        {% if breederPet.getIsMicrochip == 1 %}
                                            代金に含む
                                        {% else %}
                                            代金に含まない
                                            {%if breederPet.getmicrochipCode() != "" %}
                                                （{{ breederPet.getmicrochipCode() }}）
                                            {% endif %}
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 breeder_section_detail">
                                <div class="row">
                                    <div class="col-12 col-md-4 contents_col_bold">
                                        {% if breederPet.getPetKind() == 1 %}
                                        成犬時予想体重
                                        {% else %}
                                        成猫時予想体重
                                        {% endif %}
                                    </div>
                                    <div class="col-12 col-md-8 contents_col_normal">
                                        {{ breederPet.futureWait }}kg
                                    </div>
                                </div>
                            </div>
                            {% if is56DaysOld <= 56 and is56DaysOld >= 0 %}
                                {% if breederPet.getPetKind() == 1 %}
                                    <div class="col-12 contents_col_normal mt-4 mb-4 pl-4 pr-4"
                                        style="background:#f7f5f0; border:1px solid #dcdfe1; border-radius: 3px;">
                                        <h6 class="text-align-center mb-2" style="color:#399634">
                                            <i class="fas fa-info-circle"></i>
                                            【生後56日を過ぎていない子犬の引き渡しについて】
                                        </h6>
                                        動物愛護法により、生後56日を過ぎていない子犬の引き渡しが禁止されています。<br>
                                        この子犬はまだ生後56日を過ぎていませんので、すぐに引き渡しを行う事はできません。<br>
                                        生後56日を過ぎていなくてもブリーダーの下で親犬や兄弟犬と共に飼養されている環境であれば購入検討のためにご見学することは可能です。<br>
                                    </div>
                                {% else %}
                                    <div class="col-12 contents_col_normal mt-4 mb-4 pl-4 pr-4"
                                        style="background:#f7f5f0; border:1px solid #dcdfe1; border-radius: 3px;">
                                        <h6 class="text-align-center mb-2" style="color:#399634">
                                            <i class="fas fa-info-circle"></i>
                                            【生後56日を過ぎていない子猫の引き渡しについて】
                                        </h6>
                                        動物愛護法により、生後56日を過ぎていない子猫の引き渡しが禁止されています。<br>
                                        この子猫はまだ生後56日を過ぎていませんので、すぐに引き渡しを行う事はできません。<br>
                                        生後56日を過ぎていなくてもブリーダーの下で親猫や兄弟猫と共に飼養されている環境であれば購入検討のためにご見学することは可能です。<br>
                                    </div>
                                {% endif %}
                            {% endif %}
                            <div class="breeder_section_header">
                                <i class="fas fa-paw"></i>
                                PRコメント
                            </div>
                            <div class="col-12 breeder_section_detail">
                                <div class="row">
                                    <div class="col-12 contents_col_normal">
                                        {{ breederPet.prComment | nl2br }}
                                    </div>
                                </div>
                            </div>
                            {% if not breederPet.getIsContract() and not breederPet.getIsDelete() %}
                            <div class="breeder_section_header">
                                <i class="fas fa-paw"></i>
                                金額
                            </div>
                            <div class="col-12 breeder_section_detail">
                                <div class="row">
                                    <div class="col-12 contents_col_price">
                                        {% if breederPet.getPriceNoDisplay() %}
                                            「この子の見学希望／お問い合わせ(無料)」にてお問い合わせください。
                                        {% else %}
                                            {{ breederPet.price|number_format(0) }}円（税込）
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 btn_center">
                                <div class="row">
                                    <div class="col-12 contents_col_normal">
                                        <a href="{{ url('breeder_contact', {'pet_id': breederPet.id}) }}">
                                            <button class="btn basic-btn breeder-btn" style="height:65px;">
                                                {% if breederPet.getPetKind() == 1 %}
                                                この子犬の見学希望／お問い合わせ(無料)
                                                {% else %}
                                                この子猫の見学希望／お問い合わせ(無料)
                                                {% endif %}
                                            </button>
                                        </a>
                                    </div>
                                </div>
                            </div>
                            {% endif %}

                            <div class="mb-4 mt-4">
                                <div class="breeder_section_header">
                                    {# <i class="fas fa-paw"></i> #}
                                    アニマルラインを通してご購入いただくと下記の特典が受けられます！
                                </div>
                                <table class="tbl_benefits">
                                    <tr>
                                        <th>ご成約特典①</th>
                                        <td>
                                            プレミアムペットフード1種・おもちゃ2種を無料にてご提供いたします。商品詳細はご成約後にお伝えいたします。
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>ご成約特典②</th>
                                        <td>
                                            ペットシーツ60枚入りを無料にてご提供いたします。
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>ご成約特典③</th>
                                        <td>
                                            ＥＣサイト　<a href="https://animalline.jp/ec" target="_blank">https://animalline.jp/ec</a>　でご利用いただけるポイントを1,000ポイント付与いたします。
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>ご成約特典④</th>
                                        <td>
                                            DNAの遺伝病検査結果を無料でお渡しいたします。メール（PDF）または郵送にて対応いたします。
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>ご成約特典⑤</th>
                                        <td>
                                            ケア用品（シャンプー・リンス各15ml）を無料にて提供いたします
                                        </td>
                                    </tr>
                                    {% if breederPet.getPetKind() == 1 %}
                                        <tr>
                                            <th>ご成約特典⑥</th>
                                            <td>
                                                無料のオンラインしつけ相談へご参加いただけます。ご都合のよろしい日にちをお知らせください。
                                            </td>
                                        </tr>
                                    {% endif %}
                                </table>
                            </div>

                            <div class="breeder_section_header_orange">
                                <i class="fas fa-paw"></i>
                                紹介文
                            </div>
                            <div class="col-12 breeder_section_detail">
                                <div class="row">
                                    <div class="col-12 contents_col_normal">
                                        {{ breederPet.description | nl2br }}
                                    </div>
                                </div>
                            </div>
                            <div class="breeder_section_header_orange">
                                <i class="fas fa-paw"></i>
                                生体保障内容
                            </div>
                            <div class="col-12 breeder_section_detail">
                                <div class="row">
                                    <div class="col-12 contents_col_normal">
                                        {{ breederPet.getGuarantee() | nl2br }}
                                    </div>
                                </div>
                            </div>
                            <div class="breeder_section_header_orange">
                                <i class="fas fa-paw"></i>
                                引き渡し方法
                            </div>
                            <div class="col-12 breeder_section_detail">
                                <div class="row">
                                    <div class="col-12 contents_col_normal">
                                        {{ breederPet.getDeliveryWay() | nl2br }}
                                    </div>
                                </div>
                            </div>

                            <div class="breeder_section_header_orange">
                                <i class="fas fa-paw"></i>
                                お支払方法
                            </div>
                            <div class="col-12 breeder_section_detail">
                                <div class="row">
                                    <div class="col-12 contents_col_normal">
                                        {{ breederPet.getPaymentMethod() | nl2br }}
                                    </div>
                                </div>
                            </div>

                            <div class="breeder_section_header_orange">
                                <i class="fas fa-paw"></i>
                                予約金
                            </div>
                            <div class="col-12 breeder_section_detail">
                                <div class="row">
                                    <div class="col-12 contents_col_normal">
                                        {{ breederPet.getReservationFee() | nl2br }}
                                    </div>
                                </div>
                            </div>

                            {% if not breederPet.getIsContract() and not breederPet.getIsDelete() %}
                            <div class="col-12 btn_center">
                                <div class="row">
                                    <div class="col-12">
                                        <a href="{{ url('breeder_contact', {'pet_id': breederPet.id}) }}">
                                            <button class="btn basic-btn breeder-btn" style="height:65px;">
                                                {% if breederPet.getPetKind() == 1 %}
                                                この子犬の見学希望／お問い合わせ(無料)
                                                {% else %}
                                                この子猫の見学希望／お問い合わせ(無料)
                                                {% endif %}
                                            </button>
                                        </a>
                                    </div>
                                </div>
                            </div>
                            {% endif %}

                            <div class="col-12 contents_col_normal mt-4 mb-4 pl-4 pr-4"
                                 style="background:#f7f5f0; border:1px solid #dcdfe1; border-radius: 3px;">
                                当サイトではお客様に最も信頼されるブリーダー子犬・子猫直販サイトを目指して、<br>
                                子犬・子猫情報およびブリーダー情報の正確性向上に努めております。<br>
                                当サイトに掲載されている情報で誤解を招く表現、事実と異なる表現などのお気づきの点がございましたら<br>
                                事務局へのお問い合わせフォームよりご連絡をお願いいたします。<br>
                            </div>
                            <div class="m-2 p-2"></div>
                            <div class="breeder_section_header">
                                <i class="fas fa-paw"></i>
                                ブリーダー紹介
                            </div>
                            <div class="m-2 p-2"></div>
                            <div class="row">
                                <div class="breeder-img col-sm-4">
                                    <img alt="..."
                                         src="{{ breederPet.Breeder.thumbnailPath | default('/' ~ constant('Customize\\Config\\AnilineConf::ANILINE_IMAGE_URL_BASE') ~ '/noimage_plugin_list.png') }}"
                                         class="w-100 mb-4 mb-sm-0"></div>
                                <div class="breeder-info col-sm-8">
                                    <h3 class="font-weight-500 color-gray-500 mb-4">
                                        {{ breederPet.Breeder.getLicenseHouseName() }}
                                    </h3>
                                    <div class="d-flex mb-2">
                                        {{ include('animalline/components/_rating_block.twig', { 'point': breederPet.Breeder.breederRank() }, ignore_missing = false) }}
                                    </div>
                                    <div class="d-flex mb-2">
                                        <h6>
                                            動物取扱業登録番号：
                                        </h6>
                                        <h6>
                                            {{ breederPet.Breeder.getLicenseNo() }}&emsp;
                                        </h6>
                                        <h6>
                                            登録：
                                        </h6>
                                        <h6>
                                            {{ breederPet.Breeder.getLicenseRegistDate()|date('Y/m/d') }}
                                        </h6>
                                    </div>
                                    <div class="d-flex mb-2">
                                        <h6>
                                            有効期限：
                                        </h6>
                                        <h6>
                                            {{ breederPet.Breeder.getLicenseExpireDate()|date('Y/m/d') }}&emsp;
                                        </h6>
                                        <h6>
                                            動物取扱責任者：
                                        </h6>
                                        <h6>
                                            {{ breederPet.Breeder.getLicenseManagerName() }}
                                        </h6>
                                    </div>
                                    <div class="d-flex mb-4">
                                        <h6>
                                            犬舎所在地：
                                        </h6>
                                        {% set breederHouseDog = breederPet.Breeder.getBreederHouseByPetType(constant('Customize\\Config\\AnilineConf::ANILINE_PET_KIND_DOG')) %}
                                        {% set breederHouseCat = breederPet.Breeder.getBreederHouseByPetType(constant('Customize\\Config\\AnilineConf::ANILINE_PET_KIND_CAT')) %}
                                        {% if (breederPet.Breeder.handlingPetKind == constant('Customize\\Config\\AnilineConf::ANILINE_PET_KIND_DOG_CAT')) %}
                                            <h6>
                                                {{ breederHouseDog.breederHousePref ~ breederHouseDog.breederHouseCity ?? '' ~ ' ' ~ breederHouseCat.breederHousePref ~ breederHouseCat.breederHouseCity ?? '' }}
                                            </h6>
                                        {% elseif (breederPet.Breeder.handlingPetKind == constant('Customize\\Config\\AnilineConf::ANILINE_PET_KIND_DOG')) %}
                                            <h6>
                                                {{ breederHouseDog.breederHousePref ~ breederHouseDog.breederHouseCity ?? '' }}
                                            </h6>
                                        {% else %}
                                            <h6>
                                                {{ breederHouseCat.breederHousePref ~ breederHouseCat.breederHouseCity ?? '' }}
                                            </h6>
                                        {% endif %}
                                    </div>
                                    <!--
                                                    <div class="d-flex">
                                                        <h6>犬舎見学：</h6>
                                                        {% set ex_status = ['審査前', '審査中', '審査OK', '審査NG'] %}
                                                        <h6>{{ ex_status[breederPet.Breeder.examinationStatus] }}</h6>
                                                    </div>
                                                -->
                                    <a href="{{ url('breeder_detail', {'breeder_id':breederPet.Breeder.id}) }}">
                                        <h4 class="color-breeder">
                                            ブリーダー詳細ページへ
                                        </h4>
                                    </a>
                                </div>
                            </div>
                            <div class="m-2 p-2"></div>
                            {# <div class="row"> #}
                            {# <div>
                                            <div class="breeder_section_header_orange">
                                                <i class="fas fa-paw"></i>
                                                PRコメント                                        
                                            </div>
                                            <div class="col-12 breeder_section_detail">
                                                <div class="row">
                                                    <div class="col-12 contents_col_normal">
                                                        {{ breederPet.Breeder.getPrText()| nl2br }}
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="breeder_section_header_orange">
                                                <i class="fas fa-paw"></i>
                                                動物愛護法改正への対応                                      
                                            </div>
                                            <div class="col-12 breeder_section_detail">
                                                <div class="row">
                                                    <div class="col-12 contents_col_normal">
                                                        {{ breederPet.Breeder.getRegalEffort()| nl2br }}
                                                    </div>
                                                </div>
                                            </div>
                                        </div> #}
                        </div>
                    </div>
                </div>
                {% include 'animalline/breeder/side.twig' %}
            </div>
        </div>
    </section>
{% endblock %}
{% block stylesheet %}
    <link rel="stylesheet" href="{{ asset('assets/css/breeder-style.css') }}">
{% endblock %}
{% block javascript %}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script>
    $(document).on("click", ".btn-like", function () {
        if ($(this).data('login')) {
            $.ajax({
                type: "POST",
                dataType: "json",
                url: '{{ url('breeder_favorite_pet') }}',
                data: {
                    'id': $(this).data('id')
                },
                success: function (data) {
                    if (data == 'not-allowed') {
                        alert('自分のペットなので、お気に入りの項目に入れないでください。')
                    } else if (data == 'liked') {
                        $('#textBtnLike').text('お気に入りから削除')
                        $('svg.heart-icon path').attr('fill', '#FF424F')
                        $('.btn-like').addClass('red-heart')
                    } else {
                        $('#textBtnLike').text('お気に入りに追加')
                        $('svg.heart-icon path').attr('fill', 'none')
                        $('.btn-like').removeClass('red-heart')
                    }
                }
            });
        } else {
            alert('お気に入り機能を利用するにはログインが必要です')
        }
    });
</script>
{% endblock %}