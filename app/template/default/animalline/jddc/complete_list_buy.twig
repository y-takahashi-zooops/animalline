{% extends 'animalline/jddc/frame.twig' %}
{% set status = {4: '検体異常',6: '検査通過', 7: '検査NG',8: '検体異常'} %}
{% set params = app.request.query.all %}

{% block main %}
    <div class="main">
        <div class="row">
            <div class="main-container col-12">
                <h1 class="mb-0">検査済みペット一覧（有料検査）</h1>
                <!--
                
                <div class="ec-select float-right">
                    <select name="filter_status" onchange="location.href = `?filter_status=${this.value}`">
                        <option value="">全件</option>
                        <option value="{{ constant('Customize\\Config\\AnilineConf::ANILINE_DNA_CHECK_STATUS_PET_REGISTERED') }}" {{ params.filter_status is defined and params.filter_status == constant('Customize\\Config\\AnilineConf::ANILINE_DNA_CHECK_STATUS_PET_REGISTERED') ? 'selected' }}>
                            キット到着待ち
                        </option>
                        <option value="{{ constant('Customize\\Config\\AnilineConf::ANILINE_DNA_CHECK_STATUS_CHECKING') }}" {{ params.filter_status is defined and params.filter_status == constant('Customize\\Config\\AnilineConf::ANILINE_DNA_CHECK_STATUS_CHECKING') ? 'selected' }}>
                            検査中
                        </option>
                    </select>
                </div>
                
                -->
                <form action="#">
                <div class="ec-select float-right">
                        <label class="col-form-label">検査結果登録日</label>
                        <div class="form-row align-items-center">
                            <div class="col">
                                <input type="date" id="create_date_from" name="create_date_from" class="form-control"
                                    value="{{ params.create_date_from is defined ? params.create_date_from : '' }}" />
                            </div>
                            <div class="col-auto text-center">〜</div>
                            <div class="col">
                                <input type="date" id="create_date_to" name="create_date_to" class="form-control"
                                    value="{{ params.create_date_to is defined ? params.create_date_to : '' }}" />
                            </div>
                            <button type="submit" class="btn btn-warning w-100 m-1" id="dnaTestResultRegist">
                                検索
                            </button>
                        </div>
                    </div>
                </div>
                
                </form>
                
                <table class="table table-sm dna-table text-center responsive-table">
                    <thead>
                    <tr class="heading">
                        <th class="border-top-0 pt-2 pb-2">No.</th>
                        <th class="border-top-0 pt-2 pb-2">送付者名</th>
                        <th class="border-top-0 pt-2 pb-2">犬・猫種別</th>
                        <th class="border-top-0 pt-2 pb-2">犬種・猫種</th>
                        <th class="border-top-0 pt-2 pb-2">生年月日</th>
                        <th class="border-top-0 pt-2 pb-2">検査項目</th>
                        <th class="border-top-0 pt-2 pb-2">検査結果</th>
                        <th class="border-top-0 pt-2 pb-2">検査結果登録日</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for dna in dnas %}
                        <tr>
                            <td class="id"
                                data-label="No">{{ (dna.site_type == constant('Customize\\Config\\AnilineConf::SITE_CATEGORY_BREEDER') ? '1' : '2') ~ "%05d"|format(dna.dna_id) }}</td>
                            <td data-label="送付者名">{{ dna.shipping_name }}</td>
                            <td data-label="犬・猫種別">{{ dna.pet_kind == constant('Customize\\Config\\AnilineConf::ANILINE_PET_KIND_DOG') ? '犬' : '猫' }}</td>
                            <td data-label="犬種・猫種">{{ dna.breeds_name ?: '_' }}</td>
                            <td data-label="生年月日">{{ dna.pet_birthday ? dna.pet_birthday | date('Y/m/d') : '_' }}</td>
                            <td data-label="検査項目">{{ dna.check_kinds | join('<br>') | raw }}</td>
                            <td data-label="検査ステータス	">{{ status[dna.check_status] }}</td>
                            <td data-label="ペット情報登録日時">{{ dna.check_return_date | date('Y/m/d') }}</td>
                        </tr>
                    {% else %}
                        <tr>
                            <td colspan="6">結果が０件です。</td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
                <div class="navigation float-right">
                    {{ knp_pagination_render(dnas, '@KnpPaginator/twitter_bootstrap_v4_pagination.html.twig') }}
                </div>
            </div>
            <div class="clearfix"></div>
            <div class="ec-registerRole__actions">
                <div class="ec-off4Grid">
                    <div class="ec-off4Grid__cell">
                        <a href="{{ url('jddc_index') }}" class="btn btn-warning w-100 m-1">戻る</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
