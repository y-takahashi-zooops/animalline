export default"data:application/javascript;charset=utf-8;base64,YWNlLmRlZmluZSgiYWNlL21vZGUveG1sX2hpZ2hsaWdodF9ydWxlcyIsWyJyZXF1aXJlIiwiZXhwb3J0cyIsIm1vZHVsZSIsImFjZS9saWIvb29wIiwiYWNlL21vZGUvdGV4dF9oaWdobGlnaHRfcnVsZXMiXSwgZnVuY3Rpb24ocmVxdWlyZSwgZXhwb3J0cywgbW9kdWxlKXsidXNlIHN0cmljdCI7CnZhciBvb3AgPSByZXF1aXJlKCIuLi9saWIvb29wIik7CnZhciBUZXh0SGlnaGxpZ2h0UnVsZXMgPSByZXF1aXJlKCIuL3RleHRfaGlnaGxpZ2h0X3J1bGVzIikuVGV4dEhpZ2hsaWdodFJ1bGVzOwp2YXIgWG1sSGlnaGxpZ2h0UnVsZXMgPSBmdW5jdGlvbiAobm9ybWFsaXplKSB7CiAgICB2YXIgdGFnUmVnZXggPSAiW186YS16QS1aXHhjMC1cdWZmZmZdWy1fOi5hLXpBLVowLTlceGMwLVx1ZmZmZl0qIjsKICAgIHRoaXMuJHJ1bGVzID0gewogICAgICAgIHN0YXJ0OiBbCiAgICAgICAgICAgIHsgdG9rZW46ICJzdHJpbmcuY2RhdGEueG1sIiwgcmVnZXg6ICI8XFwhXFxbQ0RBVEFcXFsiLCBuZXh0OiAiY2RhdGEiIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHRva2VuOiBbInB1bmN0dWF0aW9uLmluc3RydWN0aW9uLnhtbCIsICJrZXl3b3JkLmluc3RydWN0aW9uLnhtbCJdLAogICAgICAgICAgICAgICAgcmVnZXg6ICIoPFxcPykoIiArIHRhZ1JlZ2V4ICsgIikiLCBuZXh0OiAicHJvY2Vzc2luZ19pbnN0cnVjdGlvbiIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgeyB0b2tlbjogImNvbW1lbnQuc3RhcnQueG1sIiwgcmVnZXg6ICI8XFwhLS0iLCBuZXh0OiAiY29tbWVudCIgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdG9rZW46IFsieG1sLXBlLmRvY3R5cGUueG1sIiwgInhtbC1wZS5kb2N0eXBlLnhtbCJdLAogICAgICAgICAgICAgICAgcmVnZXg6ICIoPFxcISkoRE9DVFlQRSkoPz1bXFxzXSkiLCBuZXh0OiAiZG9jdHlwZSIsIGNhc2VJbnNlbnNpdGl2ZTogdHJ1ZQogICAgICAgICAgICB9LAogICAgICAgICAgICB7IGluY2x1ZGU6ICJ0YWciIH0sCiAgICAgICAgICAgIHsgdG9rZW46ICJ0ZXh0LmVuZC10YWctb3Blbi54bWwiLCByZWdleDogIjwvIiB9LAogICAgICAgICAgICB7IHRva2VuOiAidGV4dC50YWctb3Blbi54bWwiLCByZWdleDogIjwiIH0sCiAgICAgICAgICAgIHsgaW5jbHVkZTogInJlZmVyZW5jZSIgfSwKICAgICAgICAgICAgeyBkZWZhdWx0VG9rZW46ICJ0ZXh0LnhtbCIgfQogICAgICAgIF0sCiAgICAgICAgcHJvY2Vzc2luZ19pbnN0cnVjdGlvbjogW3sKICAgICAgICAgICAgICAgIHRva2VuOiAiZW50aXR5Lm90aGVyLmF0dHJpYnV0ZS1uYW1lLmRlY2wtYXR0cmlidXRlLW5hbWUueG1sIiwKICAgICAgICAgICAgICAgIHJlZ2V4OiB0YWdSZWdleAogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICB0b2tlbjogImtleXdvcmQub3BlcmF0b3IuZGVjbC1hdHRyaWJ1dGUtZXF1YWxzLnhtbCIsCiAgICAgICAgICAgICAgICByZWdleDogIj0iCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIGluY2x1ZGU6ICJ3aGl0ZXNwYWNlIgogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICBpbmNsdWRlOiAic3RyaW5nIgogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICB0b2tlbjogInB1bmN0dWF0aW9uLnhtbC1kZWNsLnhtbCIsCiAgICAgICAgICAgICAgICByZWdleDogIlxcPz4iLAogICAgICAgICAgICAgICAgbmV4dDogInN0YXJ0IgogICAgICAgICAgICB9XSwKICAgICAgICBkb2N0eXBlOiBbCiAgICAgICAgICAgIHsgaW5jbHVkZTogIndoaXRlc3BhY2UiIH0sCiAgICAgICAgICAgIHsgaW5jbHVkZTogInN0cmluZyIgfSwKICAgICAgICAgICAgeyB0b2tlbjogInhtbC1wZS5kb2N0eXBlLnhtbCIsIHJlZ2V4OiAiPiIsIG5leHQ6ICJzdGFydCIgfSwKICAgICAgICAgICAgeyB0b2tlbjogInhtbC1wZS54bWwiLCByZWdleDogIlstX2EtekEtWjAtOTpdKyIgfSwKICAgICAgICAgICAgeyB0b2tlbjogInB1bmN0dWF0aW9uLmludC1zdWJzZXQiLCByZWdleDogIlxcWyIsIHB1c2g6ICJpbnRfc3Vic2V0IiB9CiAgICAgICAgXSwKICAgICAgICBpbnRfc3Vic2V0OiBbewogICAgICAgICAgICAgICAgdG9rZW46ICJ0ZXh0LnhtbCIsCiAgICAgICAgICAgICAgICByZWdleDogIlxccysiCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIHRva2VuOiAicHVuY3R1YXRpb24uaW50LXN1YnNldC54bWwiLAogICAgICAgICAgICAgICAgcmVnZXg6ICJdIiwKICAgICAgICAgICAgICAgIG5leHQ6ICJwb3AiCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIHRva2VuOiBbInB1bmN0dWF0aW9uLm1hcmt1cC1kZWNsLnhtbCIsICJrZXl3b3JkLm1hcmt1cC1kZWNsLnhtbCJdLAogICAgICAgICAgICAgICAgcmVnZXg6ICIoPFxcISkoIiArIHRhZ1JlZ2V4ICsgIikiLAogICAgICAgICAgICAgICAgcHVzaDogW3sKICAgICAgICAgICAgICAgICAgICAgICAgdG9rZW46ICJ0ZXh0IiwKICAgICAgICAgICAgICAgICAgICAgICAgcmVnZXg6ICJcXHMrIgogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICB0b2tlbjogInB1bmN0dWF0aW9uLm1hcmt1cC1kZWNsLnhtbCIsCiAgICAgICAgICAgICAgICAgICAgICAgIHJlZ2V4OiAiPiIsCiAgICAgICAgICAgICAgICAgICAgICAgIG5leHQ6ICJwb3AiCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB7IGluY2x1ZGU6ICJzdHJpbmciIH1dCiAgICAgICAgICAgIH1dLAogICAgICAgIGNkYXRhOiBbCiAgICAgICAgICAgIHsgdG9rZW46ICJzdHJpbmcuY2RhdGEueG1sIiwgcmVnZXg6ICJcXF1cXF0+IiwgbmV4dDogInN0YXJ0IiB9LAogICAgICAgICAgICB7IHRva2VuOiAidGV4dC54bWwiLCByZWdleDogIlxccysiIH0sCiAgICAgICAgICAgIHsgdG9rZW46ICJ0ZXh0LnhtbCIsIHJlZ2V4OiAiKD86W15cXF1dfFxcXSg/IVxcXT4pKSsiIH0KICAgICAgICBdLAogICAgICAgIGNvbW1lbnQ6IFsKICAgICAgICAgICAgeyB0b2tlbjogImNvbW1lbnQuZW5kLnhtbCIsIHJlZ2V4OiAiLS0+IiwgbmV4dDogInN0YXJ0IiB9LAogICAgICAgICAgICB7IGRlZmF1bHRUb2tlbjogImNvbW1lbnQueG1sIiB9CiAgICAgICAgXSwKICAgICAgICByZWZlcmVuY2U6IFt7CiAgICAgICAgICAgICAgICB0b2tlbjogImNvbnN0YW50Lmxhbmd1YWdlLmVzY2FwZS5yZWZlcmVuY2UueG1sIiwKICAgICAgICAgICAgICAgIHJlZ2V4OiAiKD86JiNbMC05XSs7KXwoPzomI3hbMC05YS1mQS1GXSs7KXwoPzomW2EtekEtWjAtOV86XFwuLV0rOykiCiAgICAgICAgICAgIH1dLAogICAgICAgIGF0dHJfcmVmZXJlbmNlOiBbewogICAgICAgICAgICAgICAgdG9rZW46ICJjb25zdGFudC5sYW5ndWFnZS5lc2NhcGUucmVmZXJlbmNlLmF0dHJpYnV0ZS12YWx1ZS54bWwiLAogICAgICAgICAgICAgICAgcmVnZXg6ICIoPzomI1swLTldKzspfCg/OiYjeFswLTlhLWZBLUZdKzspfCg/OiZbYS16QS1aMC05XzpcXC4tXSs7KSIKICAgICAgICAgICAgfV0sCiAgICAgICAgdGFnOiBbewogICAgICAgICAgICAgICAgdG9rZW46IFsibWV0YS50YWcucHVuY3R1YXRpb24udGFnLW9wZW4ueG1sIiwgIm1ldGEudGFnLnB1bmN0dWF0aW9uLmVuZC10YWctb3Blbi54bWwiLCAibWV0YS50YWcudGFnLW5hbWUueG1sIl0sCiAgICAgICAgICAgICAgICByZWdleDogIig/Oig8KXwoPC8pKSgoPzoiICsgdGFnUmVnZXggKyAiOik/IiArIHRhZ1JlZ2V4ICsgIikiLAogICAgICAgICAgICAgICAgbmV4dDogWwogICAgICAgICAgICAgICAgICAgIHsgaW5jbHVkZTogImF0dHJpYnV0ZXMiIH0sCiAgICAgICAgICAgICAgICAgICAgeyB0b2tlbjogIm1ldGEudGFnLnB1bmN0dWF0aW9uLnRhZy1jbG9zZS54bWwiLCByZWdleDogIi8/PiIsIG5leHQ6ICJzdGFydCIgfQogICAgICAgICAgICAgICAgXQogICAgICAgICAgICB9XSwKICAgICAgICB0YWdfd2hpdGVzcGFjZTogWwogICAgICAgICAgICB7IHRva2VuOiAidGV4dC50YWctd2hpdGVzcGFjZS54bWwiLCByZWdleDogIlxccysiIH0KICAgICAgICBdLAogICAgICAgIHdoaXRlc3BhY2U6IFsKICAgICAgICAgICAgeyB0b2tlbjogInRleHQud2hpdGVzcGFjZS54bWwiLCByZWdleDogIlxccysiIH0KICAgICAgICBdLAogICAgICAgIHN0cmluZzogW3sKICAgICAgICAgICAgICAgIHRva2VuOiAic3RyaW5nLnhtbCIsCiAgICAgICAgICAgICAgICByZWdleDogIiciLAogICAgICAgICAgICAgICAgcHVzaDogWwogICAgICAgICAgICAgICAgICAgIHsgdG9rZW46ICJzdHJpbmcueG1sIiwgcmVnZXg6ICInIiwgbmV4dDogInBvcCIgfSwKICAgICAgICAgICAgICAgICAgICB7IGRlZmF1bHRUb2tlbjogInN0cmluZy54bWwiIH0KICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgdG9rZW46ICJzdHJpbmcueG1sIiwKICAgICAgICAgICAgICAgIHJlZ2V4OiAnIicsCiAgICAgICAgICAgICAgICBwdXNoOiBbCiAgICAgICAgICAgICAgICAgICAgeyB0b2tlbjogInN0cmluZy54bWwiLCByZWdleDogJyInLCBuZXh0OiAicG9wIiB9LAogICAgICAgICAgICAgICAgICAgIHsgZGVmYXVsdFRva2VuOiAic3RyaW5nLnhtbCIgfQogICAgICAgICAgICAgICAgXQogICAgICAgICAgICB9XSwKICAgICAgICBhdHRyaWJ1dGVzOiBbewogICAgICAgICAgICAgICAgdG9rZW46ICJlbnRpdHkub3RoZXIuYXR0cmlidXRlLW5hbWUueG1sIiwKICAgICAgICAgICAgICAgIHJlZ2V4OiB0YWdSZWdleAogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICB0b2tlbjogImtleXdvcmQub3BlcmF0b3IuYXR0cmlidXRlLWVxdWFscy54bWwiLAogICAgICAgICAgICAgICAgcmVnZXg6ICI9IgogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICBpbmNsdWRlOiAidGFnX3doaXRlc3BhY2UiCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIGluY2x1ZGU6ICJhdHRyaWJ1dGVfdmFsdWUiCiAgICAgICAgICAgIH1dLAogICAgICAgIGF0dHJpYnV0ZV92YWx1ZTogW3sKICAgICAgICAgICAgICAgIHRva2VuOiAic3RyaW5nLmF0dHJpYnV0ZS12YWx1ZS54bWwiLAogICAgICAgICAgICAgICAgcmVnZXg6ICInIiwKICAgICAgICAgICAgICAgIHB1c2g6IFsKICAgICAgICAgICAgICAgICAgICB7IHRva2VuOiAic3RyaW5nLmF0dHJpYnV0ZS12YWx1ZS54bWwiLCByZWdleDogIiciLCBuZXh0OiAicG9wIiB9LAogICAgICAgICAgICAgICAgICAgIHsgaW5jbHVkZTogImF0dHJfcmVmZXJlbmNlIiB9LAogICAgICAgICAgICAgICAgICAgIHsgZGVmYXVsdFRva2VuOiAic3RyaW5nLmF0dHJpYnV0ZS12YWx1ZS54bWwiIH0KICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgdG9rZW46ICJzdHJpbmcuYXR0cmlidXRlLXZhbHVlLnhtbCIsCiAgICAgICAgICAgICAgICByZWdleDogJyInLAogICAgICAgICAgICAgICAgcHVzaDogWwogICAgICAgICAgICAgICAgICAgIHsgdG9rZW46ICJzdHJpbmcuYXR0cmlidXRlLXZhbHVlLnhtbCIsIHJlZ2V4OiAnIicsIG5leHQ6ICJwb3AiIH0sCiAgICAgICAgICAgICAgICAgICAgeyBpbmNsdWRlOiAiYXR0cl9yZWZlcmVuY2UiIH0sCiAgICAgICAgICAgICAgICAgICAgeyBkZWZhdWx0VG9rZW46ICJzdHJpbmcuYXR0cmlidXRlLXZhbHVlLnhtbCIgfQogICAgICAgICAgICAgICAgXQogICAgICAgICAgICB9XQogICAgfTsKICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBYbWxIaWdobGlnaHRSdWxlcykKICAgICAgICB0aGlzLm5vcm1hbGl6ZVJ1bGVzKCk7Cn07CihmdW5jdGlvbiAoKSB7CiAgICB0aGlzLmVtYmVkVGFnUnVsZXMgPSBmdW5jdGlvbiAoSGlnaGxpZ2h0UnVsZXMsIHByZWZpeCwgdGFnKSB7CiAgICAgICAgdGhpcy4kcnVsZXMudGFnLnVuc2hpZnQoewogICAgICAgICAgICB0b2tlbjogWyJtZXRhLnRhZy5wdW5jdHVhdGlvbi50YWctb3Blbi54bWwiLCAibWV0YS50YWcuIiArIHRhZyArICIudGFnLW5hbWUueG1sIl0sCiAgICAgICAgICAgIHJlZ2V4OiAiKDwpKCIgKyB0YWcgKyAiKD89XFxzfD58JCkpIiwKICAgICAgICAgICAgbmV4dDogWwogICAgICAgICAgICAgICAgeyBpbmNsdWRlOiAiYXR0cmlidXRlcyIgfSwKICAgICAgICAgICAgICAgIHsgdG9rZW46ICJtZXRhLnRhZy5wdW5jdHVhdGlvbi50YWctY2xvc2UueG1sIiwgcmVnZXg6ICIvPz4iLCBuZXh0OiBwcmVmaXggKyAic3RhcnQiIH0KICAgICAgICAgICAgXQogICAgICAgIH0pOwogICAgICAgIHRoaXMuJHJ1bGVzW3RhZyArICItZW5kIl0gPSBbCiAgICAgICAgICAgIHsgaW5jbHVkZTogImF0dHJpYnV0ZXMiIH0sCiAgICAgICAgICAgIHsgdG9rZW46ICJtZXRhLnRhZy5wdW5jdHVhdGlvbi50YWctY2xvc2UueG1sIiwgcmVnZXg6ICIvPz4iLCBuZXh0OiAic3RhcnQiLAogICAgICAgICAgICAgICAgb25NYXRjaDogZnVuY3Rpb24gKHZhbHVlLCBjdXJyZW50U3RhdGUsIHN0YWNrKSB7CiAgICAgICAgICAgICAgICAgICAgc3RhY2suc3BsaWNlKDApOwogICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnRva2VuOwogICAgICAgICAgICAgICAgfSB9CiAgICAgICAgXTsKICAgICAgICB0aGlzLmVtYmVkUnVsZXMoSGlnaGxpZ2h0UnVsZXMsIHByZWZpeCwgW3sKICAgICAgICAgICAgICAgIHRva2VuOiBbIm1ldGEudGFnLnB1bmN0dWF0aW9uLmVuZC10YWctb3Blbi54bWwiLCAibWV0YS50YWcuIiArIHRhZyArICIudGFnLW5hbWUueG1sIl0sCiAgICAgICAgICAgICAgICByZWdleDogIig8LykoIiArIHRhZyArICIoPz1cXHN8PnwkKSkiLAogICAgICAgICAgICAgICAgbmV4dDogdGFnICsgIi1lbmQiCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIHRva2VuOiAic3RyaW5nLmNkYXRhLnhtbCIsCiAgICAgICAgICAgICAgICByZWdleDogIjxcXCFcXFtDREFUQVxcWyIKICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgdG9rZW46ICJzdHJpbmcuY2RhdGEueG1sIiwKICAgICAgICAgICAgICAgIHJlZ2V4OiAiXFxdXFxdPiIKICAgICAgICAgICAgfV0pOwogICAgfTsKfSkuY2FsbChUZXh0SGlnaGxpZ2h0UnVsZXMucHJvdG90eXBlKTsKb29wLmluaGVyaXRzKFhtbEhpZ2hsaWdodFJ1bGVzLCBUZXh0SGlnaGxpZ2h0UnVsZXMpOwpleHBvcnRzLlhtbEhpZ2hsaWdodFJ1bGVzID0gWG1sSGlnaGxpZ2h0UnVsZXM7Cgp9KTsKCmFjZS5kZWZpbmUoImFjZS9tb2RlL2JlaGF2aW91ci94bWwiLFsicmVxdWlyZSIsImV4cG9ydHMiLCJtb2R1bGUiLCJhY2UvbGliL29vcCIsImFjZS9tb2RlL2JlaGF2aW91ciIsImFjZS90b2tlbl9pdGVyYXRvciJdLCBmdW5jdGlvbihyZXF1aXJlLCBleHBvcnRzLCBtb2R1bGUpeyJ1c2Ugc3RyaWN0IjsKdmFyIG9vcCA9IHJlcXVpcmUoIi4uLy4uL2xpYi9vb3AiKTsKdmFyIEJlaGF2aW91ciA9IHJlcXVpcmUoIi4uL2JlaGF2aW91ciIpLkJlaGF2aW91cjsKdmFyIFRva2VuSXRlcmF0b3IgPSByZXF1aXJlKCIuLi8uLi90b2tlbl9pdGVyYXRvciIpLlRva2VuSXRlcmF0b3I7CmZ1bmN0aW9uIGlzKHRva2VuLCB0eXBlKSB7CiAgICByZXR1cm4gdG9rZW4gJiYgdG9rZW4udHlwZS5sYXN0SW5kZXhPZih0eXBlICsgIi54bWwiKSA+IC0xOwp9CnZhciBYbWxCZWhhdmlvdXIgPSBmdW5jdGlvbiAoKSB7CiAgICB0aGlzLmFkZCgic3RyaW5nX2RxdW90ZXMiLCAiaW5zZXJ0aW9uIiwgZnVuY3Rpb24gKHN0YXRlLCBhY3Rpb24sIGVkaXRvciwgc2Vzc2lvbiwgdGV4dCkgewogICAgICAgIGlmICh0ZXh0ID09ICciJyB8fCB0ZXh0ID09ICInIikgewogICAgICAgICAgICB2YXIgcXVvdGUgPSB0ZXh0OwogICAgICAgICAgICB2YXIgc2VsZWN0ZWQgPSBzZXNzaW9uLmRvYy5nZXRUZXh0UmFuZ2UoZWRpdG9yLmdldFNlbGVjdGlvblJhbmdlKCkpOwogICAgICAgICAgICBpZiAoc2VsZWN0ZWQgIT09ICIiICYmIHNlbGVjdGVkICE9PSAiJyIgJiYgc2VsZWN0ZWQgIT0gJyInICYmIGVkaXRvci5nZXRXcmFwQmVoYXZpb3Vyc0VuYWJsZWQoKSkgewogICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICB0ZXh0OiBxdW90ZSArIHNlbGVjdGVkICsgcXVvdGUsCiAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uOiBmYWxzZQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgICAgICB2YXIgY3Vyc29yID0gZWRpdG9yLmdldEN1cnNvclBvc2l0aW9uKCk7CiAgICAgICAgICAgIHZhciBsaW5lID0gc2Vzc2lvbi5kb2MuZ2V0TGluZShjdXJzb3Iucm93KTsKICAgICAgICAgICAgdmFyIHJpZ2h0Q2hhciA9IGxpbmUuc3Vic3RyaW5nKGN1cnNvci5jb2x1bW4sIGN1cnNvci5jb2x1bW4gKyAxKTsKICAgICAgICAgICAgdmFyIGl0ZXJhdG9yID0gbmV3IFRva2VuSXRlcmF0b3Ioc2Vzc2lvbiwgY3Vyc29yLnJvdywgY3Vyc29yLmNvbHVtbik7CiAgICAgICAgICAgIHZhciB0b2tlbiA9IGl0ZXJhdG9yLmdldEN1cnJlbnRUb2tlbigpOwogICAgICAgICAgICBpZiAocmlnaHRDaGFyID09IHF1b3RlICYmIChpcyh0b2tlbiwgImF0dHJpYnV0ZS12YWx1ZSIpIHx8IGlzKHRva2VuLCAic3RyaW5nIikpKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgIHRleHQ6ICIiLAogICAgICAgICAgICAgICAgICAgIHNlbGVjdGlvbjogWzEsIDFdCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghdG9rZW4pCiAgICAgICAgICAgICAgICB0b2tlbiA9IGl0ZXJhdG9yLnN0ZXBCYWNrd2FyZCgpOwogICAgICAgICAgICBpZiAoIXRva2VuKQogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB3aGlsZSAoaXModG9rZW4sICJ0YWctd2hpdGVzcGFjZSIpIHx8IGlzKHRva2VuLCAid2hpdGVzcGFjZSIpKSB7CiAgICAgICAgICAgICAgICB0b2tlbiA9IGl0ZXJhdG9yLnN0ZXBCYWNrd2FyZCgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHZhciByaWdodFNwYWNlID0gIXJpZ2h0Q2hhciB8fCByaWdodENoYXIubWF0Y2goL1xzLyk7CiAgICAgICAgICAgIGlmIChpcyh0b2tlbiwgImF0dHJpYnV0ZS1lcXVhbHMiKSAmJiAocmlnaHRTcGFjZSB8fCByaWdodENoYXIgPT0gJz4nKSB8fCAoaXModG9rZW4sICJkZWNsLWF0dHJpYnV0ZS1lcXVhbHMiKSAmJiAocmlnaHRTcGFjZSB8fCByaWdodENoYXIgPT0gJz8nKSkpIHsKICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgdGV4dDogcXVvdGUgKyBxdW90ZSwKICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb246IFsxLCAxXQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0pOwogICAgdGhpcy5hZGQoInN0cmluZ19kcXVvdGVzIiwgImRlbGV0aW9uIiwgZnVuY3Rpb24gKHN0YXRlLCBhY3Rpb24sIGVkaXRvciwgc2Vzc2lvbiwgcmFuZ2UpIHsKICAgICAgICB2YXIgc2VsZWN0ZWQgPSBzZXNzaW9uLmRvYy5nZXRUZXh0UmFuZ2UocmFuZ2UpOwogICAgICAgIGlmICghcmFuZ2UuaXNNdWx0aUxpbmUoKSAmJiAoc2VsZWN0ZWQgPT0gJyInIHx8IHNlbGVjdGVkID09ICInIikpIHsKICAgICAgICAgICAgdmFyIGxpbmUgPSBzZXNzaW9uLmRvYy5nZXRMaW5lKHJhbmdlLnN0YXJ0LnJvdyk7CiAgICAgICAgICAgIHZhciByaWdodENoYXIgPSBsaW5lLnN1YnN0cmluZyhyYW5nZS5zdGFydC5jb2x1bW4gKyAxLCByYW5nZS5zdGFydC5jb2x1bW4gKyAyKTsKICAgICAgICAgICAgaWYgKHJpZ2h0Q2hhciA9PSBzZWxlY3RlZCkgewogICAgICAgICAgICAgICAgcmFuZ2UuZW5kLmNvbHVtbisrOwogICAgICAgICAgICAgICAgcmV0dXJuIHJhbmdlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSk7CiAgICB0aGlzLmFkZCgiYXV0b2Nsb3NpbmciLCAiaW5zZXJ0aW9uIiwgZnVuY3Rpb24gKHN0YXRlLCBhY3Rpb24sIGVkaXRvciwgc2Vzc2lvbiwgdGV4dCkgewogICAgICAgIGlmICh0ZXh0ID09ICc+JykgewogICAgICAgICAgICB2YXIgcG9zaXRpb24gPSBlZGl0b3IuZ2V0U2VsZWN0aW9uUmFuZ2UoKS5zdGFydDsKICAgICAgICAgICAgdmFyIGl0ZXJhdG9yID0gbmV3IFRva2VuSXRlcmF0b3Ioc2Vzc2lvbiwgcG9zaXRpb24ucm93LCBwb3NpdGlvbi5jb2x1bW4pOwogICAgICAgICAgICB2YXIgdG9rZW4gPSBpdGVyYXRvci5nZXRDdXJyZW50VG9rZW4oKSB8fCBpdGVyYXRvci5zdGVwQmFja3dhcmQoKTsKICAgICAgICAgICAgaWYgKCF0b2tlbiB8fCAhKGlzKHRva2VuLCAidGFnLW5hbWUiKSB8fCBpcyh0b2tlbiwgInRhZy13aGl0ZXNwYWNlIikgfHwgaXModG9rZW4sICJhdHRyaWJ1dGUtbmFtZSIpIHx8IGlzKHRva2VuLCAiYXR0cmlidXRlLWVxdWFscyIpIHx8IGlzKHRva2VuLCAiYXR0cmlidXRlLXZhbHVlIikpKQogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICBpZiAoaXModG9rZW4sICJyZWZlcmVuY2UuYXR0cmlidXRlLXZhbHVlIikpCiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIGlmIChpcyh0b2tlbiwgImF0dHJpYnV0ZS12YWx1ZSIpKSB7CiAgICAgICAgICAgICAgICB2YXIgdG9rZW5FbmRDb2x1bW4gPSBpdGVyYXRvci5nZXRDdXJyZW50VG9rZW5Db2x1bW4oKSArIHRva2VuLnZhbHVlLmxlbmd0aDsKICAgICAgICAgICAgICAgIGlmIChwb3NpdGlvbi5jb2x1bW4gPCB0b2tlbkVuZENvbHVtbikKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICBpZiAocG9zaXRpb24uY29sdW1uID09IHRva2VuRW5kQ29sdW1uKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIG5leHRUb2tlbiA9IGl0ZXJhdG9yLnN0ZXBGb3J3YXJkKCk7CiAgICAgICAgICAgICAgICAgICAgaWYgKG5leHRUb2tlbiAmJiBpcyhuZXh0VG9rZW4sICJhdHRyaWJ1dGUtdmFsdWUiKSkKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIGl0ZXJhdG9yLnN0ZXBCYWNrd2FyZCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICgvXlxzKj4vLnRlc3Qoc2Vzc2lvbi5nZXRMaW5lKHBvc2l0aW9uLnJvdykuc2xpY2UocG9zaXRpb24uY29sdW1uKSkpCiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIHdoaWxlICghaXModG9rZW4sICJ0YWctbmFtZSIpKSB7CiAgICAgICAgICAgICAgICB0b2tlbiA9IGl0ZXJhdG9yLnN0ZXBCYWNrd2FyZCgpOwogICAgICAgICAgICAgICAgaWYgKHRva2VuLnZhbHVlID09ICI8IikgewogICAgICAgICAgICAgICAgICAgIHRva2VuID0gaXRlcmF0b3Iuc3RlcEZvcndhcmQoKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICB2YXIgdG9rZW5Sb3cgPSBpdGVyYXRvci5nZXRDdXJyZW50VG9rZW5Sb3coKTsKICAgICAgICAgICAgdmFyIHRva2VuQ29sdW1uID0gaXRlcmF0b3IuZ2V0Q3VycmVudFRva2VuQ29sdW1uKCk7CiAgICAgICAgICAgIGlmIChpcyhpdGVyYXRvci5zdGVwQmFja3dhcmQoKSwgImVuZC10YWctb3BlbiIpKQogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB2YXIgZWxlbWVudCA9IHRva2VuLnZhbHVlOwogICAgICAgICAgICBpZiAodG9rZW5Sb3cgPT0gcG9zaXRpb24ucm93KQogICAgICAgICAgICAgICAgZWxlbWVudCA9IGVsZW1lbnQuc3Vic3RyaW5nKDAsIHBvc2l0aW9uLmNvbHVtbiAtIHRva2VuQ29sdW1uKTsKICAgICAgICAgICAgaWYgKHRoaXMudm9pZEVsZW1lbnRzICYmIHRoaXMudm9pZEVsZW1lbnRzLmhhc093blByb3BlcnR5KGVsZW1lbnQudG9Mb3dlckNhc2UoKSkpCiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICB0ZXh0OiAiPiIgKyAiPC8iICsgZWxlbWVudCArICI+IiwKICAgICAgICAgICAgICAgIHNlbGVjdGlvbjogWzEsIDFdCiAgICAgICAgICAgIH07CiAgICAgICAgfQogICAgfSk7CiAgICB0aGlzLmFkZCgiYXV0b2luZGVudCIsICJpbnNlcnRpb24iLCBmdW5jdGlvbiAoc3RhdGUsIGFjdGlvbiwgZWRpdG9yLCBzZXNzaW9uLCB0ZXh0KSB7CiAgICAgICAgaWYgKHRleHQgPT0gIlxuIikgewogICAgICAgICAgICB2YXIgY3Vyc29yID0gZWRpdG9yLmdldEN1cnNvclBvc2l0aW9uKCk7CiAgICAgICAgICAgIHZhciBsaW5lID0gc2Vzc2lvbi5nZXRMaW5lKGN1cnNvci5yb3cpOwogICAgICAgICAgICB2YXIgaXRlcmF0b3IgPSBuZXcgVG9rZW5JdGVyYXRvcihzZXNzaW9uLCBjdXJzb3Iucm93LCBjdXJzb3IuY29sdW1uKTsKICAgICAgICAgICAgdmFyIHRva2VuID0gaXRlcmF0b3IuZ2V0Q3VycmVudFRva2VuKCk7CiAgICAgICAgICAgIGlmIChpcyh0b2tlbiwgIiIpICYmIHRva2VuLnR5cGUuaW5kZXhPZigidGFnLWNsb3NlIikgIT09IC0xKSB7CiAgICAgICAgICAgICAgICBpZiAodG9rZW4udmFsdWUgPT0gIi8+IikKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB3aGlsZSAodG9rZW4gJiYgdG9rZW4udHlwZS5pbmRleE9mKCJ0YWctbmFtZSIpID09PSAtMSkgewogICAgICAgICAgICAgICAgICAgIHRva2VuID0gaXRlcmF0b3Iuc3RlcEJhY2t3YXJkKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoIXRva2VuKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdmFyIHRhZyA9IHRva2VuLnZhbHVlOwogICAgICAgICAgICAgICAgdmFyIHJvdyA9IGl0ZXJhdG9yLmdldEN1cnJlbnRUb2tlblJvdygpOwogICAgICAgICAgICAgICAgdG9rZW4gPSBpdGVyYXRvci5zdGVwQmFja3dhcmQoKTsKICAgICAgICAgICAgICAgIGlmICghdG9rZW4gfHwgdG9rZW4udHlwZS5pbmRleE9mKCJlbmQtdGFnIikgIT09IC0xKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKHRoaXMudm9pZEVsZW1lbnRzICYmICF0aGlzLnZvaWRFbGVtZW50c1t0YWddIHx8ICF0aGlzLnZvaWRFbGVtZW50cykgewogICAgICAgICAgICAgICAgICAgIHZhciBuZXh0VG9rZW4gPSBzZXNzaW9uLmdldFRva2VuQXQoY3Vyc29yLnJvdywgY3Vyc29yLmNvbHVtbiArIDEpOwogICAgICAgICAgICAgICAgICAgIHZhciBsaW5lID0gc2Vzc2lvbi5nZXRMaW5lKHJvdyk7CiAgICAgICAgICAgICAgICAgICAgdmFyIG5leHRJbmRlbnQgPSB0aGlzLiRnZXRJbmRlbnQobGluZSk7CiAgICAgICAgICAgICAgICAgICAgdmFyIGluZGVudCA9IG5leHRJbmRlbnQgKyBzZXNzaW9uLmdldFRhYlN0cmluZygpOwogICAgICAgICAgICAgICAgICAgIGlmIChuZXh0VG9rZW4gJiYgbmV4dFRva2VuLnZhbHVlID09PSAiPC8iKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiAiXG4iICsgaW5kZW50ICsgIlxuIiArIG5leHRJbmRlbnQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb246IFsxLCBpbmRlbnQubGVuZ3RoLCAxLCBpbmRlbnQubGVuZ3RoXQogICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6ICJcbiIgKyBpbmRlbnQKICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9KTsKfTsKb29wLmluaGVyaXRzKFhtbEJlaGF2aW91ciwgQmVoYXZpb3VyKTsKZXhwb3J0cy5YbWxCZWhhdmlvdXIgPSBYbWxCZWhhdmlvdXI7Cgp9KTsKCmFjZS5kZWZpbmUoImFjZS9tb2RlL2ZvbGRpbmcveG1sIixbInJlcXVpcmUiLCJleHBvcnRzIiwibW9kdWxlIiwiYWNlL2xpYi9vb3AiLCJhY2UvcmFuZ2UiLCJhY2UvbW9kZS9mb2xkaW5nL2ZvbGRfbW9kZSJdLCBmdW5jdGlvbihyZXF1aXJlLCBleHBvcnRzLCBtb2R1bGUpeyJ1c2Ugc3RyaWN0IjsKdmFyIG9vcCA9IHJlcXVpcmUoIi4uLy4uL2xpYi9vb3AiKTsKdmFyIFJhbmdlID0gcmVxdWlyZSgiLi4vLi4vcmFuZ2UiKS5SYW5nZTsKdmFyIEJhc2VGb2xkTW9kZSA9IHJlcXVpcmUoIi4vZm9sZF9tb2RlIikuRm9sZE1vZGU7CnZhciBGb2xkTW9kZSA9IGV4cG9ydHMuRm9sZE1vZGUgPSBmdW5jdGlvbiAodm9pZEVsZW1lbnRzLCBvcHRpb25hbEVuZFRhZ3MpIHsKICAgIEJhc2VGb2xkTW9kZS5jYWxsKHRoaXMpOwogICAgdGhpcy52b2lkRWxlbWVudHMgPSB2b2lkRWxlbWVudHMgfHwge307CiAgICB0aGlzLm9wdGlvbmFsRW5kVGFncyA9IG9vcC5taXhpbih7fSwgdGhpcy52b2lkRWxlbWVudHMpOwogICAgaWYgKG9wdGlvbmFsRW5kVGFncykKICAgICAgICBvb3AubWl4aW4odGhpcy5vcHRpb25hbEVuZFRhZ3MsIG9wdGlvbmFsRW5kVGFncyk7Cn07Cm9vcC5pbmhlcml0cyhGb2xkTW9kZSwgQmFzZUZvbGRNb2RlKTsKdmFyIFRhZyA9IGZ1bmN0aW9uICgpIHsKICAgIHRoaXMudGFnTmFtZSA9ICIiOwogICAgdGhpcy5jbG9zaW5nID0gZmFsc2U7CiAgICB0aGlzLnNlbGZDbG9zaW5nID0gZmFsc2U7CiAgICB0aGlzLnN0YXJ0ID0geyByb3c6IDAsIGNvbHVtbjogMCB9OwogICAgdGhpcy5lbmQgPSB7IHJvdzogMCwgY29sdW1uOiAwIH07Cn07CmZ1bmN0aW9uIGlzKHRva2VuLCB0eXBlKSB7CiAgICByZXR1cm4gdG9rZW4gJiYgdG9rZW4udHlwZSAmJiB0b2tlbi50eXBlLmxhc3RJbmRleE9mKHR5cGUgKyAiLnhtbCIpID4gLTE7Cn0KKGZ1bmN0aW9uICgpIHsKICAgIHRoaXMuZ2V0Rm9sZFdpZGdldCA9IGZ1bmN0aW9uIChzZXNzaW9uLCBmb2xkU3R5bGUsIHJvdykgewogICAgICAgIHZhciB0YWcgPSB0aGlzLl9nZXRGaXJzdFRhZ0luTGluZShzZXNzaW9uLCByb3cpOwogICAgICAgIGlmICghdGFnKQogICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRDb21tZW50Rm9sZFdpZGdldChzZXNzaW9uLCByb3cpOwogICAgICAgIGlmICh0YWcuY2xvc2luZyB8fCAoIXRhZy50YWdOYW1lICYmIHRhZy5zZWxmQ2xvc2luZykpCiAgICAgICAgICAgIHJldHVybiBmb2xkU3R5bGUgPT09ICJtYXJrYmVnaW5lbmQiID8gImVuZCIgOiAiIjsKICAgICAgICBpZiAoIXRhZy50YWdOYW1lIHx8IHRhZy5zZWxmQ2xvc2luZyB8fCB0aGlzLnZvaWRFbGVtZW50cy5oYXNPd25Qcm9wZXJ0eSh0YWcudGFnTmFtZS50b0xvd2VyQ2FzZSgpKSkKICAgICAgICAgICAgcmV0dXJuICIiOwogICAgICAgIGlmICh0aGlzLl9maW5kRW5kVGFnSW5MaW5lKHNlc3Npb24sIHJvdywgdGFnLnRhZ05hbWUsIHRhZy5lbmQuY29sdW1uKSkKICAgICAgICAgICAgcmV0dXJuICIiOwogICAgICAgIHJldHVybiAic3RhcnQiOwogICAgfTsKICAgIHRoaXMuZ2V0Q29tbWVudEZvbGRXaWRnZXQgPSBmdW5jdGlvbiAoc2Vzc2lvbiwgcm93KSB7CiAgICAgICAgaWYgKC9jb21tZW50Ly50ZXN0KHNlc3Npb24uZ2V0U3RhdGUocm93KSkgJiYgLzwhLS8udGVzdChzZXNzaW9uLmdldExpbmUocm93KSkpCiAgICAgICAgICAgIHJldHVybiAic3RhcnQiOwogICAgICAgIHJldHVybiAiIjsKICAgIH07CiAgICB0aGlzLl9nZXRGaXJzdFRhZ0luTGluZSA9IGZ1bmN0aW9uIChzZXNzaW9uLCByb3cpIHsKICAgICAgICB2YXIgdG9rZW5zID0gc2Vzc2lvbi5nZXRUb2tlbnMocm93KTsKICAgICAgICB2YXIgdGFnID0gbmV3IFRhZygpOwogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdG9rZW5zLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHZhciB0b2tlbiA9IHRva2Vuc1tpXTsKICAgICAgICAgICAgaWYgKGlzKHRva2VuLCAidGFnLW9wZW4iKSkgewogICAgICAgICAgICAgICAgdGFnLmVuZC5jb2x1bW4gPSB0YWcuc3RhcnQuY29sdW1uICsgdG9rZW4udmFsdWUubGVuZ3RoOwogICAgICAgICAgICAgICAgdGFnLmNsb3NpbmcgPSBpcyh0b2tlbiwgImVuZC10YWctb3BlbiIpOwogICAgICAgICAgICAgICAgdG9rZW4gPSB0b2tlbnNbKytpXTsKICAgICAgICAgICAgICAgIGlmICghdG9rZW4pCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgICAgICB0YWcudGFnTmFtZSA9IHRva2VuLnZhbHVlOwogICAgICAgICAgICAgICAgaWYgKHRva2VuLnZhbHVlID09PSAiIikgeyAvL3NraXAgZW1wdHkgdGFnIG5hbWUgdG9rZW4gZm9yIGZyYWdtZW50CiAgICAgICAgICAgICAgICAgICAgdG9rZW4gPSB0b2tlbnNbKytpXTsKICAgICAgICAgICAgICAgICAgICBpZiAoIXRva2VuKQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgICAgICAgICB0YWcudGFnTmFtZSA9IHRva2VuLnZhbHVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdGFnLmVuZC5jb2x1bW4gKz0gdG9rZW4udmFsdWUubGVuZ3RoOwogICAgICAgICAgICAgICAgZm9yIChpKys7IGkgPCB0b2tlbnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICB0b2tlbiA9IHRva2Vuc1tpXTsKICAgICAgICAgICAgICAgICAgICB0YWcuZW5kLmNvbHVtbiArPSB0b2tlbi52YWx1ZS5sZW5ndGg7CiAgICAgICAgICAgICAgICAgICAgaWYgKGlzKHRva2VuLCAidGFnLWNsb3NlIikpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGFnLnNlbGZDbG9zaW5nID0gdG9rZW4udmFsdWUgPT0gJy8+JzsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHRhZzsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIGlmIChpcyh0b2tlbiwgInRhZy1jbG9zZSIpKSB7CiAgICAgICAgICAgICAgICB0YWcuc2VsZkNsb3NpbmcgPSB0b2tlbi52YWx1ZSA9PSAnLz4nOwogICAgICAgICAgICAgICAgcmV0dXJuIHRhZzsKICAgICAgICAgICAgfQogICAgICAgICAgICB0YWcuc3RhcnQuY29sdW1uICs9IHRva2VuLnZhbHVlLmxlbmd0aDsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9OwogICAgdGhpcy5fZmluZEVuZFRhZ0luTGluZSA9IGZ1bmN0aW9uIChzZXNzaW9uLCByb3csIHRhZ05hbWUsIHN0YXJ0Q29sdW1uKSB7CiAgICAgICAgdmFyIHRva2VucyA9IHNlc3Npb24uZ2V0VG9rZW5zKHJvdyk7CiAgICAgICAgdmFyIGNvbHVtbiA9IDA7CiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0b2tlbnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgdmFyIHRva2VuID0gdG9rZW5zW2ldOwogICAgICAgICAgICBjb2x1bW4gKz0gdG9rZW4udmFsdWUubGVuZ3RoOwogICAgICAgICAgICBpZiAoY29sdW1uIDwgc3RhcnRDb2x1bW4gLSAxKQogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIGlmIChpcyh0b2tlbiwgImVuZC10YWctb3BlbiIpKSB7CiAgICAgICAgICAgICAgICB0b2tlbiA9IHRva2Vuc1tpICsgMV07CiAgICAgICAgICAgICAgICBpZiAoaXModG9rZW4sICJ0YWctbmFtZSIpICYmIHRva2VuLnZhbHVlID09PSAiIikgewogICAgICAgICAgICAgICAgICAgIHRva2VuID0gdG9rZW5zW2kgKyAyXTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmICh0b2tlbiAmJiB0b2tlbi52YWx1ZSA9PSB0YWdOYW1lKQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH07CiAgICB0aGlzLmdldEZvbGRXaWRnZXRSYW5nZSA9IGZ1bmN0aW9uIChzZXNzaW9uLCBmb2xkU3R5bGUsIHJvdykgewogICAgICAgIHZhciBmaXJzdFRhZyA9IHRoaXMuX2dldEZpcnN0VGFnSW5MaW5lKHNlc3Npb24sIHJvdyk7CiAgICAgICAgaWYgKCFmaXJzdFRhZykgewogICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRDb21tZW50Rm9sZFdpZGdldChzZXNzaW9uLCByb3cpICYmIHNlc3Npb24uZ2V0Q29tbWVudEZvbGRSYW5nZShyb3csIHNlc3Npb24uZ2V0TGluZShyb3cpLmxlbmd0aCk7CiAgICAgICAgfQogICAgICAgIHZhciB0YWdzID0gc2Vzc2lvbi5nZXRNYXRjaGluZ1RhZ3MoeyByb3c6IHJvdywgY29sdW1uOiAwIH0pOwogICAgICAgIGlmICh0YWdzKSB7CiAgICAgICAgICAgIHJldHVybiBuZXcgUmFuZ2UodGFncy5vcGVuVGFnLmVuZC5yb3csIHRhZ3Mub3BlblRhZy5lbmQuY29sdW1uLCB0YWdzLmNsb3NlVGFnLnN0YXJ0LnJvdywgdGFncy5jbG9zZVRhZy5zdGFydC5jb2x1bW4pOwogICAgICAgIH0KICAgIH07Cn0pLmNhbGwoRm9sZE1vZGUucHJvdG90eXBlKTsKCn0pOwoKYWNlLmRlZmluZSgiYWNlL21vZGUveG1sIixbInJlcXVpcmUiLCJleHBvcnRzIiwibW9kdWxlIiwiYWNlL2xpYi9vb3AiLCJhY2UvbGliL2xhbmciLCJhY2UvbW9kZS90ZXh0IiwiYWNlL21vZGUveG1sX2hpZ2hsaWdodF9ydWxlcyIsImFjZS9tb2RlL2JlaGF2aW91ci94bWwiLCJhY2UvbW9kZS9mb2xkaW5nL3htbCIsImFjZS93b3JrZXIvd29ya2VyX2NsaWVudCJdLCBmdW5jdGlvbihyZXF1aXJlLCBleHBvcnRzLCBtb2R1bGUpeyJ1c2Ugc3RyaWN0IjsKdmFyIG9vcCA9IHJlcXVpcmUoIi4uL2xpYi9vb3AiKTsKdmFyIGxhbmcgPSByZXF1aXJlKCIuLi9saWIvbGFuZyIpOwp2YXIgVGV4dE1vZGUgPSByZXF1aXJlKCIuL3RleHQiKS5Nb2RlOwp2YXIgWG1sSGlnaGxpZ2h0UnVsZXMgPSByZXF1aXJlKCIuL3htbF9oaWdobGlnaHRfcnVsZXMiKS5YbWxIaWdobGlnaHRSdWxlczsKdmFyIFhtbEJlaGF2aW91ciA9IHJlcXVpcmUoIi4vYmVoYXZpb3VyL3htbCIpLlhtbEJlaGF2aW91cjsKdmFyIFhtbEZvbGRNb2RlID0gcmVxdWlyZSgiLi9mb2xkaW5nL3htbCIpLkZvbGRNb2RlOwp2YXIgV29ya2VyQ2xpZW50ID0gcmVxdWlyZSgiLi4vd29ya2VyL3dvcmtlcl9jbGllbnQiKS5Xb3JrZXJDbGllbnQ7CnZhciBNb2RlID0gZnVuY3Rpb24gKCkgewogICAgdGhpcy5IaWdobGlnaHRSdWxlcyA9IFhtbEhpZ2hsaWdodFJ1bGVzOwogICAgdGhpcy4kYmVoYXZpb3VyID0gbmV3IFhtbEJlaGF2aW91cigpOwogICAgdGhpcy5mb2xkaW5nUnVsZXMgPSBuZXcgWG1sRm9sZE1vZGUoKTsKfTsKb29wLmluaGVyaXRzKE1vZGUsIFRleHRNb2RlKTsKKGZ1bmN0aW9uICgpIHsKICAgIHRoaXMudm9pZEVsZW1lbnRzID0gbGFuZy5hcnJheVRvTWFwKFtdKTsKICAgIHRoaXMuYmxvY2tDb21tZW50ID0geyBzdGFydDogIjwhLS0iLCBlbmQ6ICItLT4iIH07CiAgICB0aGlzLmNyZWF0ZVdvcmtlciA9IGZ1bmN0aW9uIChzZXNzaW9uKSB7CiAgICAgICAgdmFyIHdvcmtlciA9IG5ldyBXb3JrZXJDbGllbnQoWyJhY2UiXSwgImFjZS9tb2RlL3htbF93b3JrZXIiLCAiV29ya2VyIik7CiAgICAgICAgd29ya2VyLmF0dGFjaFRvRG9jdW1lbnQoc2Vzc2lvbi5nZXREb2N1bWVudCgpKTsKICAgICAgICB3b3JrZXIub24oImVycm9yIiwgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgc2Vzc2lvbi5zZXRBbm5vdGF0aW9ucyhlLmRhdGEpOwogICAgICAgIH0pOwogICAgICAgIHdvcmtlci5vbigidGVybWluYXRlIiwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICBzZXNzaW9uLmNsZWFyQW5ub3RhdGlvbnMoKTsKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gd29ya2VyOwogICAgfTsKICAgIHRoaXMuJGlkID0gImFjZS9tb2RlL3htbCI7Cn0pLmNhbGwoTW9kZS5wcm90b3R5cGUpOwpleHBvcnRzLk1vZGUgPSBNb2RlOwoKfSk7CgphY2UuZGVmaW5lKCJhY2UvbW9kZS9qc2RvY19jb21tZW50X2hpZ2hsaWdodF9ydWxlcyIsWyJyZXF1aXJlIiwiZXhwb3J0cyIsIm1vZHVsZSIsImFjZS9saWIvb29wIiwiYWNlL21vZGUvdGV4dF9oaWdobGlnaHRfcnVsZXMiXSwgZnVuY3Rpb24ocmVxdWlyZSwgZXhwb3J0cywgbW9kdWxlKXsidXNlIHN0cmljdCI7CnZhciBvb3AgPSByZXF1aXJlKCIuLi9saWIvb29wIik7CnZhciBUZXh0SGlnaGxpZ2h0UnVsZXMgPSByZXF1aXJlKCIuL3RleHRfaGlnaGxpZ2h0X3J1bGVzIikuVGV4dEhpZ2hsaWdodFJ1bGVzOwp2YXIgSnNEb2NDb21tZW50SGlnaGxpZ2h0UnVsZXMgPSBmdW5jdGlvbiAoKSB7CiAgICB0aGlzLiRydWxlcyA9IHsKICAgICAgICAic3RhcnQiOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHRva2VuOiBbImNvbW1lbnQuZG9jLnRhZyIsICJjb21tZW50LmRvYy50ZXh0IiwgImxwYXJlbi5kb2MiXSwKICAgICAgICAgICAgICAgIHJlZ2V4OiAiKEAoPzpwYXJhbXxtZW1iZXJ8dHlwZWRlZnxwcm9wZXJ0eXxuYW1lc3BhY2V8dmFyfGNvbnN0fGNhbGxiYWNrKSkoXFxzKikoeykiLAogICAgICAgICAgICAgICAgcHVzaDogWwogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgdG9rZW46ICJscGFyZW4uZG9jIiwKICAgICAgICAgICAgICAgICAgICAgICAgcmVnZXg6ICJ7IiwKICAgICAgICAgICAgICAgICAgICAgICAgcHVzaDogWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluY2x1ZGU6ICJkb2Mtc3ludGF4IgogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRva2VuOiAicnBhcmVuLmRvYyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVnZXg6ICJ9fCg/PSQpIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXh0OiAicG9wIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICAgICAgICB0b2tlbjogWyJycGFyZW4uZG9jIiwgInRleHQuZG9jIiwgInZhcmlhYmxlLnBhcmFtZXRlci5kb2MiLCAibHBhcmVuLmRvYyIsICJ2YXJpYWJsZS5wYXJhbWV0ZXIuZG9jIiwgInJwYXJlbi5kb2MiXSwKICAgICAgICAgICAgICAgICAgICAgICAgcmVnZXg6IC8ofSkoXHMqKSg/OihbXHc9OlwvXC5dKyl8KD86KFxbKShbXHc9OlwvXC5cLVwnXCIgXSspKFxdKSkpLywKICAgICAgICAgICAgICAgICAgICAgICAgbmV4dDogInBvcCIKICAgICAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRva2VuOiAicnBhcmVuLmRvYyIsCiAgICAgICAgICAgICAgICAgICAgICAgIHJlZ2V4OiAifXwoPz0kKSIsCiAgICAgICAgICAgICAgICAgICAgICAgIG5leHQ6ICJwb3AiCiAgICAgICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICAgICAgICBpbmNsdWRlOiAiZG9jLXN5bnRheCIKICAgICAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRUb2tlbjogInRleHQuZG9jIgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgdG9rZW46IFsiY29tbWVudC5kb2MudGFnIiwgInRleHQuZG9jIiwgImxwYXJlbi5kb2MiXSwKICAgICAgICAgICAgICAgIHJlZ2V4OiAiKEAoPzpyZXR1cm5zP3x5aWVsZHN8dHlwZXx0aGlzfHN1cHByZXNzfHB1YmxpY3xwcm90ZWN0ZWR8cHJpdmF0ZXxwYWNrYWdlfG1vZGlmaWVzfCIKICAgICAgICAgICAgICAgICAgICArICJpbXBsZW1lbnRzfGV4dGVybmFsfGV4Y2VwdGlvbnx0aHJvd3N8ZW51bXxkZWZpbmV8ZXh0ZW5kcykpKFxccyopKHspIiwKICAgICAgICAgICAgICAgIHB1c2g6IFsKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRva2VuOiAibHBhcmVuLmRvYyIsCiAgICAgICAgICAgICAgICAgICAgICAgIHJlZ2V4OiAieyIsCiAgICAgICAgICAgICAgICAgICAgICAgIHB1c2g6IFsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmNsdWRlOiAiZG9jLXN5bnRheCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2tlbjogInJwYXJlbi5kb2MiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZ2V4OiAifXwoPz0kKSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV4dDogInBvcCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgXQogICAgICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgICAgICAgdG9rZW46ICJycGFyZW4uZG9jIiwKICAgICAgICAgICAgICAgICAgICAgICAgcmVnZXg6ICJ9fCg/PSQpIiwKICAgICAgICAgICAgICAgICAgICAgICAgbmV4dDogInBvcCIKICAgICAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgICAgICAgIGluY2x1ZGU6ICJkb2Mtc3ludGF4IgogICAgICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFRva2VuOiAidGV4dC5kb2MiCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgXQogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICB0b2tlbjogWyJjb21tZW50LmRvYy50YWciLCAidGV4dC5kb2MiLCAidmFyaWFibGUucGFyYW1ldGVyLmRvYyJdLAogICAgICAgICAgICAgICAgcmVnZXg6ICIoQCg/OmFsaWFzfG1lbWJlcm9mfGluc3RhbmNlfG1vZHVsZXxuYW1lfGxlbmRzfG5hbWVzcGFjZXxleHRlcm5hbHx0aGlzfHRlbXBsYXRlfCIKICAgICAgICAgICAgICAgICAgICArICJyZXF1aXJlc3xwYXJhbXxpbXBsZW1lbnRzfGZ1bmN0aW9ufGV4dGVuZHN8dHlwZWRlZnxtaXhlc3xjb25zdHJ1Y3Rvcnx2YXJ8IgogICAgICAgICAgICAgICAgICAgICsgIm1lbWJlcm9mXFwhfGV2ZW50fGxpc3RlbnN8ZXhwb3J0c3xjbGFzc3xjb25zdHJ1Y3RzfGludGVyZmFjZXxlbWl0c3xmaXJlc3wiCiAgICAgICAgICAgICAgICAgICAgKyAidGhyb3dzfGNvbnN0fGNhbGxiYWNrfGJvcnJvd3N8YXVnbWVudHMpKShcXHMrKShcXHdbXFx3I1wuOlwvflwiXFwtXSopPyIKICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgdG9rZW46IFsiY29tbWVudC5kb2MudGFnIiwgInRleHQuZG9jIiwgInZhcmlhYmxlLnBhcmFtZXRlci5kb2MiXSwKICAgICAgICAgICAgICAgIHJlZ2V4OiAiKEBtZXRob2QpKFxccyspKFxcd1tcXHdcLlxcKFxcKV0qKSIKICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgdG9rZW46ICJjb21tZW50LmRvYy50YWciLAogICAgICAgICAgICAgICAgcmVnZXg6ICJAYWNjZXNzXFxzKyg/OnByaXZhdGV8cHVibGljfHByb3RlY3RlZCkiCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIHRva2VuOiAiY29tbWVudC5kb2MudGFnIiwKICAgICAgICAgICAgICAgIHJlZ2V4OiAiQGtpbmRcXHMrKD86Y2xhc3N8Y29uc3RhbnR8ZXZlbnR8ZXh0ZXJuYWx8ZmlsZXxmdW5jdGlvbnxtZW1iZXJ8bWl4aW58bW9kdWxlfG5hbWVzcGFjZXx0eXBlZGVmKSIKICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgdG9rZW46ICJjb21tZW50LmRvYy50YWciLAogICAgICAgICAgICAgICAgcmVnZXg6ICJAXFx3Kyg/PVxcc3wkKSIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgSnNEb2NDb21tZW50SGlnaGxpZ2h0UnVsZXMuZ2V0VGFnUnVsZSgpLAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBkZWZhdWx0VG9rZW46ICJjb21tZW50LmRvYy5ib2R5IiwKICAgICAgICAgICAgICAgIGNhc2VJbnNlbnNpdGl2ZTogdHJ1ZQogICAgICAgICAgICB9CiAgICAgICAgXSwKICAgICAgICAiZG9jLXN5bnRheCI6IFt7CiAgICAgICAgICAgICAgICB0b2tlbjogIm9wZXJhdG9yLmRvYyIsCiAgICAgICAgICAgICAgICByZWdleDogL1t8Ol0vCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIHRva2VuOiAicGFyZW4uZG9jIiwKICAgICAgICAgICAgICAgIHJlZ2V4OiAvW1xbXF1dLwogICAgICAgICAgICB9XQogICAgfTsKICAgIHRoaXMubm9ybWFsaXplUnVsZXMoKTsKfTsKb29wLmluaGVyaXRzKEpzRG9jQ29tbWVudEhpZ2hsaWdodFJ1bGVzLCBUZXh0SGlnaGxpZ2h0UnVsZXMpOwpKc0RvY0NvbW1lbnRIaWdobGlnaHRSdWxlcy5nZXRUYWdSdWxlID0gZnVuY3Rpb24gKHN0YXJ0KSB7CiAgICByZXR1cm4gewogICAgICAgIHRva2VuOiAiY29tbWVudC5kb2MudGFnLnN0b3JhZ2UudHlwZSIsCiAgICAgICAgcmVnZXg6ICJcXGIoPzpUT0RPfEZJWE1FfFhYWHxIQUNLKVxcYiIKICAgIH07Cn07CkpzRG9jQ29tbWVudEhpZ2hsaWdodFJ1bGVzLmdldFN0YXJ0UnVsZSA9IGZ1bmN0aW9uIChzdGFydCkgewogICAgcmV0dXJuIHsKICAgICAgICB0b2tlbjogImNvbW1lbnQuZG9jIiwgLy8gZG9jIGNvbW1lbnQKICAgICAgICByZWdleDogL1wvXCpcKig/IVwvKS8sCiAgICAgICAgbmV4dDogc3RhcnQKICAgIH07Cn07CkpzRG9jQ29tbWVudEhpZ2hsaWdodFJ1bGVzLmdldEVuZFJ1bGUgPSBmdW5jdGlvbiAoc3RhcnQpIHsKICAgIHJldHVybiB7CiAgICAgICAgdG9rZW46ICJjb21tZW50LmRvYyIsIC8vIGNsb3NpbmcgY29tbWVudAogICAgICAgIHJlZ2V4OiAiXFwqXFwvIiwKICAgICAgICBuZXh0OiBzdGFydAogICAgfTsKfTsKZXhwb3J0cy5Kc0RvY0NvbW1lbnRIaWdobGlnaHRSdWxlcyA9IEpzRG9jQ29tbWVudEhpZ2hsaWdodFJ1bGVzOwoKfSk7CgphY2UuZGVmaW5lKCJhY2UvbW9kZS9qYXZhc2NyaXB0X2hpZ2hsaWdodF9ydWxlcyIsWyJyZXF1aXJlIiwiZXhwb3J0cyIsIm1vZHVsZSIsImFjZS9saWIvb29wIiwiYWNlL21vZGUvanNkb2NfY29tbWVudF9oaWdobGlnaHRfcnVsZXMiLCJhY2UvbW9kZS90ZXh0X2hpZ2hsaWdodF9ydWxlcyJdLCBmdW5jdGlvbihyZXF1aXJlLCBleHBvcnRzLCBtb2R1bGUpeyJ1c2Ugc3RyaWN0IjsKdmFyIG9vcCA9IHJlcXVpcmUoIi4uL2xpYi9vb3AiKTsKdmFyIERvY0NvbW1lbnRIaWdobGlnaHRSdWxlcyA9IHJlcXVpcmUoIi4vanNkb2NfY29tbWVudF9oaWdobGlnaHRfcnVsZXMiKS5Kc0RvY0NvbW1lbnRIaWdobGlnaHRSdWxlczsKdmFyIFRleHRIaWdobGlnaHRSdWxlcyA9IHJlcXVpcmUoIi4vdGV4dF9oaWdobGlnaHRfcnVsZXMiKS5UZXh0SGlnaGxpZ2h0UnVsZXM7CnZhciBpZGVudGlmaWVyUmUgPSAiW2EtekEtWlxcJF9cdTAwYTEtXHVmZmZmXVthLXpBLVpcXGRcXCRfXHUwMGExLVx1ZmZmZl0qIjsKdmFyIEphdmFTY3JpcHRIaWdobGlnaHRSdWxlcyA9IGZ1bmN0aW9uIChvcHRpb25zKSB7CiAgICB2YXIga2V5d29yZHMgPSB7CiAgICAgICAgInZhcmlhYmxlLmxhbmd1YWdlIjogIkFycmF5fEJvb2xlYW58RGF0ZXxGdW5jdGlvbnxJdGVyYXRvcnxOdW1iZXJ8T2JqZWN0fFJlZ0V4cHxTdHJpbmd8UHJveHl8U3ltYm9sfCIgKyAvLyBDb25zdHJ1Y3RvcnMKICAgICAgICAgICAgIk5hbWVzcGFjZXxRTmFtZXxYTUx8WE1MTGlzdHwiICsgLy8gRTRYCiAgICAgICAgICAgICJBcnJheUJ1ZmZlcnxGbG9hdDMyQXJyYXl8RmxvYXQ2NEFycmF5fEludDE2QXJyYXl8SW50MzJBcnJheXxJbnQ4QXJyYXl8IiArCiAgICAgICAgICAgICJVaW50MTZBcnJheXxVaW50MzJBcnJheXxVaW50OEFycmF5fFVpbnQ4Q2xhbXBlZEFycmF5fCIgKwogICAgICAgICAgICAiRXJyb3J8RXZhbEVycm9yfEludGVybmFsRXJyb3J8UmFuZ2VFcnJvcnxSZWZlcmVuY2VFcnJvcnxTdG9wSXRlcmF0aW9ufCIgKyAvLyBFcnJvcnMKICAgICAgICAgICAgIlN5bnRheEVycm9yfFR5cGVFcnJvcnxVUklFcnJvcnwiICsKICAgICAgICAgICAgImRlY29kZVVSSXxkZWNvZGVVUklDb21wb25lbnR8ZW5jb2RlVVJJfGVuY29kZVVSSUNvbXBvbmVudHxldmFsfGlzRmluaXRlfCIgKyAvLyBOb24tY29uc3RydWN0b3IgZnVuY3Rpb25zCiAgICAgICAgICAgICJpc05hTnxwYXJzZUZsb2F0fHBhcnNlSW50fCIgKwogICAgICAgICAgICAiSlNPTnxNYXRofCIgKyAvLyBPdGhlcgogICAgICAgICAgICAidGhpc3xhcmd1bWVudHN8cHJvdG90eXBlfHdpbmRvd3xkb2N1bWVudCIsIC8vIFBzZXVkbwogICAgICAgICJrZXl3b3JkIjogImNvbnN0fHlpZWxkfGltcG9ydHxnZXR8c2V0fGFzeW5jfGF3YWl0fCIgKwogICAgICAgICAgICAiYnJlYWt8Y2FzZXxjYXRjaHxjb250aW51ZXxkZWZhdWx0fGRlbGV0ZXxkb3xlbHNlfGZpbmFsbHl8Zm9yfCIgKwogICAgICAgICAgICAiaWZ8aW58b2Z8aW5zdGFuY2VvZnxuZXd8cmV0dXJufHN3aXRjaHx0aHJvd3x0cnl8dHlwZW9mfGxldHx2YXJ8d2hpbGV8d2l0aHxkZWJ1Z2dlcnwiICsKICAgICAgICAgICAgIl9fcGFyZW50X198X19jb3VudF9ffGVzY2FwZXx1bmVzY2FwZXx3aXRofF9fcHJvdG9fX3wiICsKICAgICAgICAgICAgImNsYXNzfGVudW18ZXh0ZW5kc3xzdXBlcnxleHBvcnR8aW1wbGVtZW50c3xwcml2YXRlfHB1YmxpY3xpbnRlcmZhY2V8cGFja2FnZXxwcm90ZWN0ZWR8c3RhdGljfGNvbnN0cnVjdG9yIiwKICAgICAgICAic3RvcmFnZS50eXBlIjogImNvbnN0fGxldHx2YXJ8ZnVuY3Rpb24iLAogICAgICAgICJjb25zdGFudC5sYW5ndWFnZSI6ICJudWxsfEluZmluaXR5fE5hTnx1bmRlZmluZWQiLAogICAgICAgICJzdXBwb3J0LmZ1bmN0aW9uIjogImFsZXJ0IiwKICAgICAgICAiY29uc3RhbnQubGFuZ3VhZ2UuYm9vbGVhbiI6ICJ0cnVlfGZhbHNlIgogICAgfTsKICAgIHZhciBrZXl3b3JkTWFwcGVyID0gdGhpcy5jcmVhdGVLZXl3b3JkTWFwcGVyKGtleXdvcmRzLCAiaWRlbnRpZmllciIpOwogICAgdmFyIGt3QmVmb3JlUmUgPSAiY2FzZXxkb3xlbHNlfGZpbmFsbHl8aW58aW5zdGFuY2VvZnxyZXR1cm58dGhyb3d8dHJ5fHR5cGVvZnx5aWVsZHx2b2lkIjsKICAgIHZhciBlc2NhcGVkUmUgPSAiXFxcXCg/OnhbMC05YS1mQS1GXXsyfXwiICsgLy8gaGV4CiAgICAgICAgInVbMC05YS1mQS1GXXs0fXwiICsgLy8gdW5pY29kZQogICAgICAgICJ1e1swLTlhLWZBLUZdezEsNn19fCIgKyAvLyBlczYgdW5pY29kZQogICAgICAgICJbMC0yXVswLTddezAsMn18IiArIC8vIG9jdAogICAgICAgICIzWzAtN11bMC03XT98IiArIC8vIG9jdAogICAgICAgICJbNC03XVswLTddP3wiICsgLy9vY3QKICAgICAgICAiLikiOwogICAgdmFyIGFub255bW91c0Z1bmN0aW9uUmUgPSAiKGZ1bmN0aW9uKShcXHMqKShcXCo/KSI7CiAgICB2YXIgZnVuY3Rpb25DYWxsU3RhcnRSdWxlID0gewogICAgICAgIHRva2VuOiBbImlkZW50aWZpZXIiLCAidGV4dCIsICJwYXJlbi5scGFyZW4iXSwKICAgICAgICByZWdleDogIihcXGIoPyEiICsgT2JqZWN0LnZhbHVlcyhrZXl3b3Jkcykuam9pbigifCIpICsgIlxcYikiICsgaWRlbnRpZmllclJlICsgIikoXFxzKikoXFwoKSIKICAgIH07CiAgICB0aGlzLiRydWxlcyA9IHsKICAgICAgICAibm9fcmVnZXgiOiBbCiAgICAgICAgICAgIERvY0NvbW1lbnRIaWdobGlnaHRSdWxlcy5nZXRTdGFydFJ1bGUoImRvYy1zdGFydCIpLAogICAgICAgICAgICBjb21tZW50cygibm9fcmVnZXgiKSwKICAgICAgICAgICAgZnVuY3Rpb25DYWxsU3RhcnRSdWxlLAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB0b2tlbjogInN0cmluZyIsCiAgICAgICAgICAgICAgICByZWdleDogIicoPz0uKSIsCiAgICAgICAgICAgICAgICBuZXh0OiAicXN0cmluZyIKICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgdG9rZW46ICJzdHJpbmciLAogICAgICAgICAgICAgICAgcmVnZXg6ICciKD89LiknLAogICAgICAgICAgICAgICAgbmV4dDogInFxc3RyaW5nIgogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICB0b2tlbjogImNvbnN0YW50Lm51bWVyaWMiLCAvLyBoZXhhZGVjaW1hbCwgb2N0YWwgYW5kIGJpbmFyeQogICAgICAgICAgICAgICAgcmVnZXg6IC8wKD86W3hYXVswLTlhLWZBLUZdK3xbb09dWzAtN10rfFtiQl1bMDFdKylcYi8KICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgdG9rZW46ICJjb25zdGFudC5udW1lcmljIiwgLy8gZGVjaW1hbCBpbnRlZ2VycyBhbmQgZmxvYXRzCiAgICAgICAgICAgICAgICByZWdleDogLyg/OlxkXGQqKD86XC5cZCopP3xcLlxkKykoPzpbZUVdWystXT9cZCtcYik/LwogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICB0b2tlbjogWwogICAgICAgICAgICAgICAgICAgICJlbnRpdHkubmFtZS5mdW5jdGlvbiIsICJ0ZXh0IiwgImtleXdvcmQub3BlcmF0b3IiLCAidGV4dCIsICJzdG9yYWdlLnR5cGUiLAogICAgICAgICAgICAgICAgICAgICJ0ZXh0IiwgInN0b3JhZ2UudHlwZSIsICJ0ZXh0IiwgInBhcmVuLmxwYXJlbiIKICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICByZWdleDogIigiICsgaWRlbnRpZmllclJlICsgIikoXFxzKikoPSkoXFxzKikiICsgYW5vbnltb3VzRnVuY3Rpb25SZSArICIoXFxzKikoXFwoKSIsCiAgICAgICAgICAgICAgICBuZXh0OiAiZnVuY3Rpb25fYXJndW1lbnRzIgogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICB0b2tlbjogWwogICAgICAgICAgICAgICAgICAgICJzdG9yYWdlLnR5cGUiLCAidGV4dCIsICJzdG9yYWdlLnR5cGUiLCAidGV4dCIsICJ0ZXh0IiwgImVudGl0eS5uYW1lLmZ1bmN0aW9uIiwgInRleHQiLCAicGFyZW4ubHBhcmVuIgogICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgIHJlZ2V4OiAiKGZ1bmN0aW9uKSg/Oig/OihcXHMqKShcXCopKFxccyopKXwoXFxzKykpKCIgKyBpZGVudGlmaWVyUmUgKyAiKShcXHMqKShcXCgpIiwKICAgICAgICAgICAgICAgIG5leHQ6ICJmdW5jdGlvbl9hcmd1bWVudHMiCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIHRva2VuOiBbCiAgICAgICAgICAgICAgICAgICAgImVudGl0eS5uYW1lLmZ1bmN0aW9uIiwgInRleHQiLCAicHVuY3R1YXRpb24ub3BlcmF0b3IiLAogICAgICAgICAgICAgICAgICAgICJ0ZXh0IiwgInN0b3JhZ2UudHlwZSIsICJ0ZXh0IiwgInN0b3JhZ2UudHlwZSIsICJ0ZXh0IiwgInBhcmVuLmxwYXJlbiIKICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICByZWdleDogIigiICsgaWRlbnRpZmllclJlICsgIikoXFxzKikoOikoXFxzKikiICsgYW5vbnltb3VzRnVuY3Rpb25SZSArICIoXFxzKikoXFwoKSIsCiAgICAgICAgICAgICAgICBuZXh0OiAiZnVuY3Rpb25fYXJndW1lbnRzIgogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICB0b2tlbjogWwogICAgICAgICAgICAgICAgICAgICJ0ZXh0IiwgInRleHQiLCAic3RvcmFnZS50eXBlIiwgInRleHQiLCAic3RvcmFnZS50eXBlIiwgInRleHQiLCAicGFyZW4ubHBhcmVuIgogICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgIHJlZ2V4OiAiKDopKFxccyopIiArIGFub255bW91c0Z1bmN0aW9uUmUgKyAiKFxccyopKFxcKCkiLAogICAgICAgICAgICAgICAgbmV4dDogImZ1bmN0aW9uX2FyZ3VtZW50cyIKICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgdG9rZW46ICJrZXl3b3JkIiwKICAgICAgICAgICAgICAgIHJlZ2V4OiAiZnJvbSg/PVxccyooJ3xcIikpIgogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICB0b2tlbjogImtleXdvcmQiLAogICAgICAgICAgICAgICAgcmVnZXg6ICIoPzoiICsga3dCZWZvcmVSZSArICIpXFxiIiwKICAgICAgICAgICAgICAgIG5leHQ6ICJzdGFydCIKICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgdG9rZW46ICJzdXBwb3J0LmNvbnN0YW50IiwKICAgICAgICAgICAgICAgIHJlZ2V4OiAvdGhhdFxiLwogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICB0b2tlbjogWyJzdG9yYWdlLnR5cGUiLCAicHVuY3R1YXRpb24ub3BlcmF0b3IiLCAic3VwcG9ydC5mdW5jdGlvbi5maXJlYnVnIl0sCiAgICAgICAgICAgICAgICByZWdleDogLyhjb25zb2xlKShcLikod2FybnxpbmZvfGxvZ3xlcnJvcnxkZWJ1Z3x0aW1lfHRyYWNlfHRpbWVFbmR8YXNzZXJ0KVxiLwogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICB0b2tlbjoga2V5d29yZE1hcHBlciwKICAgICAgICAgICAgICAgIHJlZ2V4OiBpZGVudGlmaWVyUmUKICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgdG9rZW46ICJwdW5jdHVhdGlvbi5vcGVyYXRvciIsCiAgICAgICAgICAgICAgICByZWdleDogL1suXSg/IVsuXSkvLAogICAgICAgICAgICAgICAgbmV4dDogInByb3BlcnR5IgogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICB0b2tlbjogInN0b3JhZ2UudHlwZSIsCiAgICAgICAgICAgICAgICByZWdleDogLz0+LywKICAgICAgICAgICAgICAgIG5leHQ6ICJzdGFydCIKICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgdG9rZW46ICJrZXl3b3JkLm9wZXJhdG9yIiwKICAgICAgICAgICAgICAgIHJlZ2V4OiAvLS18XCtcK3xcLnszfXw9PT18PT18PXwhPXwhPT18PCs9P3w+Kz0/fCF8JiZ8XHxcfHxcPzp8WyEkJSYqK1wtflwvXl09Py8sCiAgICAgICAgICAgICAgICBuZXh0OiAic3RhcnQiCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIHRva2VuOiAicHVuY3R1YXRpb24ub3BlcmF0b3IiLAogICAgICAgICAgICAgICAgcmVnZXg6IC9bPzosOy5dLywKICAgICAgICAgICAgICAgIG5leHQ6ICJzdGFydCIKICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgdG9rZW46ICJwYXJlbi5scGFyZW4iLAogICAgICAgICAgICAgICAgcmVnZXg6IC9bXFsoe10vLAogICAgICAgICAgICAgICAgbmV4dDogInN0YXJ0IgogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICB0b2tlbjogInBhcmVuLnJwYXJlbiIsCiAgICAgICAgICAgICAgICByZWdleDogL1tcXSl9XS8KICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgdG9rZW46ICJjb21tZW50IiwKICAgICAgICAgICAgICAgIHJlZ2V4OiAvXiMhLiokLwogICAgICAgICAgICB9CiAgICAgICAgXSwKICAgICAgICBwcm9wZXJ0eTogW3sKICAgICAgICAgICAgICAgIHRva2VuOiAidGV4dCIsCiAgICAgICAgICAgICAgICByZWdleDogIlxccysiCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIHRva2VuOiAia2V5d29yZC5vcGVyYXRvciIsCiAgICAgICAgICAgICAgICByZWdleDogLz0vCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIHRva2VuOiBbCiAgICAgICAgICAgICAgICAgICAgInN0b3JhZ2UudHlwZSIsICJ0ZXh0IiwgInN0b3JhZ2UudHlwZSIsICJ0ZXh0IiwgInBhcmVuLmxwYXJlbiIKICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICByZWdleDogYW5vbnltb3VzRnVuY3Rpb25SZSArICIoXFxzKikoXFwoKSIsCiAgICAgICAgICAgICAgICBuZXh0OiAiZnVuY3Rpb25fYXJndW1lbnRzIgogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICB0b2tlbjogWwogICAgICAgICAgICAgICAgICAgICJzdG9yYWdlLnR5cGUiLCAidGV4dCIsICJzdG9yYWdlLnR5cGUiLCAidGV4dCIsICJ0ZXh0IiwgImVudGl0eS5uYW1lLmZ1bmN0aW9uIiwgInRleHQiLCAicGFyZW4ubHBhcmVuIgogICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgIHJlZ2V4OiAiKGZ1bmN0aW9uKSg/Oig/OihcXHMqKShcXCopKFxccyopKXwoXFxzKykpKFxcdyspKFxccyopKFxcKCkiLAogICAgICAgICAgICAgICAgbmV4dDogImZ1bmN0aW9uX2FyZ3VtZW50cyIKICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgdG9rZW46ICJwdW5jdHVhdGlvbi5vcGVyYXRvciIsCiAgICAgICAgICAgICAgICByZWdleDogL1suXSg/IVsuXSkvCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIHRva2VuOiAic3VwcG9ydC5mdW5jdGlvbiIsCiAgICAgICAgICAgICAgICByZWdleDogInByb3RvdHlwZSIKICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgdG9rZW46ICJzdXBwb3J0LmZ1bmN0aW9uIiwKICAgICAgICAgICAgICAgIHJlZ2V4OiAvKHMoPzpoKD86aWZ0fG93KD86TW9kKD86ZWxlc3NEaWFsb2d8YWxEaWFsb2cpfEhlbHApKXxjcm9sbCg/Olh8QnkoPzpQYWdlc3xMaW5lcyk/fFl8VG8pP3x0KD86b3B8cmlrZSl8aSg/Om58emVUb0NvbnRlbnR8ZGViYXJ8Z25UZXh0KXxvcnR8dSg/OnB8Yig/OnN0cig/OmluZyk/KT8pfHBsaSg/OmNlfHQpfGUoPzpuZHx0KD86UmUoPzpzaXphYmxlfHF1ZXN0SGVhZGVyKXxNKD86aSg/Om51dGVzfGxsaXNlY29uZHMpfG9udGgpfFNlY29uZHN8SG8oPzp0S2V5c3x1cnMpfFllYXJ8Q3Vyc29yfFRpbWUoPzpvdXQpP3xJbnRlcnZhbHxaT3B0aW9uc3xEYXRlfFVUQyg/Ok0oPzppKD86bnV0ZXN8bGxpc2Vjb25kcyl8b250aCl8U2Vjb25kc3xIb3Vyc3xEYXRlfEZ1bGxZZWFyKXxGdWxsWWVhcnxBY3RpdmUpfGFyY2gpfHFydHxsaWNlfGF2ZVByZWZlcmVuY2VzfG1hbGwpfGgoPzpvbWV8YW5kbGVFdmVudCl8bmF2aWdhdGV8Yyg/Omhhcig/OkNvZGVBdHxBdCl8byg/OnN8big/OmNhdHx0ZXh0dWFsfGZpcm0pfG1waWxlKXxlaWx8bGVhcig/OlRpbWVvdXR8SW50ZXJ2YWwpP3xhKD86cHR1cmVFdmVudHN8bGwpfHJlYXRlKD86U3R5bGVTaGVldHxQb3B1cHxFdmVudE9iamVjdCkpfHQoPzpvKD86R01UU3RyaW5nfFMoPzp0cmluZ3xvdXJjZSl8VSg/OlRDU3RyaW5nfHBwZXJDYXNlKXxMbyg/OmNhbGVTdHJpbmd8d2VyQ2FzZSkpfGVzdHxhKD86bnxpbnQoPzpFbmFibGVkKT8pKXxpKD86cyg/Ok5hTnxGaW5pdGUpfG5kZXhPZnx0YWxpY3MpfGQoPzppc2FibGVFeHRlcm5hbENhcHR1cmV8dW1wfGV0YWNoRXZlbnQpfHUoPzpuKD86c2hpZnR8dGFpbnR8ZXNjYXBlfHdhdGNoKXxwZGF0ZUNvbW1hbmRzKXxqKD86b2lufGF2YUVuYWJsZWQpfHAoPzpvKD86cHx3KXx1c2h8bHVnaW5zLnJlZnJlc2h8YSg/OmRkaW5nc3xyc2UoPzpJbnR8RmxvYXQpPyl8cig/OmludHxvbXB0fGVmZXJlbmNlKSl8ZSg/OnNjYXBlfG5hYmxlRXh0ZXJuYWxDYXB0dXJlfHZhbHxsZW1lbnRGcm9tUG9pbnR8eCg/OnB8ZWMoPzpTY3JpcHR8Q29tbWFuZCk/KSl8dmFsdWVPZnxVVEN8cXVlcnlDb21tYW5kKD86U3RhdGV8SW5kZXRlcm18RW5hYmxlZHxWYWx1ZSl8Zig/OmkoPzpuZHxsdGVyfGxlKD86TW9kaWZpZWREYXRlfFNpemV8Q3JlYXRlZERhdGV8VXBkYXRlZERhdGUpfHhlZCl8byg/Om50KD86c2l6ZXxjb2xvcil8cndhcmR8ckVhY2gpfGxvb3J8cm9tQ2hhckNvZGUpfHdhdGNofGwoPzppbmt8byg/OmFkfGcpfGFzdEluZGV4T2YpfGEoPzpzaW58bmNob3J8Y29zfHQoPzp0YWNoRXZlbnR8b2J8YW4oPzoyKT8pfHBwbHl8bGVydHxiKD86c3xvcnQpKXxyKD86b3UoPzpuZHx0ZUV2ZW50cyl8ZSg/OnNpemUoPzpCeXxUbyl8Y2FsY3x0dXJuVmFsdWV8cGxhY2V8dmVyc2V8bCg/Om9hZHxlYXNlKD86Q2FwdHVyZXxFdmVudHMpKSl8YW5kb20pfGcoPzpvfGV0KD86UmVzcG9uc2VIZWFkZXJ8TSg/OmkoPzpudXRlc3xsbGlzZWNvbmRzKXxvbnRoKXxTZSg/OmNvbmRzfGxlY3Rpb24pfEhvdXJzfFllYXJ8VGltZSg/OnpvbmVPZmZzZXQpP3xEYSg/Onl8dGUpfFVUQyg/Ok0oPzppKD86bnV0ZXN8bGxpc2Vjb25kcyl8b250aCl8U2Vjb25kc3xIb3Vyc3xEYSg/Onl8dGUpfEZ1bGxZZWFyKXxGdWxsWWVhcnxBKD86dHRlbnRpb258bGxSZXNwb25zZUhlYWRlcnMpKSl8bSg/OmlufG92ZSg/OkIoPzp5fGVsb3cpfFRvKD86QWJzb2x1dGUpP3xBYm92ZSl8ZXJnZUF0dHJpYnV0ZXN8YSg/OnRjaHxyZ2luc3x4KSl8Yig/OnRvYXxpZ3xvKD86bGR8cmRlcldpZHRocyl8bGlua3xhY2spKVxiKD89XCgpLwogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICB0b2tlbjogInN1cHBvcnQuZnVuY3Rpb24uZG9tIiwKICAgICAgICAgICAgICAgIHJlZ2V4OiAvKHMoPzp1Yig/OnN0cmluZ0RhdGF8bWl0KXxwbGl0VGV4dHxlKD86dCg/Ok5hbWVkSXRlbXxBdHRyaWJ1dGUoPzpOb2RlKT8pfGxlY3QpKXxoYXMoPzpDaGlsZE5vZGVzfEZlYXR1cmUpfG5hbWVkSXRlbXxjKD86bCg/Omlja3xvKD86c2V8bmVOb2RlKSl8cmVhdGUoPzpDKD86b21tZW50fERBVEFTZWN0aW9ufGFwdGlvbil8VCg/OkhlYWR8ZXh0Tm9kZXxGb290KXxEb2N1bWVudEZyYWdtZW50fFByb2Nlc3NpbmdJbnN0cnVjdGlvbnxFKD86bnRpdHlSZWZlcmVuY2V8bGVtZW50KXxBdHRyaWJ1dGUpKXx0YWJJbmRleHxpKD86bnNlcnQoPzpSb3d8QmVmb3JlfENlbGx8RGF0YSl8dGVtKXxvcGVufGRlbGV0ZSg/OlJvd3xDKD86ZWxsfGFwdGlvbil8VCg/OkhlYWR8Rm9vdCl8RGF0YSl8Zm9jdXN8d3JpdGUoPzpsbik/fGEoPzpkZHxwcGVuZCg/OkNoaWxkfERhdGEpKXxyZSg/OnNldHxwbGFjZSg/OkNoaWxkfERhdGEpfG1vdmUoPzpOYW1lZEl0ZW18Q2hpbGR8QXR0cmlidXRlKD86Tm9kZSk/KT8pfGdldCg/Ok5hbWVkSXRlbXxFbGVtZW50KD86c0J5KD86TmFtZXxUYWdOYW1lfENsYXNzTmFtZSl8QnlJZCl8QXR0cmlidXRlKD86Tm9kZSk/KXxibHVyKVxiKD89XCgpLwogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICB0b2tlbjogInN1cHBvcnQuY29uc3RhbnQiLAogICAgICAgICAgICAgICAgcmVnZXg6IC8ocyg/OnlzdGVtTGFuZ3VhZ2V8Y3IoPzppcHRzfG9sbGJhcnN8ZWVuKD86WHxZfFRvcHxMZWZ0KSl8dCg/OnlsZSg/OlNoZWV0cyk/fGF0dXMoPzpUZXh0fGJhcik/KXxpYmxpbmcoPzpCZWxvd3xBYm92ZSl8b3VyY2V8dWZmaXhlc3xlKD86Y3VyaXR5KD86UG9saWN5KT98bCg/OmVjdGlvbnxmKSkpfGgoPzppc3Rvcnl8b3N0KD86bmFtZSk/fGFzKD86aHxGb2N1cykpfHl8WCg/Ok1MRG9jdW1lbnR8U0xEb2N1bWVudCl8big/OmV4dHxhbWUoPzpzcGFjZSg/OnN8VVJJKXxQcm9wKSl8TSg/OklOX1ZBTFVFfEFYX1ZBTFVFKXxjKD86aGFyYWN0ZXJTZXR8byg/Om4oPzpzdHJ1Y3Rvcnx0cm9sbGVycyl8b2tpZUVuYWJsZWR8bG9yRGVwdGh8bXAoPzpvbmVudHN8bGV0ZSkpfHVycmVudHxwdUNsYXNzfGwoPzppKD86cCg/OmJvYXJkRGF0YSk/fGVudEluZm9ybWF0aW9uKXxvc2VkfGFzc2VzKXxhbGxlKD86ZXxyKXxyeXB0byl8dCg/Om8oPzpvbGJhcnxwKXxleHQoPzpUcmFuc2Zvcm18SW5kZW50fERlY29yYXRpb258QWxpZ24pfGFncyl8U1FSVCg/OjFfMnwyKXxpKD86big/Om5lcig/OkhlaWdodHxXaWR0aCl8cHV0KXxkc3xnbm9yZUNhc2UpfHpJbmRleHxvKD86c2NwdXxuKD86cmVhZHlzdGF0ZWNoYW5nZXxMaW5lKXx1dGVyKD86SGVpZ2h0fFdpZHRoKXxwKD86c1Byb2ZpbGV8ZW5lcil8ZmZzY3JlZW5CdWZmZXJpbmcpfE5FR0FUSVZFX0lORklOSVRZfGQoPzppKD86c3BsYXl8YWxvZyg/OkhlaWdodHxUb3B8V2lkdGh8TGVmdHxBcmd1bWVudHMpfHJlY3Rvcmllcyl8ZSg/OnNjcmlwdGlvbnxmYXVsdCg/OlN0YXR1c3xDaCg/OmVja2VkfGFyc2V0KXxWaWV3KSkpfHUoPzpzZXIoPzpQcm9maWxlfExhbmd1YWdlfEFnZW50KXxuKD86aXF1ZUlEfGRlZmluZWQpfHBkYXRlSW50ZXJ2YWwpfF9jb250ZW50fHAoPzppeGVsRGVwdGh8b3J0fGVyc29uYWxiYXJ8a2NzMTF8bCg/OnVnaW5zfGF0Zm9ybSl8YSg/OnRobmFtZXxkZGluZyg/OlJpZ2h0fEJvdHRvbXxUb3B8TGVmdCl8cmVudCg/OldpbmRvd3xMYXllcik/fGdlKD86WCg/Ok9mZnNldCk/fFkoPzpPZmZzZXQpPykpfHIoPzpvKD86dG8oPzpjb2x8dHlwZSl8ZHVjdCg/OlN1Yik/fG1wdGVyKXxlKD86dmlvdXN8Zml4KSkpfGUoPzpuKD86Y29kaW5nfGFibGVkUGx1Z2luKXx4KD86dGVybmFsfHBhbmRvKXxtYmVkcyl8dig/OmlzaWJpbGl0eXxlbmRvcig/OlN1Yik/fExpbmtjb2xvcil8VVJMVW5lbmNvZGVkfFAoPzpJfE9TSVRJVkVfSU5GSU5JVFkpfGYoPzppbGVuYW1lfG8oPzpudCg/OlNpemV8RmFtaWx5fFdlaWdodCl8cm1OYW1lKXxyYW1lKD86c3xFbGVtZW50KXxnQ29sb3IpfEV8d2hpdGVTcGFjZXxsKD86aSg/OnN0U3R5bGVUeXBlfG4oPzplSGVpZ2h0fGtDb2xvcikpfG8oPzpjYSg/OnRpb24oPzpiYXIpP3xsTmFtZSl8d3NyYyl8ZSg/Om5ndGh8ZnQoPzpDb250ZXh0KT8pfGEoPzpzdCg/Ok0oPzpvZGlmaWVkfGF0Y2gpfEluZGV4fFBhcmVuKXx5ZXIoPzpzfFgpfG5ndWFnZSkpfGEoPzpwcCg/Ok1pbm9yVmVyc2lvbnxOYW1lfENvKD86ZGVOYW1lfHJlKXxWZXJzaW9uKXx2YWlsKD86SGVpZ2h0fFRvcHxXaWR0aHxMZWZ0KXxsbHxyKD86aXR5fGd1bWVudHMpfExpbmtjb2xvcnxib3ZlKXxyKD86aWdodCg/OkNvbnRleHQpP3xlKD86c3BvbnNlKD86WE1MfFRleHQpfGFkeVN0YXRlKSl8Z2xvYmFsfHh8bSg/OmltZVR5cGVzfHVsdGlsaW5lfGVudWJhcnxhcmdpbig/OlJpZ2h0fEJvdHRvbXxUb3B8TGVmdCkpfEwoPzpOKD86MTB8Mil8T0coPzoxMEV8MkUpKXxiKD86byg/OnR0b218cmRlcig/OldpZHRofFJpZ2h0V2lkdGh8Qm90dG9tV2lkdGh8U3R5bGV8Q29sb3J8VG9wV2lkdGh8TGVmdFdpZHRoKSl8dWZmZXJEZXB0aHxlbG93fGFja2dyb3VuZCg/OkNvbG9yfEltYWdlKSkpXGIvCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIHRva2VuOiAiaWRlbnRpZmllciIsCiAgICAgICAgICAgICAgICByZWdleDogaWRlbnRpZmllclJlCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIHJlZ2V4OiAiIiwKICAgICAgICAgICAgICAgIHRva2VuOiAiZW1wdHkiLAogICAgICAgICAgICAgICAgbmV4dDogIm5vX3JlZ2V4IgogICAgICAgICAgICB9CiAgICAgICAgXSwKICAgICAgICAic3RhcnQiOiBbCiAgICAgICAgICAgIERvY0NvbW1lbnRIaWdobGlnaHRSdWxlcy5nZXRTdGFydFJ1bGUoImRvYy1zdGFydCIpLAogICAgICAgICAgICBjb21tZW50cygic3RhcnQiKSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdG9rZW46ICJzdHJpbmcucmVnZXhwIiwKICAgICAgICAgICAgICAgIHJlZ2V4OiAiXFwvIiwKICAgICAgICAgICAgICAgIG5leHQ6ICJyZWdleCIKICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgdG9rZW46ICJ0ZXh0IiwKICAgICAgICAgICAgICAgIHJlZ2V4OiAiXFxzK3xeJCIsCiAgICAgICAgICAgICAgICBuZXh0OiAic3RhcnQiCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIHRva2VuOiAiZW1wdHkiLAogICAgICAgICAgICAgICAgcmVnZXg6ICIiLAogICAgICAgICAgICAgICAgbmV4dDogIm5vX3JlZ2V4IgogICAgICAgICAgICB9CiAgICAgICAgXSwKICAgICAgICAicmVnZXgiOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHRva2VuOiAicmVnZXhwLmtleXdvcmQub3BlcmF0b3IiLAogICAgICAgICAgICAgICAgcmVnZXg6ICJcXFxcKD86dVtcXGRhLWZBLUZdezR9fHhbXFxkYS1mQS1GXXsyfXwuKSIKICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgdG9rZW46ICJzdHJpbmcucmVnZXhwIiwKICAgICAgICAgICAgICAgIHJlZ2V4OiAiL1tzeG5naW15XSoiLAogICAgICAgICAgICAgICAgbmV4dDogIm5vX3JlZ2V4IgogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICB0b2tlbjogImludmFsaWQiLAogICAgICAgICAgICAgICAgcmVnZXg6IC9ce1xkK1xiLD9cZCpcfVsrKl18WysqJF4/XVsrKl18WyReXVs/XXxcP3szLH0vCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIHRva2VuOiAiY29uc3RhbnQubGFuZ3VhZ2UuZXNjYXBlIiwKICAgICAgICAgICAgICAgIHJlZ2V4OiAvXChcP1s6PSFdfFwpfFx7XGQrXGIsP1xkKlx9fFsrKl1cP3xbKCkkXisqPy5dLwogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICB0b2tlbjogImNvbnN0YW50Lmxhbmd1YWdlLmRlbGltaXRlciIsCiAgICAgICAgICAgICAgICByZWdleDogL1x8LwogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICB0b2tlbjogImNvbnN0YW50Lmxhbmd1YWdlLmVzY2FwZSIsCiAgICAgICAgICAgICAgICByZWdleDogL1xbXF4/LywKICAgICAgICAgICAgICAgIG5leHQ6ICJyZWdleF9jaGFyYWN0ZXJfY2xhc3MiCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIHRva2VuOiAiZW1wdHkiLAogICAgICAgICAgICAgICAgcmVnZXg6ICIkIiwKICAgICAgICAgICAgICAgIG5leHQ6ICJub19yZWdleCIKICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgZGVmYXVsdFRva2VuOiAic3RyaW5nLnJlZ2V4cCIKICAgICAgICAgICAgfQogICAgICAgIF0sCiAgICAgICAgInJlZ2V4X2NoYXJhY3Rlcl9jbGFzcyI6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdG9rZW46ICJyZWdleHAuY2hhcmNsYXNzLmtleXdvcmQub3BlcmF0b3IiLAogICAgICAgICAgICAgICAgcmVnZXg6ICJcXFxcKD86dVtcXGRhLWZBLUZdezR9fHhbXFxkYS1mQS1GXXsyfXwuKSIKICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgdG9rZW46ICJjb25zdGFudC5sYW5ndWFnZS5lc2NhcGUiLAogICAgICAgICAgICAgICAgcmVnZXg6ICJdIiwKICAgICAgICAgICAgICAgIG5leHQ6ICJyZWdleCIKICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgdG9rZW46ICJjb25zdGFudC5sYW5ndWFnZS5lc2NhcGUiLAogICAgICAgICAgICAgICAgcmVnZXg6ICItIgogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICB0b2tlbjogImVtcHR5IiwKICAgICAgICAgICAgICAgIHJlZ2V4OiAiJCIsCiAgICAgICAgICAgICAgICBuZXh0OiAibm9fcmVnZXgiCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIGRlZmF1bHRUb2tlbjogInN0cmluZy5yZWdleHAuY2hhcmFjaHRlcmNsYXNzIgogICAgICAgICAgICB9CiAgICAgICAgXSwKICAgICAgICAiZGVmYXVsdF9wYXJhbWV0ZXIiOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHRva2VuOiAic3RyaW5nIiwKICAgICAgICAgICAgICAgIHJlZ2V4OiAiJyg/PS4pIiwKICAgICAgICAgICAgICAgIHB1c2g6IFsKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRva2VuOiAic3RyaW5nIiwKICAgICAgICAgICAgICAgICAgICAgICAgcmVnZXg6ICInfCQiLAogICAgICAgICAgICAgICAgICAgICAgICBuZXh0OiAicG9wIgogICAgICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgICAgICAgaW5jbHVkZTogInFzdHJpbmciCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgXQogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICB0b2tlbjogInN0cmluZyIsCiAgICAgICAgICAgICAgICByZWdleDogJyIoPz0uKScsCiAgICAgICAgICAgICAgICBwdXNoOiBbCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICB0b2tlbjogInN0cmluZyIsCiAgICAgICAgICAgICAgICAgICAgICAgIHJlZ2V4OiAnInwkJywKICAgICAgICAgICAgICAgICAgICAgICAgbmV4dDogInBvcCIKICAgICAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgICAgICAgIGluY2x1ZGU6ICJxcXN0cmluZyIKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIHRva2VuOiAiY29uc3RhbnQubGFuZ3VhZ2UiLAogICAgICAgICAgICAgICAgcmVnZXg6ICJudWxsfEluZmluaXR5fE5hTnx1bmRlZmluZWQiCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIHRva2VuOiAiY29uc3RhbnQubnVtZXJpYyIsIC8vIGhleGFkZWNpbWFsLCBvY3RhbCBhbmQgYmluYXJ5CiAgICAgICAgICAgICAgICByZWdleDogLzAoPzpbeFhdWzAtOWEtZkEtRl0rfFtvT11bMC03XSt8W2JCXVswMV0rKVxiLwogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICB0b2tlbjogImNvbnN0YW50Lm51bWVyaWMiLCAvLyBkZWNpbWFsIGludGVnZXJzIGFuZCBmbG9hdHMKICAgICAgICAgICAgICAgIHJlZ2V4OiAvKD86XGRcZCooPzpcLlxkKik/fFwuXGQrKSg/OltlRV1bKy1dP1xkK1xiKT8vCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIHRva2VuOiAicHVuY3R1YXRpb24ub3BlcmF0b3IiLAogICAgICAgICAgICAgICAgcmVnZXg6ICIsIiwKICAgICAgICAgICAgICAgIG5leHQ6ICJmdW5jdGlvbl9hcmd1bWVudHMiCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIHRva2VuOiAidGV4dCIsCiAgICAgICAgICAgICAgICByZWdleDogIlxccysiCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIHRva2VuOiAicHVuY3R1YXRpb24ub3BlcmF0b3IiLAogICAgICAgICAgICAgICAgcmVnZXg6ICIkIgogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICB0b2tlbjogImVtcHR5IiwKICAgICAgICAgICAgICAgIHJlZ2V4OiAiIiwKICAgICAgICAgICAgICAgIG5leHQ6ICJub19yZWdleCIKICAgICAgICAgICAgfQogICAgICAgIF0sCiAgICAgICAgImZ1bmN0aW9uX2FyZ3VtZW50cyI6IFsKICAgICAgICAgICAgY29tbWVudHMoImZ1bmN0aW9uX2FyZ3VtZW50cyIpLAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB0b2tlbjogInZhcmlhYmxlLnBhcmFtZXRlciIsCiAgICAgICAgICAgICAgICByZWdleDogaWRlbnRpZmllclJlCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIHRva2VuOiAicHVuY3R1YXRpb24ub3BlcmF0b3IiLAogICAgICAgICAgICAgICAgcmVnZXg6ICIsIgogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICB0b2tlbjogInRleHQiLAogICAgICAgICAgICAgICAgcmVnZXg6ICJcXHMrIgogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICB0b2tlbjogInB1bmN0dWF0aW9uLm9wZXJhdG9yIiwKICAgICAgICAgICAgICAgIHJlZ2V4OiAiJCIKICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgdG9rZW46ICJlbXB0eSIsCiAgICAgICAgICAgICAgICByZWdleDogIiIsCiAgICAgICAgICAgICAgICBuZXh0OiAibm9fcmVnZXgiCiAgICAgICAgICAgIH0KICAgICAgICBdLAogICAgICAgICJxcXN0cmluZyI6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdG9rZW46ICJjb25zdGFudC5sYW5ndWFnZS5lc2NhcGUiLAogICAgICAgICAgICAgICAgcmVnZXg6IGVzY2FwZWRSZQogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICB0b2tlbjogInN0cmluZyIsCiAgICAgICAgICAgICAgICByZWdleDogIlxcXFwkIiwKICAgICAgICAgICAgICAgIGNvbnN1bWVMaW5lRW5kOiB0cnVlCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIHRva2VuOiAic3RyaW5nIiwKICAgICAgICAgICAgICAgIHJlZ2V4OiAnInwkJywKICAgICAgICAgICAgICAgIG5leHQ6ICJub19yZWdleCIKICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgZGVmYXVsdFRva2VuOiAic3RyaW5nIgogICAgICAgICAgICB9CiAgICAgICAgXSwKICAgICAgICAicXN0cmluZyI6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdG9rZW46ICJjb25zdGFudC5sYW5ndWFnZS5lc2NhcGUiLAogICAgICAgICAgICAgICAgcmVnZXg6IGVzY2FwZWRSZQogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICB0b2tlbjogInN0cmluZyIsCiAgICAgICAgICAgICAgICByZWdleDogIlxcXFwkIiwKICAgICAgICAgICAgICAgIGNvbnN1bWVMaW5lRW5kOiB0cnVlCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIHRva2VuOiAic3RyaW5nIiwKICAgICAgICAgICAgICAgIHJlZ2V4OiAiJ3wkIiwKICAgICAgICAgICAgICAgIG5leHQ6ICJub19yZWdleCIKICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgZGVmYXVsdFRva2VuOiAic3RyaW5nIgogICAgICAgICAgICB9CiAgICAgICAgXQogICAgfTsKICAgIGlmICghb3B0aW9ucyB8fCAhb3B0aW9ucy5ub0VTNikgewogICAgICAgIHRoaXMuJHJ1bGVzLm5vX3JlZ2V4LnVuc2hpZnQoewogICAgICAgICAgICByZWdleDogIlt7fV0iLCBvbk1hdGNoOiBmdW5jdGlvbiAodmFsLCBzdGF0ZSwgc3RhY2spIHsKICAgICAgICAgICAgICAgIHRoaXMubmV4dCA9IHZhbCA9PSAieyIgPyB0aGlzLm5leHRTdGF0ZSA6ICIiOwogICAgICAgICAgICAgICAgaWYgKHZhbCA9PSAieyIgJiYgc3RhY2subGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgc3RhY2sudW5zaGlmdCgic3RhcnQiLCBzdGF0ZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmICh2YWwgPT0gIn0iICYmIHN0YWNrLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5uZXh0ID0gc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5uZXh0LmluZGV4T2YoInN0cmluZyIpICE9IC0xIHx8IHRoaXMubmV4dC5pbmRleE9mKCJqc3giKSAhPSAtMSkKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICJwYXJlbi5xdWFzaS5lbmQiOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHZhbCA9PSAieyIgPyAicGFyZW4ubHBhcmVuIiA6ICJwYXJlbi5ycGFyZW4iOwogICAgICAgICAgICB9LAogICAgICAgICAgICBuZXh0U3RhdGU6ICJzdGFydCIKICAgICAgICB9LCB7CiAgICAgICAgICAgIHRva2VuOiAic3RyaW5nLnF1YXNpLnN0YXJ0IiwKICAgICAgICAgICAgcmVnZXg6IC9gLywKICAgICAgICAgICAgcHVzaDogW3sKICAgICAgICAgICAgICAgICAgICB0b2tlbjogImNvbnN0YW50Lmxhbmd1YWdlLmVzY2FwZSIsCiAgICAgICAgICAgICAgICAgICAgcmVnZXg6IGVzY2FwZWRSZQogICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICAgIHRva2VuOiAicGFyZW4ucXVhc2kuc3RhcnQiLAogICAgICAgICAgICAgICAgICAgIHJlZ2V4OiAvXCR7LywKICAgICAgICAgICAgICAgICAgICBwdXNoOiAic3RhcnQiCiAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgICAgdG9rZW46ICJzdHJpbmcucXVhc2kuZW5kIiwKICAgICAgICAgICAgICAgICAgICByZWdleDogL2AvLAogICAgICAgICAgICAgICAgICAgIG5leHQ6ICJwb3AiCiAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFRva2VuOiAic3RyaW5nLnF1YXNpIgogICAgICAgICAgICAgICAgfV0KICAgICAgICB9LCB7CiAgICAgICAgICAgIHRva2VuOiBbInZhcmlhYmxlLnBhcmFtZXRlciIsICJ0ZXh0Il0sCiAgICAgICAgICAgIHJlZ2V4OiAiKCIgKyBpZGVudGlmaWVyUmUgKyAiKShcXHMqKSg/PVxcPT4pIgogICAgICAgIH0sIHsKICAgICAgICAgICAgdG9rZW46ICJwYXJlbi5scGFyZW4iLAogICAgICAgICAgICByZWdleDogIihcXCgpKD89W15cXChdK1xccyo9PikiLAogICAgICAgICAgICBuZXh0OiAiZnVuY3Rpb25fYXJndW1lbnRzIgogICAgICAgIH0sIHsKICAgICAgICAgICAgdG9rZW46ICJ2YXJpYWJsZS5sYW5ndWFnZSIsCiAgICAgICAgICAgIHJlZ2V4OiAiKD86KD86KD86V2Vhayk/KD86U2V0fE1hcCkpfFByb21pc2UpXFxiIgogICAgICAgIH0pOwogICAgICAgIHRoaXMuJHJ1bGVzWyJmdW5jdGlvbl9hcmd1bWVudHMiXS51bnNoaWZ0KHsKICAgICAgICAgICAgdG9rZW46ICJrZXl3b3JkLm9wZXJhdG9yIiwKICAgICAgICAgICAgcmVnZXg6ICI9IiwKICAgICAgICAgICAgbmV4dDogImRlZmF1bHRfcGFyYW1ldGVyIgogICAgICAgIH0sIHsKICAgICAgICAgICAgdG9rZW46ICJrZXl3b3JkLm9wZXJhdG9yIiwKICAgICAgICAgICAgcmVnZXg6ICJcXC57M30iCiAgICAgICAgfSk7CiAgICAgICAgdGhpcy4kcnVsZXNbInByb3BlcnR5Il0udW5zaGlmdCh7CiAgICAgICAgICAgIHRva2VuOiAic3VwcG9ydC5mdW5jdGlvbiIsCiAgICAgICAgICAgIHJlZ2V4OiAiKGZpbmRJbmRleHxyZXBlYXR8c3RhcnRzV2l0aHxlbmRzV2l0aHxpbmNsdWRlc3xpc1NhZmVJbnRlZ2VyfHRydW5jfGNicnR8bG9nMnxsb2cxMHxzaWdufHRoZW58Y2F0Y2h8IgogICAgICAgICAgICAgICAgKyAiZmluYWxseXxyZXNvbHZlfHJlamVjdHxyYWNlfGFueXxhbGx8YWxsU2V0dGxlZHxrZXlzfGVudHJpZXN8aXNJbnRlZ2VyKVxcYig/PVxcKCkiCiAgICAgICAgfSwgewogICAgICAgICAgICB0b2tlbjogImNvbnN0YW50Lmxhbmd1YWdlIiwKICAgICAgICAgICAgcmVnZXg6ICIoPzpNQVhfU0FGRV9JTlRFR0VSfE1JTl9TQUZFX0lOVEVHRVJ8RVBTSUxPTilcXGIiCiAgICAgICAgfSk7CiAgICAgICAgaWYgKCFvcHRpb25zIHx8IG9wdGlvbnMuanN4ICE9IGZhbHNlKQogICAgICAgICAgICBKU1guY2FsbCh0aGlzKTsKICAgIH0KICAgIHRoaXMuZW1iZWRSdWxlcyhEb2NDb21tZW50SGlnaGxpZ2h0UnVsZXMsICJkb2MtIiwgW0RvY0NvbW1lbnRIaWdobGlnaHRSdWxlcy5nZXRFbmRSdWxlKCJub19yZWdleCIpXSk7CiAgICB0aGlzLm5vcm1hbGl6ZVJ1bGVzKCk7Cn07Cm9vcC5pbmhlcml0cyhKYXZhU2NyaXB0SGlnaGxpZ2h0UnVsZXMsIFRleHRIaWdobGlnaHRSdWxlcyk7CmZ1bmN0aW9uIEpTWCgpIHsKICAgIHZhciB0YWdSZWdleCA9IGlkZW50aWZpZXJSZS5yZXBsYWNlKCJcXGQiLCAiXFxkXFwtIik7CiAgICB2YXIganN4VGFnID0gewogICAgICAgIG9uTWF0Y2g6IGZ1bmN0aW9uICh2YWwsIHN0YXRlLCBzdGFjaykgewogICAgICAgICAgICB2YXIgb2Zmc2V0ID0gdmFsLmNoYXJBdCgxKSA9PSAiLyIgPyAyIDogMTsKICAgICAgICAgICAgaWYgKG9mZnNldCA9PSAxKSB7CiAgICAgICAgICAgICAgICBpZiAoc3RhdGUgIT0gdGhpcy5uZXh0U3RhdGUpCiAgICAgICAgICAgICAgICAgICAgc3RhY2sudW5zaGlmdCh0aGlzLm5leHQsIHRoaXMubmV4dFN0YXRlLCAwKTsKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBzdGFjay51bnNoaWZ0KHRoaXMubmV4dCk7CiAgICAgICAgICAgICAgICBzdGFja1syXSsrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgaWYgKG9mZnNldCA9PSAyKSB7CiAgICAgICAgICAgICAgICBpZiAoc3RhdGUgPT0gdGhpcy5uZXh0U3RhdGUpIHsKICAgICAgICAgICAgICAgICAgICBzdGFja1sxXS0tOwogICAgICAgICAgICAgICAgICAgIGlmICghc3RhY2tbMV0gfHwgc3RhY2tbMV0gPCAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBbewogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJtZXRhLnRhZy5wdW5jdHVhdGlvbi4iICsgKG9mZnNldCA9PSAxID8gIiIgOiAiZW5kLSIpICsgInRhZy1vcGVuLnhtbCIsCiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHZhbC5zbGljZSgwLCBvZmZzZXQpCiAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgICAgdHlwZTogIm1ldGEudGFnLnRhZy1uYW1lLnhtbCIsCiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHZhbC5zdWJzdHIob2Zmc2V0KQogICAgICAgICAgICAgICAgfV07CiAgICAgICAgfSwKICAgICAgICByZWdleDogIjwvPyg/OiIgKyB0YWdSZWdleCArICJ8KD89PikpIiwKICAgICAgICBuZXh0OiAianN4QXR0cmlidXRlcyIsCiAgICAgICAgbmV4dFN0YXRlOiAianN4IgogICAgfTsKICAgIHRoaXMuJHJ1bGVzLnN0YXJ0LnVuc2hpZnQoanN4VGFnKTsKICAgIHZhciBqc3hKc1J1bGUgPSB7CiAgICAgICAgcmVnZXg6ICJ7IiwKICAgICAgICB0b2tlbjogInBhcmVuLnF1YXNpLnN0YXJ0IiwKICAgICAgICBwdXNoOiAic3RhcnQiCiAgICB9OwogICAgdGhpcy4kcnVsZXMuanN4ID0gWwogICAgICAgIGpzeEpzUnVsZSwKICAgICAgICBqc3hUYWcsCiAgICAgICAgeyBpbmNsdWRlOiAicmVmZXJlbmNlIiB9LCB7IGRlZmF1bHRUb2tlbjogInN0cmluZy54bWwiIH0KICAgIF07CiAgICB0aGlzLiRydWxlcy5qc3hBdHRyaWJ1dGVzID0gW3sKICAgICAgICAgICAgdG9rZW46ICJtZXRhLnRhZy5wdW5jdHVhdGlvbi50YWctY2xvc2UueG1sIiwKICAgICAgICAgICAgcmVnZXg6ICIvPz4iLAogICAgICAgICAgICBvbk1hdGNoOiBmdW5jdGlvbiAodmFsdWUsIGN1cnJlbnRTdGF0ZSwgc3RhY2spIHsKICAgICAgICAgICAgICAgIGlmIChjdXJyZW50U3RhdGUgPT0gc3RhY2tbMF0pCiAgICAgICAgICAgICAgICAgICAgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICAgIGlmICh2YWx1ZS5sZW5ndGggPT0gMikgewogICAgICAgICAgICAgICAgICAgIGlmIChzdGFja1swXSA9PSB0aGlzLm5leHRTdGF0ZSkKICAgICAgICAgICAgICAgICAgICAgICAgc3RhY2tbMV0tLTsKICAgICAgICAgICAgICAgICAgICBpZiAoIXN0YWNrWzFdIHx8IHN0YWNrWzFdIDwgMCkgewogICAgICAgICAgICAgICAgICAgICAgICBzdGFjay5zcGxpY2UoMCwgMik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdGhpcy5uZXh0ID0gc3RhY2tbMF0gfHwgInN0YXJ0IjsKICAgICAgICAgICAgICAgIHJldHVybiBbeyB0eXBlOiB0aGlzLnRva2VuLCB2YWx1ZTogdmFsdWUgfV07CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIG5leHRTdGF0ZTogImpzeCIKICAgICAgICB9LAogICAgICAgIGpzeEpzUnVsZSwKICAgICAgICBjb21tZW50cygianN4QXR0cmlidXRlcyIpLAogICAgICAgIHsKICAgICAgICAgICAgdG9rZW46ICJlbnRpdHkub3RoZXIuYXR0cmlidXRlLW5hbWUueG1sIiwKICAgICAgICAgICAgcmVnZXg6IHRhZ1JlZ2V4CiAgICAgICAgfSwgewogICAgICAgICAgICB0b2tlbjogImtleXdvcmQub3BlcmF0b3IuYXR0cmlidXRlLWVxdWFscy54bWwiLAogICAgICAgICAgICByZWdleDogIj0iCiAgICAgICAgfSwgewogICAgICAgICAgICB0b2tlbjogInRleHQudGFnLXdoaXRlc3BhY2UueG1sIiwKICAgICAgICAgICAgcmVnZXg6ICJcXHMrIgogICAgICAgIH0sIHsKICAgICAgICAgICAgdG9rZW46ICJzdHJpbmcuYXR0cmlidXRlLXZhbHVlLnhtbCIsCiAgICAgICAgICAgIHJlZ2V4OiAiJyIsCiAgICAgICAgICAgIHN0YXRlTmFtZTogImpzeF9hdHRyX3EiLAogICAgICAgICAgICBwdXNoOiBbCiAgICAgICAgICAgICAgICB7IHRva2VuOiAic3RyaW5nLmF0dHJpYnV0ZS12YWx1ZS54bWwiLCByZWdleDogIiciLCBuZXh0OiAicG9wIiB9LAogICAgICAgICAgICAgICAgeyBpbmNsdWRlOiAicmVmZXJlbmNlIiB9LAogICAgICAgICAgICAgICAgeyBkZWZhdWx0VG9rZW46ICJzdHJpbmcuYXR0cmlidXRlLXZhbHVlLnhtbCIgfQogICAgICAgICAgICBdCiAgICAgICAgfSwgewogICAgICAgICAgICB0b2tlbjogInN0cmluZy5hdHRyaWJ1dGUtdmFsdWUueG1sIiwKICAgICAgICAgICAgcmVnZXg6ICciJywKICAgICAgICAgICAgc3RhdGVOYW1lOiAianN4X2F0dHJfcXEiLAogICAgICAgICAgICBwdXNoOiBbCiAgICAgICAgICAgICAgICB7IHRva2VuOiAic3RyaW5nLmF0dHJpYnV0ZS12YWx1ZS54bWwiLCByZWdleDogJyInLCBuZXh0OiAicG9wIiB9LAogICAgICAgICAgICAgICAgeyBpbmNsdWRlOiAicmVmZXJlbmNlIiB9LAogICAgICAgICAgICAgICAgeyBkZWZhdWx0VG9rZW46ICJzdHJpbmcuYXR0cmlidXRlLXZhbHVlLnhtbCIgfQogICAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICBqc3hUYWcKICAgIF07CiAgICB0aGlzLiRydWxlcy5yZWZlcmVuY2UgPSBbewogICAgICAgICAgICB0b2tlbjogImNvbnN0YW50Lmxhbmd1YWdlLmVzY2FwZS5yZWZlcmVuY2UueG1sIiwKICAgICAgICAgICAgcmVnZXg6ICIoPzomI1swLTldKzspfCg/OiYjeFswLTlhLWZBLUZdKzspfCg/OiZbYS16QS1aMC05XzpcXC4tXSs7KSIKICAgICAgICB9XTsKfQpmdW5jdGlvbiBjb21tZW50cyhuZXh0KSB7CiAgICByZXR1cm4gWwogICAgICAgIHsKICAgICAgICAgICAgdG9rZW46ICJjb21tZW50IiwgLy8gbXVsdGkgbGluZSBjb21tZW50CiAgICAgICAgICAgIHJlZ2V4OiAvXC9cKi8sCiAgICAgICAgICAgIG5leHQ6IFsKICAgICAgICAgICAgICAgIERvY0NvbW1lbnRIaWdobGlnaHRSdWxlcy5nZXRUYWdSdWxlKCksCiAgICAgICAgICAgICAgICB7IHRva2VuOiAiY29tbWVudCIsIHJlZ2V4OiAiXFwqXFwvIiwgbmV4dDogbmV4dCB8fCAicG9wIiB9LAogICAgICAgICAgICAgICAgeyBkZWZhdWx0VG9rZW46ICJjb21tZW50IiwgY2FzZUluc2Vuc2l0aXZlOiB0cnVlIH0KICAgICAgICAgICAgXQogICAgICAgIH0sIHsKICAgICAgICAgICAgdG9rZW46ICJjb21tZW50IiwKICAgICAgICAgICAgcmVnZXg6ICJcXC9cXC8iLAogICAgICAgICAgICBuZXh0OiBbCiAgICAgICAgICAgICAgICBEb2NDb21tZW50SGlnaGxpZ2h0UnVsZXMuZ2V0VGFnUnVsZSgpLAogICAgICAgICAgICAgICAgeyB0b2tlbjogImNvbW1lbnQiLCByZWdleDogIiR8XiIsIG5leHQ6IG5leHQgfHwgInBvcCIgfSwKICAgICAgICAgICAgICAgIHsgZGVmYXVsdFRva2VuOiAiY29tbWVudCIsIGNhc2VJbnNlbnNpdGl2ZTogdHJ1ZSB9CiAgICAgICAgICAgIF0KICAgICAgICB9CiAgICBdOwp9CmV4cG9ydHMuSmF2YVNjcmlwdEhpZ2hsaWdodFJ1bGVzID0gSmF2YVNjcmlwdEhpZ2hsaWdodFJ1bGVzOwoKfSk7CgphY2UuZGVmaW5lKCJhY2UvbW9kZS9tYXRjaGluZ19icmFjZV9vdXRkZW50IixbInJlcXVpcmUiLCJleHBvcnRzIiwibW9kdWxlIiwiYWNlL3JhbmdlIl0sIGZ1bmN0aW9uKHJlcXVpcmUsIGV4cG9ydHMsIG1vZHVsZSl7InVzZSBzdHJpY3QiOwp2YXIgUmFuZ2UgPSByZXF1aXJlKCIuLi9yYW5nZSIpLlJhbmdlOwp2YXIgTWF0Y2hpbmdCcmFjZU91dGRlbnQgPSBmdW5jdGlvbiAoKSB7IH07CihmdW5jdGlvbiAoKSB7CiAgICB0aGlzLmNoZWNrT3V0ZGVudCA9IGZ1bmN0aW9uIChsaW5lLCBpbnB1dCkgewogICAgICAgIGlmICghL15ccyskLy50ZXN0KGxpbmUpKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgcmV0dXJuIC9eXHMqXH0vLnRlc3QoaW5wdXQpOwogICAgfTsKICAgIHRoaXMuYXV0b091dGRlbnQgPSBmdW5jdGlvbiAoZG9jLCByb3cpIHsKICAgICAgICB2YXIgbGluZSA9IGRvYy5nZXRMaW5lKHJvdyk7CiAgICAgICAgdmFyIG1hdGNoID0gbGluZS5tYXRjaCgvXihccypcfSkvKTsKICAgICAgICBpZiAoIW1hdGNoKQogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB2YXIgY29sdW1uID0gbWF0Y2hbMV0ubGVuZ3RoOwogICAgICAgIHZhciBvcGVuQnJhY2VQb3MgPSBkb2MuZmluZE1hdGNoaW5nQnJhY2tldCh7IHJvdzogcm93LCBjb2x1bW46IGNvbHVtbiB9KTsKICAgICAgICBpZiAoIW9wZW5CcmFjZVBvcyB8fCBvcGVuQnJhY2VQb3Mucm93ID09IHJvdykKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgdmFyIGluZGVudCA9IHRoaXMuJGdldEluZGVudChkb2MuZ2V0TGluZShvcGVuQnJhY2VQb3Mucm93KSk7CiAgICAgICAgZG9jLnJlcGxhY2UobmV3IFJhbmdlKHJvdywgMCwgcm93LCBjb2x1bW4gLSAxKSwgaW5kZW50KTsKICAgIH07CiAgICB0aGlzLiRnZXRJbmRlbnQgPSBmdW5jdGlvbiAobGluZSkgewogICAgICAgIHJldHVybiBsaW5lLm1hdGNoKC9eXHMqLylbMF07CiAgICB9Owp9KS5jYWxsKE1hdGNoaW5nQnJhY2VPdXRkZW50LnByb3RvdHlwZSk7CmV4cG9ydHMuTWF0Y2hpbmdCcmFjZU91dGRlbnQgPSBNYXRjaGluZ0JyYWNlT3V0ZGVudDsKCn0pOwoKYWNlLmRlZmluZSgiYWNlL21vZGUvYmVoYXZpb3VyL2phdmFzY3JpcHQiLFsicmVxdWlyZSIsImV4cG9ydHMiLCJtb2R1bGUiLCJhY2UvbGliL29vcCIsImFjZS90b2tlbl9pdGVyYXRvciIsImFjZS9tb2RlL2JlaGF2aW91ci9jc3R5bGUiLCJhY2UvbW9kZS9iZWhhdmlvdXIveG1sIl0sIGZ1bmN0aW9uKHJlcXVpcmUsIGV4cG9ydHMsIG1vZHVsZSl7InVzZSBzdHJpY3QiOwp2YXIgb29wID0gcmVxdWlyZSgiLi4vLi4vbGliL29vcCIpOwp2YXIgVG9rZW5JdGVyYXRvciA9IHJlcXVpcmUoIi4uLy4uL3Rva2VuX2l0ZXJhdG9yIikuVG9rZW5JdGVyYXRvcjsKdmFyIENzdHlsZUJlaGF2aW91ciA9IHJlcXVpcmUoIi4uL2JlaGF2aW91ci9jc3R5bGUiKS5Dc3R5bGVCZWhhdmlvdXI7CnZhciBYbWxCZWhhdmlvdXIgPSByZXF1aXJlKCIuLi9iZWhhdmlvdXIveG1sIikuWG1sQmVoYXZpb3VyOwp2YXIgSmF2YVNjcmlwdEJlaGF2aW91ciA9IGZ1bmN0aW9uICgpIHsKICAgIHZhciB4bWxCZWhhdmlvdXJzID0gbmV3IFhtbEJlaGF2aW91cih7IGNsb3NlQ3VybHlCcmFjZXM6IHRydWUgfSkuZ2V0QmVoYXZpb3VycygpOwogICAgdGhpcy5hZGRCZWhhdmlvdXJzKHhtbEJlaGF2aW91cnMpOwogICAgdGhpcy5pbmhlcml0KENzdHlsZUJlaGF2aW91cik7CiAgICB0aGlzLmFkZCgiYXV0b2Nsb3NpbmctZnJhZ21lbnQiLCAiaW5zZXJ0aW9uIiwgZnVuY3Rpb24gKHN0YXRlLCBhY3Rpb24sIGVkaXRvciwgc2Vzc2lvbiwgdGV4dCkgewogICAgICAgIGlmICh0ZXh0ID09ICc+JykgewogICAgICAgICAgICB2YXIgcG9zaXRpb24gPSBlZGl0b3IuZ2V0U2VsZWN0aW9uUmFuZ2UoKS5zdGFydDsKICAgICAgICAgICAgdmFyIGl0ZXJhdG9yID0gbmV3IFRva2VuSXRlcmF0b3Ioc2Vzc2lvbiwgcG9zaXRpb24ucm93LCBwb3NpdGlvbi5jb2x1bW4pOwogICAgICAgICAgICB2YXIgdG9rZW4gPSBpdGVyYXRvci5nZXRDdXJyZW50VG9rZW4oKSB8fCBpdGVyYXRvci5zdGVwQmFja3dhcmQoKTsKICAgICAgICAgICAgaWYgKCF0b2tlbikKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgaWYgKHRva2VuLnZhbHVlID09ICc8JykgewogICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICB0ZXh0OiAiPjwvPiIsCiAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uOiBbMSwgMV0KICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9KTsKfTsKb29wLmluaGVyaXRzKEphdmFTY3JpcHRCZWhhdmlvdXIsIENzdHlsZUJlaGF2aW91cik7CmV4cG9ydHMuSmF2YVNjcmlwdEJlaGF2aW91ciA9IEphdmFTY3JpcHRCZWhhdmlvdXI7Cgp9KTsKCmFjZS5kZWZpbmUoImFjZS9tb2RlL2ZvbGRpbmcvY3N0eWxlIixbInJlcXVpcmUiLCJleHBvcnRzIiwibW9kdWxlIiwiYWNlL2xpYi9vb3AiLCJhY2UvcmFuZ2UiLCJhY2UvbW9kZS9mb2xkaW5nL2ZvbGRfbW9kZSJdLCBmdW5jdGlvbihyZXF1aXJlLCBleHBvcnRzLCBtb2R1bGUpeyJ1c2Ugc3RyaWN0IjsKdmFyIG9vcCA9IHJlcXVpcmUoIi4uLy4uL2xpYi9vb3AiKTsKdmFyIFJhbmdlID0gcmVxdWlyZSgiLi4vLi4vcmFuZ2UiKS5SYW5nZTsKdmFyIEJhc2VGb2xkTW9kZSA9IHJlcXVpcmUoIi4vZm9sZF9tb2RlIikuRm9sZE1vZGU7CnZhciBGb2xkTW9kZSA9IGV4cG9ydHMuRm9sZE1vZGUgPSBmdW5jdGlvbiAoY29tbWVudFJlZ2V4KSB7CiAgICBpZiAoY29tbWVudFJlZ2V4KSB7CiAgICAgICAgdGhpcy5mb2xkaW5nU3RhcnRNYXJrZXIgPSBuZXcgUmVnRXhwKHRoaXMuZm9sZGluZ1N0YXJ0TWFya2VyLnNvdXJjZS5yZXBsYWNlKC9cfFtefF0qPyQvLCAifCIgKyBjb21tZW50UmVnZXguc3RhcnQpKTsKICAgICAgICB0aGlzLmZvbGRpbmdTdG9wTWFya2VyID0gbmV3IFJlZ0V4cCh0aGlzLmZvbGRpbmdTdG9wTWFya2VyLnNvdXJjZS5yZXBsYWNlKC9cfFtefF0qPyQvLCAifCIgKyBjb21tZW50UmVnZXguZW5kKSk7CiAgICB9Cn07Cm9vcC5pbmhlcml0cyhGb2xkTW9kZSwgQmFzZUZvbGRNb2RlKTsKKGZ1bmN0aW9uICgpIHsKICAgIHRoaXMuZm9sZGluZ1N0YXJ0TWFya2VyID0gLyhbXHtcW1woXSlbXlx9XF1cKV0qJHxeXHMqKFwvXCopLzsKICAgIHRoaXMuZm9sZGluZ1N0b3BNYXJrZXIgPSAvXlteXFtce1woXSooW1x9XF1cKV0pfF5bXHNcKl0qKFwqXC8pLzsKICAgIHRoaXMuc2luZ2xlTGluZUJsb2NrQ29tbWVudFJlID0gL15ccyooXC9cKikuKlwqXC9ccyokLzsKICAgIHRoaXMudHJpcGxlU3RhckJsb2NrQ29tbWVudFJlID0gL15ccyooXC9cKlwqXCopLipcKlwvXHMqJC87CiAgICB0aGlzLnN0YXJ0UmVnaW9uUmUgPSAvXlxzKihcL1wqfFwvXC8pIz9yZWdpb25cYi87CiAgICB0aGlzLl9nZXRGb2xkV2lkZ2V0QmFzZSA9IHRoaXMuZ2V0Rm9sZFdpZGdldDsKICAgIHRoaXMuZ2V0Rm9sZFdpZGdldCA9IGZ1bmN0aW9uIChzZXNzaW9uLCBmb2xkU3R5bGUsIHJvdykgewogICAgICAgIHZhciBsaW5lID0gc2Vzc2lvbi5nZXRMaW5lKHJvdyk7CiAgICAgICAgaWYgKHRoaXMuc2luZ2xlTGluZUJsb2NrQ29tbWVudFJlLnRlc3QobGluZSkpIHsKICAgICAgICAgICAgaWYgKCF0aGlzLnN0YXJ0UmVnaW9uUmUudGVzdChsaW5lKSAmJiAhdGhpcy50cmlwbGVTdGFyQmxvY2tDb21tZW50UmUudGVzdChsaW5lKSkKICAgICAgICAgICAgICAgIHJldHVybiAiIjsKICAgICAgICB9CiAgICAgICAgdmFyIGZ3ID0gdGhpcy5fZ2V0Rm9sZFdpZGdldEJhc2Uoc2Vzc2lvbiwgZm9sZFN0eWxlLCByb3cpOwogICAgICAgIGlmICghZncgJiYgdGhpcy5zdGFydFJlZ2lvblJlLnRlc3QobGluZSkpCiAgICAgICAgICAgIHJldHVybiAic3RhcnQiOyAvLyBsaW5lQ29tbWVudFJlZ2lvblN0YXJ0CiAgICAgICAgcmV0dXJuIGZ3OwogICAgfTsKICAgIHRoaXMuZ2V0Rm9sZFdpZGdldFJhbmdlID0gZnVuY3Rpb24gKHNlc3Npb24sIGZvbGRTdHlsZSwgcm93LCBmb3JjZU11bHRpbGluZSkgewogICAgICAgIHZhciBsaW5lID0gc2Vzc2lvbi5nZXRMaW5lKHJvdyk7CiAgICAgICAgaWYgKHRoaXMuc3RhcnRSZWdpb25SZS50ZXN0KGxpbmUpKQogICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRDb21tZW50UmVnaW9uQmxvY2soc2Vzc2lvbiwgbGluZSwgcm93KTsKICAgICAgICB2YXIgbWF0Y2ggPSBsaW5lLm1hdGNoKHRoaXMuZm9sZGluZ1N0YXJ0TWFya2VyKTsKICAgICAgICBpZiAobWF0Y2gpIHsKICAgICAgICAgICAgdmFyIGkgPSBtYXRjaC5pbmRleDsKICAgICAgICAgICAgaWYgKG1hdGNoWzFdKQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMub3BlbmluZ0JyYWNrZXRCbG9jayhzZXNzaW9uLCBtYXRjaFsxXSwgcm93LCBpKTsKICAgICAgICAgICAgdmFyIHJhbmdlID0gc2Vzc2lvbi5nZXRDb21tZW50Rm9sZFJhbmdlKHJvdywgaSArIG1hdGNoWzBdLmxlbmd0aCwgMSk7CiAgICAgICAgICAgIGlmIChyYW5nZSAmJiAhcmFuZ2UuaXNNdWx0aUxpbmUoKSkgewogICAgICAgICAgICAgICAgaWYgKGZvcmNlTXVsdGlsaW5lKSB7CiAgICAgICAgICAgICAgICAgICAgcmFuZ2UgPSB0aGlzLmdldFNlY3Rpb25SYW5nZShzZXNzaW9uLCByb3cpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZiAoZm9sZFN0eWxlICE9ICJhbGwiKQogICAgICAgICAgICAgICAgICAgIHJhbmdlID0gbnVsbDsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gcmFuZ2U7CiAgICAgICAgfQogICAgICAgIGlmIChmb2xkU3R5bGUgPT09ICJtYXJrYmVnaW4iKQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgdmFyIG1hdGNoID0gbGluZS5tYXRjaCh0aGlzLmZvbGRpbmdTdG9wTWFya2VyKTsKICAgICAgICBpZiAobWF0Y2gpIHsKICAgICAgICAgICAgdmFyIGkgPSBtYXRjaC5pbmRleCArIG1hdGNoWzBdLmxlbmd0aDsKICAgICAgICAgICAgaWYgKG1hdGNoWzFdKQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2xvc2luZ0JyYWNrZXRCbG9jayhzZXNzaW9uLCBtYXRjaFsxXSwgcm93LCBpKTsKICAgICAgICAgICAgcmV0dXJuIHNlc3Npb24uZ2V0Q29tbWVudEZvbGRSYW5nZShyb3csIGksIC0xKTsKICAgICAgICB9CiAgICB9OwogICAgdGhpcy5nZXRTZWN0aW9uUmFuZ2UgPSBmdW5jdGlvbiAoc2Vzc2lvbiwgcm93KSB7CiAgICAgICAgdmFyIGxpbmUgPSBzZXNzaW9uLmdldExpbmUocm93KTsKICAgICAgICB2YXIgc3RhcnRJbmRlbnQgPSBsaW5lLnNlYXJjaCgvXFMvKTsKICAgICAgICB2YXIgc3RhcnRSb3cgPSByb3c7CiAgICAgICAgdmFyIHN0YXJ0Q29sdW1uID0gbGluZS5sZW5ndGg7CiAgICAgICAgcm93ID0gcm93ICsgMTsKICAgICAgICB2YXIgZW5kUm93ID0gcm93OwogICAgICAgIHZhciBtYXhSb3cgPSBzZXNzaW9uLmdldExlbmd0aCgpOwogICAgICAgIHdoaWxlICgrK3JvdyA8IG1heFJvdykgewogICAgICAgICAgICBsaW5lID0gc2Vzc2lvbi5nZXRMaW5lKHJvdyk7CiAgICAgICAgICAgIHZhciBpbmRlbnQgPSBsaW5lLnNlYXJjaCgvXFMvKTsKICAgICAgICAgICAgaWYgKGluZGVudCA9PT0gLTEpCiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgaWYgKHN0YXJ0SW5kZW50ID4gaW5kZW50KQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIHZhciBzdWJSYW5nZSA9IHRoaXMuZ2V0Rm9sZFdpZGdldFJhbmdlKHNlc3Npb24sICJhbGwiLCByb3cpOwogICAgICAgICAgICBpZiAoc3ViUmFuZ2UpIHsKICAgICAgICAgICAgICAgIGlmIChzdWJSYW5nZS5zdGFydC5yb3cgPD0gc3RhcnRSb3cpIHsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYgKHN1YlJhbmdlLmlzTXVsdGlMaW5lKCkpIHsKICAgICAgICAgICAgICAgICAgICByb3cgPSBzdWJSYW5nZS5lbmQucm93OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZiAoc3RhcnRJbmRlbnQgPT0gaW5kZW50KSB7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZW5kUm93ID0gcm93OwogICAgICAgIH0KICAgICAgICByZXR1cm4gbmV3IFJhbmdlKHN0YXJ0Um93LCBzdGFydENvbHVtbiwgZW5kUm93LCBzZXNzaW9uLmdldExpbmUoZW5kUm93KS5sZW5ndGgpOwogICAgfTsKICAgIHRoaXMuZ2V0Q29tbWVudFJlZ2lvbkJsb2NrID0gZnVuY3Rpb24gKHNlc3Npb24sIGxpbmUsIHJvdykgewogICAgICAgIHZhciBzdGFydENvbHVtbiA9IGxpbmUuc2VhcmNoKC9ccyokLyk7CiAgICAgICAgdmFyIG1heFJvdyA9IHNlc3Npb24uZ2V0TGVuZ3RoKCk7CiAgICAgICAgdmFyIHN0YXJ0Um93ID0gcm93OwogICAgICAgIHZhciByZSA9IC9eXHMqKD86XC9cKnxcL1wvfC0tKSM/KGVuZCk/cmVnaW9uXGIvOwogICAgICAgIHZhciBkZXB0aCA9IDE7CiAgICAgICAgd2hpbGUgKCsrcm93IDwgbWF4Um93KSB7CiAgICAgICAgICAgIGxpbmUgPSBzZXNzaW9uLmdldExpbmUocm93KTsKICAgICAgICAgICAgdmFyIG0gPSByZS5leGVjKGxpbmUpOwogICAgICAgICAgICBpZiAoIW0pCiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgaWYgKG1bMV0pCiAgICAgICAgICAgICAgICBkZXB0aC0tOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBkZXB0aCsrOwogICAgICAgICAgICBpZiAoIWRlcHRoKQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIHZhciBlbmRSb3cgPSByb3c7CiAgICAgICAgaWYgKGVuZFJvdyA+IHN0YXJ0Um93KSB7CiAgICAgICAgICAgIHJldHVybiBuZXcgUmFuZ2Uoc3RhcnRSb3csIHN0YXJ0Q29sdW1uLCBlbmRSb3csIGxpbmUubGVuZ3RoKTsKICAgICAgICB9CiAgICB9Owp9KS5jYWxsKEZvbGRNb2RlLnByb3RvdHlwZSk7Cgp9KTsKCmFjZS5kZWZpbmUoImFjZS9tb2RlL2ZvbGRpbmcvamF2YXNjcmlwdCIsWyJyZXF1aXJlIiwiZXhwb3J0cyIsIm1vZHVsZSIsImFjZS9saWIvb29wIiwiYWNlL21vZGUvZm9sZGluZy94bWwiLCJhY2UvbW9kZS9mb2xkaW5nL2NzdHlsZSJdLCBmdW5jdGlvbihyZXF1aXJlLCBleHBvcnRzLCBtb2R1bGUpeyJ1c2Ugc3RyaWN0IjsKdmFyIG9vcCA9IHJlcXVpcmUoIi4uLy4uL2xpYi9vb3AiKTsKdmFyIFhtbEZvbGRNb2RlID0gcmVxdWlyZSgiLi94bWwiKS5Gb2xkTW9kZTsKdmFyIENGb2xkTW9kZSA9IHJlcXVpcmUoIi4vY3N0eWxlIikuRm9sZE1vZGU7CnZhciBGb2xkTW9kZSA9IGV4cG9ydHMuRm9sZE1vZGUgPSBmdW5jdGlvbiAoY29tbWVudFJlZ2V4KSB7CiAgICBpZiAoY29tbWVudFJlZ2V4KSB7CiAgICAgICAgdGhpcy5mb2xkaW5nU3RhcnRNYXJrZXIgPSBuZXcgUmVnRXhwKHRoaXMuZm9sZGluZ1N0YXJ0TWFya2VyLnNvdXJjZS5yZXBsYWNlKC9cfFtefF0qPyQvLCAifCIgKyBjb21tZW50UmVnZXguc3RhcnQpKTsKICAgICAgICB0aGlzLmZvbGRpbmdTdG9wTWFya2VyID0gbmV3IFJlZ0V4cCh0aGlzLmZvbGRpbmdTdG9wTWFya2VyLnNvdXJjZS5yZXBsYWNlKC9cfFtefF0qPyQvLCAifCIgKyBjb21tZW50UmVnZXguZW5kKSk7CiAgICB9CiAgICB0aGlzLnhtbEZvbGRNb2RlID0gbmV3IFhtbEZvbGRNb2RlKCk7Cn07Cm9vcC5pbmhlcml0cyhGb2xkTW9kZSwgQ0ZvbGRNb2RlKTsKKGZ1bmN0aW9uICgpIHsKICAgIHRoaXMuZ2V0Rm9sZFdpZGdldFJhbmdlQmFzZSA9IHRoaXMuZ2V0Rm9sZFdpZGdldFJhbmdlOwogICAgdGhpcy5nZXRGb2xkV2lkZ2V0QmFzZSA9IHRoaXMuZ2V0Rm9sZFdpZGdldDsKICAgIHRoaXMuZ2V0Rm9sZFdpZGdldCA9IGZ1bmN0aW9uIChzZXNzaW9uLCBmb2xkU3R5bGUsIHJvdykgewogICAgICAgIHZhciBmdyA9IHRoaXMuZ2V0Rm9sZFdpZGdldEJhc2Uoc2Vzc2lvbiwgZm9sZFN0eWxlLCByb3cpOwogICAgICAgIGlmICghZncpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMueG1sRm9sZE1vZGUuZ2V0Rm9sZFdpZGdldChzZXNzaW9uLCBmb2xkU3R5bGUsIHJvdyk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBmdzsKICAgIH07CiAgICB0aGlzLmdldEZvbGRXaWRnZXRSYW5nZSA9IGZ1bmN0aW9uIChzZXNzaW9uLCBmb2xkU3R5bGUsIHJvdywgZm9yY2VNdWx0aWxpbmUpIHsKICAgICAgICB2YXIgcmFuZ2UgPSB0aGlzLmdldEZvbGRXaWRnZXRSYW5nZUJhc2Uoc2Vzc2lvbiwgZm9sZFN0eWxlLCByb3csIGZvcmNlTXVsdGlsaW5lKTsKICAgICAgICBpZiAocmFuZ2UpCiAgICAgICAgICAgIHJldHVybiByYW5nZTsKICAgICAgICByZXR1cm4gdGhpcy54bWxGb2xkTW9kZS5nZXRGb2xkV2lkZ2V0UmFuZ2Uoc2Vzc2lvbiwgZm9sZFN0eWxlLCByb3cpOwogICAgfTsKfSkuY2FsbChGb2xkTW9kZS5wcm90b3R5cGUpOwoKfSk7CgphY2UuZGVmaW5lKCJhY2UvbW9kZS9qYXZhc2NyaXB0IixbInJlcXVpcmUiLCJleHBvcnRzIiwibW9kdWxlIiwiYWNlL2xpYi9vb3AiLCJhY2UvbW9kZS90ZXh0IiwiYWNlL21vZGUvamF2YXNjcmlwdF9oaWdobGlnaHRfcnVsZXMiLCJhY2UvbW9kZS9tYXRjaGluZ19icmFjZV9vdXRkZW50IiwiYWNlL3dvcmtlci93b3JrZXJfY2xpZW50IiwiYWNlL21vZGUvYmVoYXZpb3VyL2phdmFzY3JpcHQiLCJhY2UvbW9kZS9mb2xkaW5nL2phdmFzY3JpcHQiXSwgZnVuY3Rpb24ocmVxdWlyZSwgZXhwb3J0cywgbW9kdWxlKXsidXNlIHN0cmljdCI7CnZhciBvb3AgPSByZXF1aXJlKCIuLi9saWIvb29wIik7CnZhciBUZXh0TW9kZSA9IHJlcXVpcmUoIi4vdGV4dCIpLk1vZGU7CnZhciBKYXZhU2NyaXB0SGlnaGxpZ2h0UnVsZXMgPSByZXF1aXJlKCIuL2phdmFzY3JpcHRfaGlnaGxpZ2h0X3J1bGVzIikuSmF2YVNjcmlwdEhpZ2hsaWdodFJ1bGVzOwp2YXIgTWF0Y2hpbmdCcmFjZU91dGRlbnQgPSByZXF1aXJlKCIuL21hdGNoaW5nX2JyYWNlX291dGRlbnQiKS5NYXRjaGluZ0JyYWNlT3V0ZGVudDsKdmFyIFdvcmtlckNsaWVudCA9IHJlcXVpcmUoIi4uL3dvcmtlci93b3JrZXJfY2xpZW50IikuV29ya2VyQ2xpZW50Owp2YXIgSmF2YVNjcmlwdEJlaGF2aW91ciA9IHJlcXVpcmUoIi4vYmVoYXZpb3VyL2phdmFzY3JpcHQiKS5KYXZhU2NyaXB0QmVoYXZpb3VyOwp2YXIgSmF2YVNjcmlwdEZvbGRNb2RlID0gcmVxdWlyZSgiLi9mb2xkaW5nL2phdmFzY3JpcHQiKS5Gb2xkTW9kZTsKdmFyIE1vZGUgPSBmdW5jdGlvbiAoKSB7CiAgICB0aGlzLkhpZ2hsaWdodFJ1bGVzID0gSmF2YVNjcmlwdEhpZ2hsaWdodFJ1bGVzOwogICAgdGhpcy4kb3V0ZGVudCA9IG5ldyBNYXRjaGluZ0JyYWNlT3V0ZGVudCgpOwogICAgdGhpcy4kYmVoYXZpb3VyID0gbmV3IEphdmFTY3JpcHRCZWhhdmlvdXIoKTsKICAgIHRoaXMuZm9sZGluZ1J1bGVzID0gbmV3IEphdmFTY3JpcHRGb2xkTW9kZSgpOwp9Owpvb3AuaW5oZXJpdHMoTW9kZSwgVGV4dE1vZGUpOwooZnVuY3Rpb24gKCkgewogICAgdGhpcy5saW5lQ29tbWVudFN0YXJ0ID0gIi8vIjsKICAgIHRoaXMuYmxvY2tDb21tZW50ID0geyBzdGFydDogIi8qIiwgZW5kOiAiKi8iIH07CiAgICB0aGlzLiRxdW90ZXMgPSB7ICciJzogJyInLCAiJyI6ICInIiwgImAiOiAiYCIgfTsKICAgIHRoaXMuJHBhaXJRdW90ZXNBZnRlciA9IHsKICAgICAgICAiYCI6IC9cdy8KICAgIH07CiAgICB0aGlzLmdldE5leHRMaW5lSW5kZW50ID0gZnVuY3Rpb24gKHN0YXRlLCBsaW5lLCB0YWIpIHsKICAgICAgICB2YXIgaW5kZW50ID0gdGhpcy4kZ2V0SW5kZW50KGxpbmUpOwogICAgICAgIHZhciB0b2tlbml6ZWRMaW5lID0gdGhpcy5nZXRUb2tlbml6ZXIoKS5nZXRMaW5lVG9rZW5zKGxpbmUsIHN0YXRlKTsKICAgICAgICB2YXIgdG9rZW5zID0gdG9rZW5pemVkTGluZS50b2tlbnM7CiAgICAgICAgdmFyIGVuZFN0YXRlID0gdG9rZW5pemVkTGluZS5zdGF0ZTsKICAgICAgICBpZiAodG9rZW5zLmxlbmd0aCAmJiB0b2tlbnNbdG9rZW5zLmxlbmd0aCAtIDFdLnR5cGUgPT0gImNvbW1lbnQiKSB7CiAgICAgICAgICAgIHJldHVybiBpbmRlbnQ7CiAgICAgICAgfQogICAgICAgIGlmIChzdGF0ZSA9PSAic3RhcnQiIHx8IHN0YXRlID09ICJub19yZWdleCIpIHsKICAgICAgICAgICAgdmFyIG1hdGNoID0gbGluZS5tYXRjaCgvXi4qKD86XGJjYXNlXGIuKjp8W1x7XChcW10pXHMqJC8pOwogICAgICAgICAgICBpZiAobWF0Y2gpIHsKICAgICAgICAgICAgICAgIGluZGVudCArPSB0YWI7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAoc3RhdGUgPT0gImRvYy1zdGFydCIpIHsKICAgICAgICAgICAgaWYgKGVuZFN0YXRlID09ICJzdGFydCIgfHwgZW5kU3RhdGUgPT0gIm5vX3JlZ2V4IikgewogICAgICAgICAgICAgICAgcmV0dXJuICIiOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBpbmRlbnQ7CiAgICB9OwogICAgdGhpcy5jaGVja091dGRlbnQgPSBmdW5jdGlvbiAoc3RhdGUsIGxpbmUsIGlucHV0KSB7CiAgICAgICAgcmV0dXJuIHRoaXMuJG91dGRlbnQuY2hlY2tPdXRkZW50KGxpbmUsIGlucHV0KTsKICAgIH07CiAgICB0aGlzLmF1dG9PdXRkZW50ID0gZnVuY3Rpb24gKHN0YXRlLCBkb2MsIHJvdykgewogICAgICAgIHRoaXMuJG91dGRlbnQuYXV0b091dGRlbnQoZG9jLCByb3cpOwogICAgfTsKICAgIHRoaXMuY3JlYXRlV29ya2VyID0gZnVuY3Rpb24gKHNlc3Npb24pIHsKICAgICAgICB2YXIgd29ya2VyID0gbmV3IFdvcmtlckNsaWVudChbImFjZSJdLCAiYWNlL21vZGUvamF2YXNjcmlwdF93b3JrZXIiLCAiSmF2YVNjcmlwdFdvcmtlciIpOwogICAgICAgIHdvcmtlci5hdHRhY2hUb0RvY3VtZW50KHNlc3Npb24uZ2V0RG9jdW1lbnQoKSk7CiAgICAgICAgd29ya2VyLm9uKCJhbm5vdGF0ZSIsIGZ1bmN0aW9uIChyZXN1bHRzKSB7CiAgICAgICAgICAgIHNlc3Npb24uc2V0QW5ub3RhdGlvbnMocmVzdWx0cy5kYXRhKTsKICAgICAgICB9KTsKICAgICAgICB3b3JrZXIub24oInRlcm1pbmF0ZSIsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgc2Vzc2lvbi5jbGVhckFubm90YXRpb25zKCk7CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIHdvcmtlcjsKICAgIH07CiAgICB0aGlzLiRpZCA9ICJhY2UvbW9kZS9qYXZhc2NyaXB0IjsKICAgIHRoaXMuc25pcHBldEZpbGVJZCA9ICJhY2Uvc25pcHBldHMvamF2YXNjcmlwdCI7Cn0pLmNhbGwoTW9kZS5wcm90b3R5cGUpOwpleHBvcnRzLk1vZGUgPSBNb2RlOwoKfSk7CgphY2UuZGVmaW5lKCJhY2UvbW9kZS9zdmdfaGlnaGxpZ2h0X3J1bGVzIixbInJlcXVpcmUiLCJleHBvcnRzIiwibW9kdWxlIiwiYWNlL2xpYi9vb3AiLCJhY2UvbW9kZS9qYXZhc2NyaXB0X2hpZ2hsaWdodF9ydWxlcyIsImFjZS9tb2RlL3htbF9oaWdobGlnaHRfcnVsZXMiXSwgZnVuY3Rpb24ocmVxdWlyZSwgZXhwb3J0cywgbW9kdWxlKXsidXNlIHN0cmljdCI7CnZhciBvb3AgPSByZXF1aXJlKCIuLi9saWIvb29wIik7CnZhciBKYXZhU2NyaXB0SGlnaGxpZ2h0UnVsZXMgPSByZXF1aXJlKCIuL2phdmFzY3JpcHRfaGlnaGxpZ2h0X3J1bGVzIikuSmF2YVNjcmlwdEhpZ2hsaWdodFJ1bGVzOwp2YXIgWG1sSGlnaGxpZ2h0UnVsZXMgPSByZXF1aXJlKCIuL3htbF9oaWdobGlnaHRfcnVsZXMiKS5YbWxIaWdobGlnaHRSdWxlczsKdmFyIFN2Z0hpZ2hsaWdodFJ1bGVzID0gZnVuY3Rpb24gKCkgewogICAgWG1sSGlnaGxpZ2h0UnVsZXMuY2FsbCh0aGlzKTsKICAgIHRoaXMuZW1iZWRUYWdSdWxlcyhKYXZhU2NyaXB0SGlnaGxpZ2h0UnVsZXMsICJqcy0iLCAic2NyaXB0Iik7CiAgICB0aGlzLm5vcm1hbGl6ZVJ1bGVzKCk7Cn07Cm9vcC5pbmhlcml0cyhTdmdIaWdobGlnaHRSdWxlcywgWG1sSGlnaGxpZ2h0UnVsZXMpOwpleHBvcnRzLlN2Z0hpZ2hsaWdodFJ1bGVzID0gU3ZnSGlnaGxpZ2h0UnVsZXM7Cgp9KTsKCmFjZS5kZWZpbmUoImFjZS9tb2RlL2ZvbGRpbmcvbWl4ZWQiLFsicmVxdWlyZSIsImV4cG9ydHMiLCJtb2R1bGUiLCJhY2UvbGliL29vcCIsImFjZS9tb2RlL2ZvbGRpbmcvZm9sZF9tb2RlIl0sIGZ1bmN0aW9uKHJlcXVpcmUsIGV4cG9ydHMsIG1vZHVsZSl7InVzZSBzdHJpY3QiOwp2YXIgb29wID0gcmVxdWlyZSgiLi4vLi4vbGliL29vcCIpOwp2YXIgQmFzZUZvbGRNb2RlID0gcmVxdWlyZSgiLi9mb2xkX21vZGUiKS5Gb2xkTW9kZTsKdmFyIEZvbGRNb2RlID0gZXhwb3J0cy5Gb2xkTW9kZSA9IGZ1bmN0aW9uIChkZWZhdWx0TW9kZSwgc3ViTW9kZXMpIHsKICAgIHRoaXMuZGVmYXVsdE1vZGUgPSBkZWZhdWx0TW9kZTsKICAgIHRoaXMuc3ViTW9kZXMgPSBzdWJNb2RlczsKfTsKb29wLmluaGVyaXRzKEZvbGRNb2RlLCBCYXNlRm9sZE1vZGUpOwooZnVuY3Rpb24gKCkgewogICAgdGhpcy4kZ2V0TW9kZSA9IGZ1bmN0aW9uIChzdGF0ZSkgewogICAgICAgIGlmICh0eXBlb2Ygc3RhdGUgIT0gInN0cmluZyIpCiAgICAgICAgICAgIHN0YXRlID0gc3RhdGVbMF07CiAgICAgICAgZm9yICh2YXIga2V5IGluIHRoaXMuc3ViTW9kZXMpIHsKICAgICAgICAgICAgaWYgKHN0YXRlLmluZGV4T2Yoa2V5KSA9PT0gMCkKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnN1Yk1vZGVzW2tleV07CiAgICAgICAgfQogICAgICAgIHJldHVybiBudWxsOwogICAgfTsKICAgIHRoaXMuJHRyeU1vZGUgPSBmdW5jdGlvbiAoc3RhdGUsIHNlc3Npb24sIGZvbGRTdHlsZSwgcm93KSB7CiAgICAgICAgdmFyIG1vZGUgPSB0aGlzLiRnZXRNb2RlKHN0YXRlKTsKICAgICAgICByZXR1cm4gKG1vZGUgPyBtb2RlLmdldEZvbGRXaWRnZXQoc2Vzc2lvbiwgZm9sZFN0eWxlLCByb3cpIDogIiIpOwogICAgfTsKICAgIHRoaXMuZ2V0Rm9sZFdpZGdldCA9IGZ1bmN0aW9uIChzZXNzaW9uLCBmb2xkU3R5bGUsIHJvdykgewogICAgICAgIHJldHVybiAodGhpcy4kdHJ5TW9kZShzZXNzaW9uLmdldFN0YXRlKHJvdyAtIDEpLCBzZXNzaW9uLCBmb2xkU3R5bGUsIHJvdykgfHwKICAgICAgICAgICAgdGhpcy4kdHJ5TW9kZShzZXNzaW9uLmdldFN0YXRlKHJvdyksIHNlc3Npb24sIGZvbGRTdHlsZSwgcm93KSB8fAogICAgICAgICAgICB0aGlzLmRlZmF1bHRNb2RlLmdldEZvbGRXaWRnZXQoc2Vzc2lvbiwgZm9sZFN0eWxlLCByb3cpKTsKICAgIH07CiAgICB0aGlzLmdldEZvbGRXaWRnZXRSYW5nZSA9IGZ1bmN0aW9uIChzZXNzaW9uLCBmb2xkU3R5bGUsIHJvdykgewogICAgICAgIHZhciBtb2RlID0gdGhpcy4kZ2V0TW9kZShzZXNzaW9uLmdldFN0YXRlKHJvdyAtIDEpKTsKICAgICAgICBpZiAoIW1vZGUgfHwgIW1vZGUuZ2V0Rm9sZFdpZGdldChzZXNzaW9uLCBmb2xkU3R5bGUsIHJvdykpCiAgICAgICAgICAgIG1vZGUgPSB0aGlzLiRnZXRNb2RlKHNlc3Npb24uZ2V0U3RhdGUocm93KSk7CiAgICAgICAgaWYgKCFtb2RlIHx8ICFtb2RlLmdldEZvbGRXaWRnZXQoc2Vzc2lvbiwgZm9sZFN0eWxlLCByb3cpKQogICAgICAgICAgICBtb2RlID0gdGhpcy5kZWZhdWx0TW9kZTsKICAgICAgICByZXR1cm4gbW9kZS5nZXRGb2xkV2lkZ2V0UmFuZ2Uoc2Vzc2lvbiwgZm9sZFN0eWxlLCByb3cpOwogICAgfTsKfSkuY2FsbChGb2xkTW9kZS5wcm90b3R5cGUpOwoKfSk7CgphY2UuZGVmaW5lKCJhY2UvbW9kZS9zdmciLFsicmVxdWlyZSIsImV4cG9ydHMiLCJtb2R1bGUiLCJhY2UvbGliL29vcCIsImFjZS9tb2RlL3htbCIsImFjZS9tb2RlL2phdmFzY3JpcHQiLCJhY2UvbW9kZS9zdmdfaGlnaGxpZ2h0X3J1bGVzIiwiYWNlL21vZGUvZm9sZGluZy9taXhlZCIsImFjZS9tb2RlL2ZvbGRpbmcveG1sIiwiYWNlL21vZGUvZm9sZGluZy9jc3R5bGUiXSwgZnVuY3Rpb24ocmVxdWlyZSwgZXhwb3J0cywgbW9kdWxlKXsidXNlIHN0cmljdCI7CnZhciBvb3AgPSByZXF1aXJlKCIuLi9saWIvb29wIik7CnZhciBYbWxNb2RlID0gcmVxdWlyZSgiLi94bWwiKS5Nb2RlOwp2YXIgSmF2YVNjcmlwdE1vZGUgPSByZXF1aXJlKCIuL2phdmFzY3JpcHQiKS5Nb2RlOwp2YXIgU3ZnSGlnaGxpZ2h0UnVsZXMgPSByZXF1aXJlKCIuL3N2Z19oaWdobGlnaHRfcnVsZXMiKS5TdmdIaWdobGlnaHRSdWxlczsKdmFyIE1peGVkRm9sZE1vZGUgPSByZXF1aXJlKCIuL2ZvbGRpbmcvbWl4ZWQiKS5Gb2xkTW9kZTsKdmFyIFhtbEZvbGRNb2RlID0gcmVxdWlyZSgiLi9mb2xkaW5nL3htbCIpLkZvbGRNb2RlOwp2YXIgQ1N0eWxlRm9sZE1vZGUgPSByZXF1aXJlKCIuL2ZvbGRpbmcvY3N0eWxlIikuRm9sZE1vZGU7CnZhciBNb2RlID0gZnVuY3Rpb24gKCkgewogICAgWG1sTW9kZS5jYWxsKHRoaXMpOwogICAgdGhpcy5IaWdobGlnaHRSdWxlcyA9IFN2Z0hpZ2hsaWdodFJ1bGVzOwogICAgdGhpcy5jcmVhdGVNb2RlRGVsZWdhdGVzKHsKICAgICAgICAianMtIjogSmF2YVNjcmlwdE1vZGUKICAgIH0pOwogICAgdGhpcy5mb2xkaW5nUnVsZXMgPSBuZXcgTWl4ZWRGb2xkTW9kZShuZXcgWG1sRm9sZE1vZGUoKSwgewogICAgICAgICJqcy0iOiBuZXcgQ1N0eWxlRm9sZE1vZGUoKQogICAgfSk7Cn07Cm9vcC5pbmhlcml0cyhNb2RlLCBYbWxNb2RlKTsKKGZ1bmN0aW9uICgpIHsKICAgIHRoaXMuZ2V0TmV4dExpbmVJbmRlbnQgPSBmdW5jdGlvbiAoc3RhdGUsIGxpbmUsIHRhYikgewogICAgICAgIHJldHVybiB0aGlzLiRnZXRJbmRlbnQobGluZSk7CiAgICB9OwogICAgdGhpcy4kaWQgPSAiYWNlL21vZGUvc3ZnIjsKfSkuY2FsbChNb2RlLnByb3RvdHlwZSk7CmV4cG9ydHMuTW9kZSA9IE1vZGU7Cgp9KTsgICAgICAgICAgICAgICAgKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIGFjZS5yZXF1aXJlKFsiYWNlL21vZGUvc3ZnIl0sIGZ1bmN0aW9uKG0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBtb2R1bGUgPT0gIm9iamVjdCIgJiYgdHlwZW9mIGV4cG9ydHMgPT0gIm9iamVjdCIgJiYgbW9kdWxlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IG07CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pKCk7CiAgICAgICAgICAgIA==";